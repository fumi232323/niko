<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
<title>Linux いろいろメモ/ふみのて</title>
<link rel="shortcut icon" href="../../assets/icons/favicon.ico">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Griffy">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Vollkorn:400,700">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sawarabi+Mincho&amp;display=swap&amp;subset=japanese,latin-ext">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
<link rel="stylesheet" href="../../assets/css/style.css?20200705">
</head>
<body>
    <div class="container">
      <div class="header"><header class="item item-header"><h1>
    <a href="../../">
      <img class="logo" src="../../assets/images/inuu.png" alt="犬"></a>
  </h1>
  <iframe src="../../tags/" class="tags"></iframe>
</header></div>
      <div class="main">
<div class="article-content">
  <main class="item item-article item-linux"><div class="category">
      <a href="../../tags/linux/">
          linux
      </a>
    </div>
    <div class="title">Linux いろいろメモ</div>
    <time class="date" datetime="2019-06-16 00:00:00+09:00">
      created: 2019-06-16 Sun
    </time><time class="date" datetime="2019-06-16 00:00:00+09:00">
        updated: 2019-06-16 Sun
        
      </time><div class="text">
      <div>
<details><summary>目次</summary><div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#id1" id="id9">ユーザー/ユーザーグループを確認したい</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id10">ディスク容量/使用量を確認したい</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id11">圧縮・展開</a></p></li>
<li>
<p><a class="reference internal" href="#id4" id="id12">転送</a></p>
<ul>
<li><p><a class="reference internal" href="#scp" id="id13">SCP</a></p></li>
<li><p><a class="reference internal" href="#sftp" id="id14">SFTP</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id5" id="id15">サービスの起動/停止とか</a></p></li>
<li><p><a class="reference internal" href="#ls-l" id="id16">ls -l</a></p></li>
<li><p><a class="reference internal" href="#su" id="id17">su</a></p></li>
<li><p><a class="reference internal" href="#sudo" id="id18">sudo</a></p></li>
<li><p><a class="reference internal" href="#id6" id="id19">最初に叩くコマンドまとめ</a></p></li>
<li><p><a class="reference internal" href="#dev-devel" id="id20">dev と devel の違い</a></p></li>
<li><p><a class="reference internal" href="#debconf-utils" id="id21">debconf-utils</a></p></li>
<li><p><a class="reference internal" href="#selinux" id="id22">SELinux</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id23">メールのログ</a></p></li>
<li><p><a class="reference internal" href="#id8" id="id24">未整理</a></p></li>
</ul>
</div>
</details><div class="section" id="id1">
<h2><a class="toc-backref" href="#id9">ユーザー/ユーザーグループを確認したい</a></h2>
<pre class="code bash"><a name="rest_code_b068415ba6a840319fdf67870ab082af-1"></a><span class="c1"># ユーザーの一覧</span>
<a name="rest_code_b068415ba6a840319fdf67870ab082af-2"></a>$ cat /etc/passwd
<a name="rest_code_b068415ba6a840319fdf67870ab082af-3"></a><span class="c1"># ユーザー名:暗号化されたパスワード:ユーザーID:グループID:コメント:ホームディレクトリー:ログインシェル（ログインした際、最初に起動するシェル）</span>
<a name="rest_code_b068415ba6a840319fdf67870ab082af-4"></a>fumi23:x:1061:1001::/home/fumi23:/bin/bash
<a name="rest_code_b068415ba6a840319fdf67870ab082af-5"></a>
<a name="rest_code_b068415ba6a840319fdf67870ab082af-6"></a><span class="c1"># ユーザーグループの一覧</span>
<a name="rest_code_b068415ba6a840319fdf67870ab082af-7"></a>$ cat /etc/group
<a name="rest_code_b068415ba6a840319fdf67870ab082af-8"></a><span class="c1"># グループ名:暗号化されたパスワード:グループID:サブグループとして所属しているユーザーアカウントのリスト</span>
<a name="rest_code_b068415ba6a840319fdf67870ab082af-9"></a>dev:x:1001:
</pre>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id10">ディスク容量/使用量を確認したい</a></h2>
<pre class="code bash"><a name="rest_code_c7541ea5afcc493e9df937343e3d2a8e-1"></a><span class="c1"># ファイルシステムの使用領域と空き領域を表示する</span>
<a name="rest_code_c7541ea5afcc493e9df937343e3d2a8e-2"></a>$ df -h
<a name="rest_code_c7541ea5afcc493e9df937343e3d2a8e-3"></a>
<a name="rest_code_c7541ea5afcc493e9df937343e3d2a8e-4"></a><span class="c1"># 指定したディレクトリのディスク使用量を表示する</span>
<a name="rest_code_c7541ea5afcc493e9df937343e3d2a8e-5"></a>$ du -sh /path/to/husky
</pre>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id11">圧縮・展開</a></h2>
<pre class="code bash"><a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-1"></a><span class="c1"># 圧縮: 前のはなくなる</span>
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-2"></a>$ gzip husky-dump.sql
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-3"></a><span class="c1"># 展開: 前のはなくなる</span>
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-4"></a>$ gzip -d husky-dump.sql.gz
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-5"></a>
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-6"></a><span class="c1"># アーカイブと圧縮: 前のはなくならない</span>
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-7"></a>$ tar -cf husky.tar husky
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-8"></a>$ gzip husky.tar
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-9"></a><span class="c1"># 展開: 前のはなくならない</span>
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-10"></a>$ tar -zxvf husky.tar.gz
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-11"></a>
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-12"></a><span class="c1"># zip 圧縮</span>
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-13"></a>$ zip -r /path/to/husky.zip /path/to/husky
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-14"></a><span class="c1"># zip 展開</span>
<a name="rest_code_d98a46fe89834c0a83e40bbc7f05d9b5-15"></a>$ unzip /path/to/husky.zip
</pre>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id12">転送</a></h2>
<div class="section" id="scp">
<h3><a class="toc-backref" href="#id13">SCP</a></h3>
<pre class="code bash"><a name="rest_code_25aa11dd5a5c41c0952c2d551fb8b5b2-1"></a><span class="c1"># サーバー =&gt; ローカル (踏み台サーバーを経由)</span>
<a name="rest_code_25aa11dd5a5c41c0952c2d551fb8b5b2-2"></a>$ scp -r -o <span class="s2">"ProxyCommand ssh &lt;ユーザー名&gt;@&lt;踏み台サーバー名&gt; -W %h:%p"</span> &lt;ユーザー名&gt;@&lt;サーバー名&gt;:&lt;転送元: サーバー上のファイルパス&gt; &lt;転送先: ローカルのパス&gt;
<a name="rest_code_25aa11dd5a5c41c0952c2d551fb8b5b2-3"></a>$ scp -r -o <span class="s2">"ProxyCommand ssh fumi23@fumidai-server -W %h:%p"</span> fumi23@remote-server:/path/to/fumi23 ~/fumi23
</pre>
</div>
<div class="section" id="sftp">
<h3><a class="toc-backref" href="#id14">SFTP</a></h3>
<pre class="code bash"><a name="rest_code_bf5856f1cd6848f1af7ea027425e5fec-1"></a>$ sftp &lt;ユーザー名&gt;@&lt;サーバー名&gt;
<a name="rest_code_bf5856f1cd6848f1af7ea027425e5fec-2"></a><span class="c1"># ローカル =&gt; サーバー</span>
<a name="rest_code_bf5856f1cd6848f1af7ea027425e5fec-3"></a>sftp&gt; put husky.tar.gz
<a name="rest_code_bf5856f1cd6848f1af7ea027425e5fec-4"></a><span class="c1"># サーバー =&gt; ローカル</span>
<a name="rest_code_bf5856f1cd6848f1af7ea027425e5fec-5"></a>sftp&gt; get husky.tar.gz
<a name="rest_code_bf5856f1cd6848f1af7ea027425e5fec-6"></a><span class="c1"># sftp をおしまいにする</span>
<a name="rest_code_bf5856f1cd6848f1af7ea027425e5fec-7"></a>sftp&gt; quit
</pre>
</div>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id15">サービスの起動/停止とか</a></h2>
<pre class="code bash"><a name="rest_code_59a16d43ed724a6eac26491163db4f45-1"></a><span class="c1"># 起動</span>
<a name="rest_code_59a16d43ed724a6eac26491163db4f45-2"></a>$ sudo systemctl start mysqld
<a name="rest_code_59a16d43ed724a6eac26491163db4f45-3"></a><span class="c1"># 停止</span>
<a name="rest_code_59a16d43ed724a6eac26491163db4f45-4"></a>$ sudo systemctl stop mysqld
<a name="rest_code_59a16d43ed724a6eac26491163db4f45-5"></a><span class="c1"># 再起動</span>
<a name="rest_code_59a16d43ed724a6eac26491163db4f45-6"></a>$ sudo systemctl restart mysqld
<a name="rest_code_59a16d43ed724a6eac26491163db4f45-7"></a><span class="c1"># ステータス表示</span>
<a name="rest_code_59a16d43ed724a6eac26491163db4f45-8"></a>$ systemctl status mysqld
<a name="rest_code_59a16d43ed724a6eac26491163db4f45-9"></a>
<a name="rest_code_59a16d43ed724a6eac26491163db4f45-10"></a><span class="c1"># 起動</span>
<a name="rest_code_59a16d43ed724a6eac26491163db4f45-11"></a>$ sudo service nginx start
<a name="rest_code_59a16d43ed724a6eac26491163db4f45-12"></a><span class="c1"># ステータス表示</span>
<a name="rest_code_59a16d43ed724a6eac26491163db4f45-13"></a>$ sudo service nginx status
</pre>
</div>
<div class="section" id="ls-l">
<h2><a class="toc-backref" href="#id16">ls -l</a></h2>
<pre class="code bash"><a name="rest_code_eff59256d92744d8845bdbcc89c74477-1"></a><span class="c1"># . から始まるファイルも全部表示する</span>
<a name="rest_code_eff59256d92744d8845bdbcc89c74477-2"></a>$ ls -la
<a name="rest_code_eff59256d92744d8845bdbcc89c74477-3"></a><span class="c1"># ファイルのパーミッション、所有ユーザ、所有グループ、ファイルサイズ、タイムスタンプ、ファイル名</span>
<a name="rest_code_eff59256d92744d8845bdbcc89c74477-4"></a>-rw-------  <span class="m">1</span> fumi23 dev   <span class="m">1047</span>  5月 <span class="m">30</span> <span class="m">16</span>:20 .viminfo
<a name="rest_code_eff59256d92744d8845bdbcc89c74477-5"></a>-rwxr-xr-x  <span class="m">1</span> root   root <span class="m">35359</span>  5月 <span class="m">30</span> <span class="m">12</span>:15 shiba.dog
<a name="rest_code_eff59256d92744d8845bdbcc89c74477-6"></a>drwxrwxr-x  <span class="m">2</span> fumi23 dev   <span class="m">4096</span>  4月 <span class="m">18</span> <span class="m">13</span>:38 husky
<a name="rest_code_eff59256d92744d8845bdbcc89c74477-7"></a>
<a name="rest_code_eff59256d92744d8845bdbcc89c74477-8"></a><span class="c1"># 更新日の新しい順</span>
<a name="rest_code_eff59256d92744d8845bdbcc89c74477-9"></a>$ ls -lt
<a name="rest_code_eff59256d92744d8845bdbcc89c74477-10"></a>
<a name="rest_code_eff59256d92744d8845bdbcc89c74477-11"></a><span class="c1"># 更新日の古い順</span>
<a name="rest_code_eff59256d92744d8845bdbcc89c74477-12"></a>$ ls -ltr
</pre>
</div>
<div class="section" id="su">
<h2><a class="toc-backref" href="#id17">su</a></h2>
<pre class="code bash"><a name="rest_code_d113c3dd44554a458ffdab0babe37828-1"></a><span class="c1"># ユーザーを指定しないと root に切り替わる</span>
<a name="rest_code_d113c3dd44554a458ffdab0babe37828-2"></a>$ sudo su -
<a name="rest_code_d113c3dd44554a458ffdab0babe37828-3"></a>
<a name="rest_code_d113c3dd44554a458ffdab0babe37828-4"></a><span class="c1"># ユーザーを  www-data に切り替える</span>
<a name="rest_code_d113c3dd44554a458ffdab0babe37828-5"></a>$ su -l -s /bin/bash www-data
</pre>
<dl class="field-list simple">
<dt>
<code class="docutils literal">-</code>, <code class="docutils literal"><span class="pre">-l</span></code>, <code class="docutils literal"><span class="pre">--login</span></code>
</dt>
<dd>
<p>切り替え後のユーザーの設定を使用する</p>
<dl class="field-list simple">
<dt>
<code class="docutils literal">-</code> なし</dt>
<dd>
<p>カレントディレクトリも環境変数も、切り替え前ユーザーのものを引き継ぐ</p>
</dd>
<dt>
<code class="docutils literal">-</code> あり</dt>
<dd>
<p>カレントディレクトリも環境変数も、切り替え後のユーザーのデフォルトを使用する、切り替え前ユーザーのものは引き継がない</p>
</dd>
</dl>
</dd>
<dt>-s</dt>
<dd>
<p>切り替え後のユーザーが使用するシェルを指定できる</p>
</dd>
</dl>
</div>
<div class="section" id="sudo">
<h2><a class="toc-backref" href="#id18">sudo</a></h2>
<pre class="code bash"><a name="rest_code_df7ab2d0f6384a01baa3047f60585145-1"></a>$ sudo -iH
</pre>
<dl class="field-list simple">
<dt><code class="docutils literal"><span class="pre">-H</span></code></dt>
<dd>
<p>環境変数「HOME」をrootユーザーのホームディレクトリに変更してコマンドを実行する</p>
</dd>
<dt><code class="docutils literal"><span class="pre">-i</span></code></dt>
<dd>
<p>rootユーザーのデフォルトのシェルをログインシェルとして実行する。コマンドを指定しなかった場合は対話シェルとなる。</p>
</dd>
<dt><code class="docutils literal"><span class="pre">-u</span></code></dt>
<dd>
<p>コマンドを実行するユーザーを指定する (指定しないと root)</p>
</dd>
</dl>
<ul class="simple">
<li><p>sudoを実行するには、あらかじめ /etc/sudoers ファイルに権限を与えられるユーザーとコマンドを設定しておく必要がある。</p></li>
</ul>
</div>
<div class="section" id="id6">
<h2><a class="toc-backref" href="#id19">最初に叩くコマンドまとめ</a></h2>
<pre class="code bash"><a name="rest_code_13de316efdda4ddc9a295f2a0ec8b3a8-1"></a><span class="c1"># メモリーの使用状況をMバイト単位で表示する</span>
<a name="rest_code_13de316efdda4ddc9a295f2a0ec8b3a8-2"></a>$ free -m
<a name="rest_code_13de316efdda4ddc9a295f2a0ec8b3a8-3"></a><span class="c1"># ディストリビューションのバージョンを確認する</span>
<a name="rest_code_13de316efdda4ddc9a295f2a0ec8b3a8-4"></a>$ cat /etc/redhat-release
<a name="rest_code_13de316efdda4ddc9a295f2a0ec8b3a8-5"></a>$ ls
<a name="rest_code_13de316efdda4ddc9a295f2a0ec8b3a8-6"></a>$ <span class="nb">pwd</span>
<a name="rest_code_13de316efdda4ddc9a295f2a0ec8b3a8-7"></a>$ ls /home
<a name="rest_code_13de316efdda4ddc9a295f2a0ec8b3a8-8"></a>$ df -h
<a name="rest_code_13de316efdda4ddc9a295f2a0ec8b3a8-9"></a><span class="c1"># パッケージキャッシュの削除</span>
<a name="rest_code_13de316efdda4ddc9a295f2a0ec8b3a8-10"></a>$ yum clean all
<a name="rest_code_13de316efdda4ddc9a295f2a0ec8b3a8-11"></a><span class="c1"># パッケージの更新</span>
<a name="rest_code_13de316efdda4ddc9a295f2a0ec8b3a8-12"></a>$ yum -y update
</pre>
<ul class="simple">
<li>
<p>これがわかりやすかった:</p>
<ul>
<li><p><a class="reference external" href="https://linuxfan.info/yum">「yum」を使ったパッケージ管理まとめ【Red Hat Enterprise Linux・CentOS】</a></p></li>
<li><p><a class="reference external" href="https://uxmilk.jp/13610">CentOS、UbuntuなどLinux OSのバージョン確認をするコマンド</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="dev-devel">
<h2><a class="toc-backref" href="#id20">dev と devel の違い</a></h2>
<dl class="field-list simple">
<dt>python-devel</dt>
<dd>
<p>RedHat (CentOS) 系</p>
</dd>
<dt>python-dev</dt>
<dd>
<p>Debian (Ubuntu) 系</p>
</dd>
</dl>
</div>
<div class="section" id="debconf-utils">
<h2><a class="toc-backref" href="#id21">debconf-utils</a></h2>
<ul class="simple">
<li>
<p>パッケージインストール中の設定に関する質問への返答を、あらかじめ設定しておける</p>
<ul>
<li><p>インストール中に質問されなくなる</p></li>
<li><p>設定しておいた返答が使用される</p></li>
</ul>
</li>
<li><p>インストールを自動化するときに便利</p></li>
</ul>
</div>
<div class="section" id="selinux">
<h2><a class="toc-backref" href="#id22">SELinux</a></h2>
<pre class="code bash"><a name="rest_code_cb013b19743b4fd6a2679f9fcef30ee5-1"></a><span class="c1"># 有効になっている</span>
<a name="rest_code_cb013b19743b4fd6a2679f9fcef30ee5-2"></a>$ sudo getenforce
<a name="rest_code_cb013b19743b4fd6a2679f9fcef30ee5-3"></a>Enforcing
<a name="rest_code_cb013b19743b4fd6a2679f9fcef30ee5-4"></a>
<a name="rest_code_cb013b19743b4fd6a2679f9fcef30ee5-5"></a><span class="c1"># 無効にする</span>
<a name="rest_code_cb013b19743b4fd6a2679f9fcef30ee5-6"></a>$ sudo setenforce <span class="m">0</span>
<a name="rest_code_cb013b19743b4fd6a2679f9fcef30ee5-7"></a>
<a name="rest_code_cb013b19743b4fd6a2679f9fcef30ee5-8"></a><span class="c1"># 無効になっている</span>
<a name="rest_code_cb013b19743b4fd6a2679f9fcef30ee5-9"></a>$ sudo getenforce
<a name="rest_code_cb013b19743b4fd6a2679f9fcef30ee5-10"></a>Permissive
</pre>
<ul class="simple">
<li><p>SELinux で拒否されたときのログは <code class="docutils literal">/var/log/audit/audit.log</code> にある</p></li>
<li><p><a class="reference external" href="https://qiita.com/rikudai/items/884b203f4a72cfb62c02">https://qiita.com/rikudai/items/884b203f4a72cfb62c02</a></p></li>
</ul>
</div>
<div class="section" id="id7">
<h2><a class="toc-backref" href="#id23">メールのログ</a></h2>
<ul class="simple">
<li>
<p>一般的にメールのログは <code class="docutils literal">/var/log/mail.log</code> にある</p>
<ul>
<li><p>検証用にローカルVMにpostfixを建てるなどした場合は、localhostの <code class="docutils literal">/var/log/mail.log</code> にログがある</p></li>
</ul>
</li>
<li><p>なにかしらのサーバーログを見たい場合はとりあえず ( <code class="docutils literal">sudo journalctl</code> ) あたりでみる ( <code class="docutils literal">/var/log/syslog</code> でもok)</p></li>
</ul>
</div>
<div class="section" id="id8">
<h2><a class="toc-backref" href="#id24">未整理</a></h2>
<ul class="simple">
<li><p>source って同じシェル内でコマンド実行するんですけど、 sudo って別のシェルになるんで、 source した結果が引き継がれないんですよね</p></li>
<li><p>top: display Linux tasks</p></li>
<li><p>これはものすごく便利... (ありがとうございました) : <a class="reference external" href="https://explainshell.com/">https://explainshell.com/</a></p></li>
</ul>
</div>
</div>
    </div>
  </main>
</div>
</div>
    </div>
  </body>
</html>
