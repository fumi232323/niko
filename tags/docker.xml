<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ふみのて (Posts about docker)</title><link>https://32imuf.com/</link><description></description><atom:link href="https://32imuf.com/tags/docker.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2020 &lt;a href="mailto:fumi232323fumi2016@gmail.com"&gt;fumi23&lt;/a&gt; </copyright><lastBuildDate>Sat, 26 Sep 2020 08:22:28 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Jenkins のなぞ</title><link>https://32imuf.com/docker/jenkins/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/jenkins/#id1" id="id2"&gt;なぞ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/jenkins/#id2"&gt;なぞ&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Docker (docker-compose) で動かしている Jenkins から Docker (docker-compose) を動かせるのが不思議だったので調べたメモ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Jenkins 自体も Docker コンテナ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Jenkins の Dockerfile あり (こんな感じ↓)&lt;/p&gt;
&lt;pre class="code docker"&gt;&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; jenkins/jenkins:lts&lt;/span&gt;
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-3"&gt;&lt;/a&gt;&lt;span class="c"&gt;# install docker&lt;/span&gt;
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;USER&lt;/span&gt;&lt;span class="s"&gt; root&lt;/span&gt;
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;RUN&lt;/span&gt; curl -fL -o docker.tgz &lt;span class="s2"&gt;"https://download.docker.com/linux/static/test/x86_64/docker-19.03.9.tgz"&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-6"&gt;&lt;/a&gt;    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; tar --strip-components&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; -xvzf docker.tgz -C /usr/bin &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-7"&gt;&lt;/a&gt;    # dockerグループの ID は環境によって変わるので調べておく
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-8"&gt;&lt;/a&gt;    # cat /etc/group &lt;span class="p"&gt;|&lt;/span&gt; grep docker
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-9"&gt;&lt;/a&gt;    # docker グループ作成, &lt;span class="nv"&gt;グループID&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="m"&gt;999&lt;/span&gt;
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-10"&gt;&lt;/a&gt;    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; groupadd -g &lt;span class="m"&gt;999&lt;/span&gt; docker &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-11"&gt;&lt;/a&gt;    # docker グループに jenkins ユーザーを追加してる
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-12"&gt;&lt;/a&gt;    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; gpasswd -a jenkins docker
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-14"&gt;&lt;/a&gt;&lt;span class="k"&gt;RUN&lt;/span&gt; apt update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-15"&gt;&lt;/a&gt;    apt install -y python-pip &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-16"&gt;&lt;/a&gt;    pip install docker-compose
&lt;a name="rest_code_35a25aafabdf4631956d90fda0fbc86f-17"&gt;&lt;/a&gt;&lt;span class="k"&gt;USER&lt;/span&gt;&lt;span class="s"&gt; jenkins&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Jenkins 立ち上げるための docker-compose.yml もあり (こんな感じ↓)&lt;/p&gt;
&lt;pre class="code yaml"&gt;&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-1"&gt;&lt;/a&gt;&lt;span class="nt"&gt;version&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;'3'&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-3"&gt;&lt;/a&gt;&lt;span class="nt"&gt;services&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-4"&gt;&lt;/a&gt;  &lt;span class="nt"&gt;jenkins&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-5"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;build&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-6"&gt;&lt;/a&gt;      &lt;span class="nt"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-7"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;restart&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;always&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-8"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-9"&gt;&lt;/a&gt;      &lt;span class="c1"&gt;# コンテナ外にポート開放してる&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-10"&gt;&lt;/a&gt;      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;2323:8080&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-11"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;privileged&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;true&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-12"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-13"&gt;&lt;/a&gt;      &lt;span class="c1"&gt;# https://github.com/jenkinsci/docker/blob/master/README.md#configuring-reverse-proxy&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-14"&gt;&lt;/a&gt;      &lt;span class="nt"&gt;JENKINS_OPTS&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;'--prefix=/jenkins'&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-15"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-16"&gt;&lt;/a&gt;      &lt;span class="c1"&gt;# volume 使ってる、じゃないと down したら workspace 消えちゃうからね&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-17"&gt;&lt;/a&gt;      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;jenkins_home:/var/jenkins_home&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-18"&gt;&lt;/a&gt;      &lt;span class="c1"&gt;# ここがみそだ!&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-19"&gt;&lt;/a&gt;      &lt;span class="c1"&gt;# ホストの dockerデーモンが使用しているソケット (/var/run/docker.sock) をマウントして&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-20"&gt;&lt;/a&gt;      &lt;span class="c1"&gt;# jenkins からアクセスできるようにしている&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-21"&gt;&lt;/a&gt;      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/var/run/docker.sock:/var/run/docker.sock&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-22"&gt;&lt;/a&gt;&lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-23"&gt;&lt;/a&gt;  &lt;span class="nt"&gt;jenkins_home&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-24"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# Compose の外ですでに作成済みの volume なんだぜ&lt;/span&gt;
&lt;a name="rest_code_0d0c701c2ff74dde8ba8edaeb553450f-25"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;external&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;true&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Jenkins 画面の URL はこんな感じ: &lt;a class="reference external" href="http://our.web.application:2323/jenkins"&gt;http://our.web.application:2323/jenkins&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;workspace はこんな感じ: /var/jenkins_home/workspace/our_app&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;これは jenikins コンテナの中だった&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ここにコードがある&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Jenkins ジョブのビルド開始時に workspace は削除される (そういう設定にしている)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ジョブ自体は、&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;GitHub のリポジトリからアプリを clone してきて、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Docker イメージを build して、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;アプリ起動している (docker-compose up --build している)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;本番は gunicorn なので&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;これだ! &lt;a class="reference external" href="https://www.mmj.ne.jp/mmjblog/docker-on-jenkins/"&gt;https://www.mmj.ne.jp/mmjblog/docker-on-jenkins/&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;ホストの docker デーモンを共有しているので、 docker (jenkins) から自分達の services が docker-compose up できているわけだ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ありがとうございました&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;これもありがとうございます: &lt;a class="reference external" href="https://techblog.recochoku.jp/1544"&gt;https://techblog.recochoku.jp/1544&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://github.com/jenkinsci/docker/blob/master/README.md"&gt;https://github.com/jenkinsci/docker/blob/master/README.md&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>docker</category><guid>https://32imuf.com/docker/jenkins/</guid><pubDate>Wed, 23 Sep 2020 15:00:00 GMT</pubDate></item><item><title>5. Kubernetes 入門</title><link>https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id1" id="id8"&gt;書籍/リファレンス&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#kubernetes" id="id9"&gt;5.1 Kubernetes とは&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id2" id="id10"&gt;クラウドプラットフォームの Kubernetes サポート&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id3" id="id11"&gt;5.2 ローカル環境で Kubernetes を実行する&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id4" id="id12"&gt;5.3 Kubernetes の概念&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#kubernetes-node" id="id13"&gt;5.4 Kubernetes クラスタと Node&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#pod" id="id14"&gt;5.6 Pod を作成してデプロイする&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#replicaset" id="id15"&gt;5.7 ReplicaSet&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#deployment" id="id16"&gt;5.8  Deployment&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id5" id="id17"&gt;ReplicaSet のライフサイクル&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id6" id="id18"&gt;挙動まとめ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#service" id="id19"&gt;5.9 Service&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id7" id="id20"&gt;Service の名前解決&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id8"&gt;書籍/リファレンス&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://gihyo.jp/book/2018/978-4-297-10033-9"&gt;Docker/Kubernetes 実践コンテナ開発入門&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="kubernetes"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id9"&gt;5.1 Kubernetes とは&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Google 社主導で開発された、コンテナの運用を自動化するためのコンテナオーケストレーションシステム&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;コンテナオーケストレーションを実現・管理するための統合的なシステム&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;その操作のための API や CLI ツールも併せて提供する&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;コンテナを用いたアプリケーションのデプロイをはじめ、様々な運用管理の自動化を実現する&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Docker ホストの管理&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;サーバーリソースの空き具合を考慮したコンテナ配置&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;スケーリング&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;複数のコンテナ群へのアクセスを取りまとめるロードバランサー&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;死活監視&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;クーバネティス&lt;/code&gt; と読むらしい&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id10"&gt;クラウドプラットフォームの Kubernetes サポート&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Google: GKE&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Microsoft Azure: AKS&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AWS: Amazon EKS&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id11"&gt;5.2 ローカル環境で Kubernetes を実行する&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;Docker for Mac の Kubernetes 連携を有効にする&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_57c0ccbbbefc440aa21d5ac7561c91ef-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 2. kubectl (Kubernetes を操作するためのコマンドラインツール) をインストールする&lt;/span&gt;
&lt;a name="rest_code_57c0ccbbbefc440aa21d5ac7561c91ef-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# https://kubernetes.io/docs/tasks/tools/install-kubectl/&lt;/span&gt;
&lt;a name="rest_code_57c0ccbbbefc440aa21d5ac7561c91ef-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# けっこう長かった&lt;/span&gt;
&lt;a name="rest_code_57c0ccbbbefc440aa21d5ac7561c91ef-4"&gt;&lt;/a&gt;$ brew install kubectl
&lt;a name="rest_code_57c0ccbbbefc440aa21d5ac7561c91ef-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_57c0ccbbbefc440aa21d5ac7561c91ef-6"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 3. ダッシュボードの適用 (追加)&lt;/span&gt;
&lt;a name="rest_code_57c0ccbbbefc440aa21d5ac7561c91ef-7"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/&lt;/span&gt;
&lt;a name="rest_code_57c0ccbbbefc440aa21d5ac7561c91ef-8"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# これはすぐだった&lt;/span&gt;
&lt;a name="rest_code_57c0ccbbbefc440aa21d5ac7561c91ef-9"&gt;&lt;/a&gt;$ kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0-beta4/aio/deploy/recommended.yaml
&lt;a name="rest_code_57c0ccbbbefc440aa21d5ac7561c91ef-10"&gt;&lt;/a&gt;
&lt;a name="rest_code_57c0ccbbbefc440aa21d5ac7561c91ef-11"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 4. ダッシュボードへのプロキシサーバーを立ち上げる&lt;/span&gt;
&lt;a name="rest_code_57c0ccbbbefc440aa21d5ac7561c91ef-12"&gt;&lt;/a&gt;$ kubectl proxy
&lt;/pre&gt;&lt;ol class="arabic simple" start="5"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/"&gt;http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/&lt;/a&gt;. へアクセスする&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id12"&gt;5.3 Kubernetes の概念&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;P.173 に一覧表になっている&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="kubernetes-node"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id13"&gt;5.4 Kubernetes クラスタと Node&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;大きい順: &lt;code class="docutils literal"&gt;クラスタ&lt;/code&gt; &amp;gt;&amp;gt;&amp;gt; &lt;code class="docutils literal"&gt;Node&lt;/code&gt; &amp;gt;&amp;gt;&amp;gt; &lt;code class="docutils literal"&gt;Pod&lt;/code&gt; &amp;gt;&amp;gt;&amp;gt; &lt;code class="docutils literal"&gt;コンテナ&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;クラスタ: Kubernetes の様々なリソースを管理する集合体&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;全体を管理するサーバーである Master が少なくとも1つは配置されている&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="pod"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id14"&gt;5.6 Pod を作成してデプロイする&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Pod: コンテナの集合体の単位&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;少なくとも 1つのコンテナを持つ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Kubernetes では Pod 単位でコンテナをひとくくりにしてデプロイする&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Pod を定義したマニフェストファイルを作成する&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;kubectl だけで Pod を作成することもできるが、バージョン管理の観点から yaml ファイルとして定義することがほとんど&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;kubernetes の各種リソースを定義するファイルを &lt;code class="docutils literal"&gt;マニフェストファイル&lt;/code&gt; と呼ぶ&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;simple-pod.yaml&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;v1&lt;/span&gt;
&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Pod&lt;/span&gt;  &lt;span class="c1"&gt;# リソースの種類を指定&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="c1"&gt;# リソースに付与するメタデータ&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;simple-echo&lt;/span&gt;
&lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;containers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="c1"&gt;# 構成するコンテナ群を定義&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;nginx&lt;/span&gt;
      &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;gihyodocker/nginx-proxy:latest&lt;/span&gt;  &lt;span class="c1"&gt;# 使うコンテナイメージ&lt;/span&gt;
      &lt;span class="nt"&gt;env&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;BACKEND_HOST&lt;/span&gt;  &lt;span class="c1"&gt;# リクエストのプロキシ先&lt;/span&gt;
          &lt;span class="nt"&gt;value&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;localhost:8080&lt;/span&gt;
      &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="c1"&gt;# コンテナが EXPOSE するポート&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;containerPort&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;80&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
      &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;gihyodocker/echo:latest&lt;/span&gt;
      &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;containerPort&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;8080&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Kubernetes クラスタに反映する&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# apply: 新規作成/内容に変更があったときだけ反映される&lt;/span&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-2"&gt;&lt;/a&gt;$ kubectl apply -f simple-pod.yaml
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-3"&gt;&lt;/a&gt;pod/simple-echo created
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-5"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pod の状態を一覧表示&lt;/span&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-6"&gt;&lt;/a&gt;$ kubectl get pod
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-7"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# STATUS Running:  Pod 内のすべてのコンテナが実行状態&lt;/span&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-8"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# READY 2/2: 実行状態になったコンテナ数/Pod に定義されたコンテナ数&lt;/span&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-9"&gt;&lt;/a&gt;NAME          READY   STATUS    RESTARTS   AGE
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-10"&gt;&lt;/a&gt;simple-echo   &lt;span class="m"&gt;2&lt;/span&gt;/2     Running   &lt;span class="m"&gt;0&lt;/span&gt;          2m49s
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-12"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# コンテナに入る&lt;/span&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-13"&gt;&lt;/a&gt;$ kubectl &lt;span class="nb"&gt;exec&lt;/span&gt; -it simple-echo sh -c nginx
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-14"&gt;&lt;/a&gt;/ &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-15"&gt;&lt;/a&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-16"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pod 内のコンテナの標準出力を表示する&lt;/span&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-17"&gt;&lt;/a&gt;$ kubectl logs -f simple-echo -c &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-18"&gt;&lt;/a&gt;&lt;span class="m"&gt;2019&lt;/span&gt;/11/17 &lt;span class="m"&gt;04&lt;/span&gt;:50:42 start server
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-19"&gt;&lt;/a&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-20"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pod を削除する&lt;/span&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-21"&gt;&lt;/a&gt;$ kubectl delete pod simple-echo
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-22"&gt;&lt;/a&gt;pod &lt;span class="s2"&gt;"simple-echo"&lt;/span&gt; deleted
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-23"&gt;&lt;/a&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-24"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# マニフェストファイルベースで Pod を削除する&lt;/span&gt;
&lt;a name="rest_code_597e391a44064139ba87add268f01ff7-25"&gt;&lt;/a&gt;$ kubectl delete -f simple-pod.yaml
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Pod と Pod 内コンテナのアドレス&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Pod にはそれぞれ固有の IPアドレスが割り振られる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Pod に割り振られた仮想 IPアドレスは、その Pod に所属するすべてのコンテナと共有される =&amp;gt; 同一 Pod 内の全てのコンテナの仮想IPアドレスは同じ&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="replicaset"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id15"&gt;5.7 ReplicaSet&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;同じ仕様の Pod を複数生成/管理するためのリソース&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;simple-replicaset.yaml&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;apps/v1&lt;/span&gt;
&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ReplicaSet&lt;/span&gt;  &lt;span class="c1"&gt;# リソースの種類を指定&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="c1"&gt;# リソースに付与するメタデータ&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
  &lt;span class="nt"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
&lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;replicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;3&lt;/span&gt;  &lt;span class="c1"&gt;# 作成する Pod数&lt;/span&gt;
  &lt;span class="nt"&gt;selector&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;matchLabels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
  &lt;span class="nt"&gt;template&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="c1"&gt;# ここから Pod 定義と同じ&lt;/span&gt;
    &lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
    &lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;containers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;nginx&lt;/span&gt;
          &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;gihyodocker/nginx-proxy:latest&lt;/span&gt;
          &lt;span class="nt"&gt;env&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;BACKEND_HOST&lt;/span&gt;
              &lt;span class="nt"&gt;value&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;localhost:8080&lt;/span&gt;
          &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;containerPort&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;80&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
          &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;gihyodocker/echo:latest&lt;/span&gt;
          &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;containerPort&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;8080&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-1"&gt;&lt;/a&gt;$ kubectl apply -f simple-replicaset.yaml
&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-2"&gt;&lt;/a&gt;replicaset.apps/echo created
&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-4"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Pod が 3つ作成されている&lt;/span&gt;
&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-5"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# ReplicaSet を操作して Pod の数を減らすと、減らした分の Pod は削除されて元に戻せない =&amp;gt; Stateless なものに向いてる&lt;/span&gt;
&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-6"&gt;&lt;/a&gt;$ kubectl get pod
&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-7"&gt;&lt;/a&gt;NAME         READY   STATUS    RESTARTS   AGE
&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-8"&gt;&lt;/a&gt;echo-69gln   &lt;span class="m"&gt;2&lt;/span&gt;/2     Running   &lt;span class="m"&gt;0&lt;/span&gt;          39s
&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-9"&gt;&lt;/a&gt;echo-hm7ns   &lt;span class="m"&gt;2&lt;/span&gt;/2     Running   &lt;span class="m"&gt;0&lt;/span&gt;          39s
&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-10"&gt;&lt;/a&gt;echo-x9729   &lt;span class="m"&gt;2&lt;/span&gt;/2     Running   &lt;span class="m"&gt;0&lt;/span&gt;          39s
&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-12"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# ReplicaSet を削除する&lt;/span&gt;
&lt;a name="rest_code_db2e9630aeb04d749eb88318564864ad-13"&gt;&lt;/a&gt;$ kubectl delete -f simple-replicaset.yaml
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="deployment"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id16"&gt;5.8  Deployment&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;アプリケーションデプロイの基本単位となるリソース&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;Deployment&lt;/code&gt; &amp;gt;&amp;gt;&amp;gt; &lt;code class="docutils literal"&gt;ReplicaSet&lt;/code&gt; &amp;gt;&amp;gt;&amp;gt; &lt;code class="docutils literal"&gt;Pod&lt;/code&gt; たち&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ReplicaSet を管理/操作する&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Deployment は ReplicaSet の世代管理できる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;simple-deployment.yaml&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;apps/v1&lt;/span&gt;
&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Deployment&lt;/span&gt;  &lt;span class="c1"&gt;# ここが Deployment に&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
  &lt;span class="nt"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
&lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;replicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;3&lt;/span&gt;
  &lt;span class="nt"&gt;selector&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;matchLabels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
  &lt;span class="nt"&gt;template&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
    &lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;containers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;nginx&lt;/span&gt;
          &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;gihyodocker/nginx-proxy:latest&lt;/span&gt;
          &lt;span class="nt"&gt;env&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;BACKEND_HOST&lt;/span&gt;
              &lt;span class="nt"&gt;value&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;localhost:8080&lt;/span&gt;
          &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;containerPort&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;80&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
          &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;gihyodocker/echo:patched&lt;/span&gt;
&lt;span class="c1"&gt;#          image: gihyodocker/echo:latest&lt;/span&gt;
          &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;containerPort&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;8080&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# コマンドを記録できる ``--record`` オプションをつけて反映&lt;/span&gt;
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-2"&gt;&lt;/a&gt;$ kubectl apply -f simple-deployment.yaml --record
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-3"&gt;&lt;/a&gt;deployment.apps/echo created
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-5"&gt;&lt;/a&gt;$ kubectl get pod,replicaset,deployment --selector &lt;span class="nv"&gt;app&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-6"&gt;&lt;/a&gt;NAME                        READY   STATUS    RESTARTS   AGE
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-7"&gt;&lt;/a&gt;pod/echo-679c46ddf9-8rhgm   &lt;span class="m"&gt;2&lt;/span&gt;/2     Running   &lt;span class="m"&gt;0&lt;/span&gt;          107s
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-8"&gt;&lt;/a&gt;pod/echo-679c46ddf9-hl22n   &lt;span class="m"&gt;2&lt;/span&gt;/2     Running   &lt;span class="m"&gt;0&lt;/span&gt;          107s
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-9"&gt;&lt;/a&gt;pod/echo-679c46ddf9-kbm2g   &lt;span class="m"&gt;2&lt;/span&gt;/2     Running   &lt;span class="m"&gt;0&lt;/span&gt;          107s
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-10"&gt;&lt;/a&gt;
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-11"&gt;&lt;/a&gt;NAME                                    DESIRED   CURRENT   READY   AGE
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-12"&gt;&lt;/a&gt;replicaset.extensions/echo-679c46ddf9   &lt;span class="m"&gt;3&lt;/span&gt;         &lt;span class="m"&gt;3&lt;/span&gt;         &lt;span class="m"&gt;3&lt;/span&gt;       107s
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-14"&gt;&lt;/a&gt;NAME                         READY   UP-TO-DATE   AVAILABLE   AGE
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-15"&gt;&lt;/a&gt;deployment.extensions/echo   &lt;span class="m"&gt;3&lt;/span&gt;/3     &lt;span class="m"&gt;3&lt;/span&gt;            &lt;span class="m"&gt;3&lt;/span&gt;           107s
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-16"&gt;&lt;/a&gt;
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-17"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Deployment のリビジョンを確認する&lt;/span&gt;
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-18"&gt;&lt;/a&gt;$ kubectl rollout &lt;span class="nb"&gt;history&lt;/span&gt; deployment &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-19"&gt;&lt;/a&gt;deployment.extensions/echo
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-20"&gt;&lt;/a&gt;REVISION  CHANGE-CAUSE
&lt;a name="rest_code_a1ccbf6abb994efd879c712692ddb488-21"&gt;&lt;/a&gt;&lt;span class="m"&gt;1&lt;/span&gt;         kubectl apply --filename&lt;span class="o"&gt;=&lt;/span&gt;simple-deployment.yaml --record&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;/pre&gt;&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id17"&gt;ReplicaSet のライフサイクル&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Kubernetes では Deployment を 1つの単位としてアプリケーションをデプロイする&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;実運用では ReplicaSet を直接用いることはほとんどない&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Deployment のマニフェストファイルを扱う運用にする&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ReplicaSet 大事&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;指定された Pod 数の確保&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;新しいバージョンの Pod への入れ替え&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;以前のバージョンへの Pod のロールバック&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id6"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id18"&gt;挙動まとめ&lt;/a&gt;&lt;/h4&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Pod 数を変更: 新規 ReplicaSet 生まれない&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;コンテナ定義を更新: 新しいリビジョンが作成される&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 特定のリビジョンの内容を確認できる&lt;/span&gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-2"&gt;&lt;/a&gt;$ kubectl rollout &lt;span class="nb"&gt;history&lt;/span&gt; deployment &lt;span class="nb"&gt;echo&lt;/span&gt;  --revision&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-3"&gt;&lt;/a&gt;deployment.extensions/echo with revision &lt;span class="c1"&gt;#1&lt;/span&gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-4"&gt;&lt;/a&gt;Pod Template:
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-5"&gt;&lt;/a&gt;  Labels:     &lt;span class="nv"&gt;app&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-6"&gt;&lt;/a&gt;  pod-template-hash&lt;span class="o"&gt;=&lt;/span&gt;679c46ddf9
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-7"&gt;&lt;/a&gt;  Annotations:        kubernetes.io/change-cause: kubectl apply --filename&lt;span class="o"&gt;=&lt;/span&gt;simple-deployment.yaml --record&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-8"&gt;&lt;/a&gt;  Containers:
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-9"&gt;&lt;/a&gt;   nginx:
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-10"&gt;&lt;/a&gt;    Image:    gihyodocker/nginx-proxy:latest
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-11"&gt;&lt;/a&gt;    Port:     &lt;span class="m"&gt;80&lt;/span&gt;/TCP
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-12"&gt;&lt;/a&gt;    Host Port:        &lt;span class="m"&gt;0&lt;/span&gt;/TCP
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-13"&gt;&lt;/a&gt;    Environment:
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-14"&gt;&lt;/a&gt;      BACKEND_HOST:   localhost:8080
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-15"&gt;&lt;/a&gt;    Mounts:   &amp;lt;none&amp;gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-16"&gt;&lt;/a&gt;   echo:
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-17"&gt;&lt;/a&gt;    Image:    gihyodocker/echo:latest
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-18"&gt;&lt;/a&gt;    Port:     &lt;span class="m"&gt;8080&lt;/span&gt;/TCP
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-19"&gt;&lt;/a&gt;    Host Port:        &lt;span class="m"&gt;0&lt;/span&gt;/TCP
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-20"&gt;&lt;/a&gt;    Environment:      &amp;lt;none&amp;gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-21"&gt;&lt;/a&gt;    Mounts:   &amp;lt;none&amp;gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-22"&gt;&lt;/a&gt;  Volumes:    &amp;lt;none&amp;gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-23"&gt;&lt;/a&gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-24"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 直前の操作のリビジョンに Deployment をロールバックできる&lt;/span&gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-25"&gt;&lt;/a&gt;$ kubectl rollout undo deployment &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-26"&gt;&lt;/a&gt;deployment.extensions/echo rolled back
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-27"&gt;&lt;/a&gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-28"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 削除: 関連する ReplicaSet と Pod もいっしょに削除される&lt;/span&gt;
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-29"&gt;&lt;/a&gt;$ kubectl delete -f simple-deployment.yaml
&lt;a name="rest_code_8caef224dcc44c948e9f737be847b610-30"&gt;&lt;/a&gt;deployment.apps &lt;span class="s2"&gt;"echo"&lt;/span&gt; deleted
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="service"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id19"&gt;5.9 Service&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Kubernetes クラスタ内において、 Pod の集合 (主に ReplicaSet) に対する経路やサービスディスカバリを提供するためのリソース&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Service のターゲットとなる一連の Pod は、 Service で定義するラベルセレクタによって決定される&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;simple-replicaset-with-label.yaml&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 例として、 release ラベル spring/summer をつけて ReplicaSet を二つ定義する&lt;/span&gt;
&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;apps/v1&lt;/span&gt;
&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ReplicaSet&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo-spring&lt;/span&gt;
  &lt;span class="nt"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
    &lt;span class="nt"&gt;release&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;spring&lt;/span&gt;
&lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;replicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;1&lt;/span&gt;
  &lt;span class="nt"&gt;selector&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;matchLabels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
      &lt;span class="nt"&gt;release&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;spring&lt;/span&gt;
  &lt;span class="nt"&gt;template&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
        &lt;span class="nt"&gt;release&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;spring&lt;/span&gt;
    &lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;containers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;nginx&lt;/span&gt;
          &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;gihyodocker/nginx-proxy:latest&lt;/span&gt;
          &lt;span class="nt"&gt;env&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;BACKEND_HOST&lt;/span&gt;
              &lt;span class="nt"&gt;value&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;localhost:8080&lt;/span&gt;
          &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;containerPort&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;80&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
          &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;gihyodocker/echo:latest&lt;/span&gt;
          &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;containerPort&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;8080&lt;/span&gt;

&lt;span class="nn"&gt;---&lt;/span&gt;
&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;apps/v1&lt;/span&gt;
&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ReplicaSet&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo-summer&lt;/span&gt;
  &lt;span class="nt"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
    &lt;span class="nt"&gt;release&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;summer&lt;/span&gt;
&lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;replicas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;2&lt;/span&gt;
  &lt;span class="nt"&gt;selector&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;matchLabels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
      &lt;span class="nt"&gt;release&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;summer&lt;/span&gt;
  &lt;span class="nt"&gt;template&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
        &lt;span class="nt"&gt;release&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;summer&lt;/span&gt;
    &lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;containers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;nginx&lt;/span&gt;
          &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;gihyodocker/nginx-proxy:latest&lt;/span&gt;
          &lt;span class="nt"&gt;env&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;BACKEND_HOST&lt;/span&gt;
              &lt;span class="nt"&gt;value&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;localhost:8080&lt;/span&gt;
          &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;containerPort&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;80&lt;/span&gt;
        &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
          &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;gihyodocker/echo:latest&lt;/span&gt;
          &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;containerPort&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;8080&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# apply&lt;/span&gt;
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-2"&gt;&lt;/a&gt;$ kubectl apply -f simple-replicaset-with-label.yaml
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-3"&gt;&lt;/a&gt;replicaset.apps/echo-spring created
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-4"&gt;&lt;/a&gt;replicaset.apps/echo-summer created
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-6"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# release ラベルに spring/summer を持つ Pod がそれぞれつくられる&lt;/span&gt;
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-7"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# release ラベルに spring を持つ Pod&lt;/span&gt;
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-8"&gt;&lt;/a&gt;$ kubectl get pod -l &lt;span class="nv"&gt;app&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; -l &lt;span class="nv"&gt;release&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;spring
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-9"&gt;&lt;/a&gt;NAME                READY   STATUS    RESTARTS   AGE
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-10"&gt;&lt;/a&gt;echo-spring-67s58   &lt;span class="m"&gt;2&lt;/span&gt;/2     Running   &lt;span class="m"&gt;0&lt;/span&gt;          92s
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-12"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# release ラベルに summer を持つ Pod&lt;/span&gt;
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-13"&gt;&lt;/a&gt;$ kubectl get pod -l &lt;span class="nv"&gt;app&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; -l &lt;span class="nv"&gt;release&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;summer
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-14"&gt;&lt;/a&gt;NAME                READY   STATUS    RESTARTS   AGE
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-15"&gt;&lt;/a&gt;echo-summer-tnwb9   &lt;span class="m"&gt;2&lt;/span&gt;/2     Running   &lt;span class="m"&gt;0&lt;/span&gt;          110s
&lt;a name="rest_code_586b8a717c9645dfb204a17b3695f335-16"&gt;&lt;/a&gt;echo-summer-vb44t   &lt;span class="m"&gt;2&lt;/span&gt;/2     Running   &lt;span class="m"&gt;0&lt;/span&gt;          110s
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;simple-service.yaml&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# release=summer を持つ Pod だけにアクセスできる Service をつくる&lt;/span&gt;
&lt;span class="nt"&gt;apiVersion&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;v1&lt;/span&gt;
&lt;span class="nt"&gt;kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Service&lt;/span&gt;
&lt;span class="nt"&gt;metadata&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
&lt;span class="nt"&gt;spec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;selector&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;echo&lt;/span&gt;
    &lt;span class="nt"&gt;release&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;summer&lt;/span&gt;
  &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;http&lt;/span&gt;
      &lt;span class="nt"&gt;port&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;80&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# apply して Service を作成する&lt;/span&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-2"&gt;&lt;/a&gt;$ kubectl apply -f simple-service.yaml
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-3"&gt;&lt;/a&gt;service/echo created
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-5"&gt;&lt;/a&gt;$ kubectl get svc &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-6"&gt;&lt;/a&gt;NAME   TYPE        CLUSTER-IP       EXTERNAL-IP   PORT&lt;span class="o"&gt;(&lt;/span&gt;S&lt;span class="o"&gt;)&lt;/span&gt;   AGE
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-7"&gt;&lt;/a&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;   ClusterIP   &lt;span class="m"&gt;10&lt;/span&gt;.106.145.240   &amp;lt;none&amp;gt;        &lt;span class="m"&gt;80&lt;/span&gt;/TCP    51s
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-8"&gt;&lt;/a&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-9"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 基本的に Service は Kubernetes クラスタの中からしかアクセスできないので、&lt;/span&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-10"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Kubernetes クラスタ内に一時的なデバッグコンテナをデプロイ&lt;/span&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-11"&gt;&lt;/a&gt;$ kubectl run -i --rm --tty debug --image&lt;span class="o"&gt;=&lt;/span&gt;gihyodocker/fundamental:0.1.0 --restart&lt;span class="o"&gt;=&lt;/span&gt;Never -- bash -il
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-12"&gt;&lt;/a&gt;If you don&lt;span class="err"&gt;'&lt;/span&gt;t see a &lt;span class="nb"&gt;command&lt;/span&gt; prompt, try pressing enter.
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-14"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# curl で HTTP リクエストを送信してみる&lt;/span&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-15"&gt;&lt;/a&gt;debug:/# curl http://echo/
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-16"&gt;&lt;/a&gt;Hello Docker!!debug:/# curl http://echo/
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-17"&gt;&lt;/a&gt;Hello Docker!!debug:/# curl http://echo/
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-18"&gt;&lt;/a&gt;Hello Docker!!debug:/# curl http://echo/
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-19"&gt;&lt;/a&gt;Hello Docker!!debug:/# curl http://echo/
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-20"&gt;&lt;/a&gt;Hello Docker!!debug:/#
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-21"&gt;&lt;/a&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-22"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# summer にはリクエストが来ている&lt;/span&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-23"&gt;&lt;/a&gt;$ kubectl logs -f echo-summer-vb44t -c &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-24"&gt;&lt;/a&gt;&lt;span class="m"&gt;2019&lt;/span&gt;/11/17 &lt;span class="m"&gt;06&lt;/span&gt;:56:15 start server
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-25"&gt;&lt;/a&gt;&lt;span class="m"&gt;2019&lt;/span&gt;/11/17 &lt;span class="m"&gt;07&lt;/span&gt;:23:53 received request
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-26"&gt;&lt;/a&gt;&lt;span class="m"&gt;2019&lt;/span&gt;/11/17 &lt;span class="m"&gt;07&lt;/span&gt;:23:54 received request
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-27"&gt;&lt;/a&gt;&lt;span class="m"&gt;2019&lt;/span&gt;/11/17 &lt;span class="m"&gt;07&lt;/span&gt;:23:56 received request
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-28"&gt;&lt;/a&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-29"&gt;&lt;/a&gt;$ kubectl logs -f echo-summer-tnwb9 -c &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-30"&gt;&lt;/a&gt;&lt;span class="m"&gt;2019&lt;/span&gt;/11/17 &lt;span class="m"&gt;06&lt;/span&gt;:56:12 start server
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-31"&gt;&lt;/a&gt;&lt;span class="m"&gt;2019&lt;/span&gt;/11/17 &lt;span class="m"&gt;07&lt;/span&gt;:18:24 received request
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-32"&gt;&lt;/a&gt;&lt;span class="m"&gt;2019&lt;/span&gt;/11/17 &lt;span class="m"&gt;07&lt;/span&gt;:23:45 received request
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-33"&gt;&lt;/a&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-34"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# spring にはリクエストが来ていない&lt;/span&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-35"&gt;&lt;/a&gt;$ kubectl logs -f echo-spring-67s58 -c &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;a name="rest_code_a79d0dabb4a04d57a966aac3161e1132-36"&gt;&lt;/a&gt;&lt;span class="m"&gt;2019&lt;/span&gt;/11/17 &lt;span class="m"&gt;06&lt;/span&gt;:56:09 start server
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Service による名前解決は欠かせません&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/#id20"&gt;Service の名前解決&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Kubernetes クラスタ内の DNS では、 Service を &lt;code class="docutils literal"&gt;Service名.Namespace名.svc.local&lt;/code&gt; で名前解決できるようになっている&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_fb9a3ce0d88b4bcaaf1e02bb822b43ea-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# echo は default の Namespace に配置しているので、&lt;/span&gt;
&lt;a name="rest_code_fb9a3ce0d88b4bcaaf1e02bb822b43ea-2"&gt;&lt;/a&gt;$ curl http://echo.default.svc.local
&lt;a name="rest_code_fb9a3ce0d88b4bcaaf1e02bb822b43ea-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb9a3ce0d88b4bcaaf1e02bb822b43ea-4"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# .svc.local は省略可能&lt;/span&gt;
&lt;a name="rest_code_fb9a3ce0d88b4bcaaf1e02bb822b43ea-5"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 異なる Namespace の Service の名前解決は↓が最短&lt;/span&gt;
&lt;a name="rest_code_fb9a3ce0d88b4bcaaf1e02bb822b43ea-6"&gt;&lt;/a&gt;$ curl http://echo.default
&lt;a name="rest_code_fb9a3ce0d88b4bcaaf1e02bb822b43ea-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb9a3ce0d88b4bcaaf1e02bb822b43ea-8"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 同一の Namespace だと Service 名だけで名前解決できる&lt;/span&gt;
&lt;a name="rest_code_fb9a3ce0d88b4bcaaf1e02bb822b43ea-9"&gt;&lt;/a&gt;$ curl http://echo
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>docker</category><guid>https://32imuf.com/docker/introduction-to-practice-container-development/5-kubernetes-getting-started/</guid><pubDate>Fri, 15 Nov 2019 15:00:00 GMT</pubDate></item><item><title>Docker Compose で Django/PostgreSQL/MySQL 環境をつくろう</title><link>https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id1" id="id10"&gt;リファレンス・参考サイト書籍&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id2" id="id11"&gt;つくりかた&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id3" id="id12"&gt;構成&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id4" id="id13"&gt;設定ファイル&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id5" id="id14"&gt;起動&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id6" id="id15"&gt;つかいかた&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#app" id="id16"&gt;app コンテナ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#mysql-postgresql" id="id17"&gt;MySQL, PostgreSQL コンテナ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id7" id="id18"&gt;感想&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id8" id="id19"&gt;その他&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id9" id="id20"&gt;Python 公式イメージのルーツ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#docker-hub" id="id21"&gt;Docker Hub&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id10"&gt;リファレンス・参考サイト書籍&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ありがとうございました&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Python プロフェッショナルプログラミング第３版 &amp;gt; 01-01 Python のセットアップ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://hub.docker.com/_/ubuntu"&gt;ubuntu Docker Official Images&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;en_US.utf8&lt;/code&gt; を &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;apt-get&lt;/span&gt;&lt;/code&gt; するくだりを参考にした&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Ubuntu イメージにはデフォルトで &lt;code class="docutils literal"&gt;C&lt;/code&gt;, &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;C.UTF-8&lt;/span&gt;&lt;/code&gt;, and &lt;code class="docutils literal"&gt;POSIX&lt;/code&gt; locales が含まれている、これで UTF-8 locale を使うほとんどのひとには十分なはずだけれども、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;足りない場合は、&lt;code class="docutils literal"&gt;locales&lt;/code&gt; package からインストールしてね&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/"&gt;Best practices for writing Dockerfiles&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;RUN&lt;/code&gt; で &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;apt-get&lt;/span&gt;&lt;/code&gt; するときはこうすると良さそう&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;apt-get&lt;/span&gt; upgrade&lt;/code&gt; , &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;dist-upgrade&lt;/span&gt;&lt;/code&gt; するのは避けよう&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;apt-get&lt;/span&gt; update &amp;amp;&amp;amp; &lt;span class="pre"&gt;apt-get&lt;/span&gt; install &lt;span class="pre"&gt;-y&lt;/span&gt;&lt;/code&gt; はセットでやろう&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;こうすると、 latest package versions が install できる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;このテクニックは、 &lt;code class="docutils literal"&gt;cache busting&lt;/code&gt; として知られているらしい&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages はアルファベット順に並べる&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;重複に気づけるし、後から足したり減らしたりするのが容易になるから&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最後に &lt;code class="docutils literal"&gt;rm &lt;span class="pre"&gt;-rf&lt;/span&gt; /var/lib/apt/lists/*&lt;/code&gt; して apt キャッシュを clean up すると、 image size を減らせる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;良い見本&lt;/p&gt;
&lt;pre class="code docker"&gt;&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;RUN&lt;/span&gt; apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install -y &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-2"&gt;&lt;/a&gt;    aufs-tools &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-3"&gt;&lt;/a&gt;    automake &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-4"&gt;&lt;/a&gt;    build-essential &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-5"&gt;&lt;/a&gt;    curl &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-6"&gt;&lt;/a&gt;    dpkg-sig &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-7"&gt;&lt;/a&gt;    libcap-dev &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-8"&gt;&lt;/a&gt;    libsqlite3-dev &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-9"&gt;&lt;/a&gt;    mercurial &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-10"&gt;&lt;/a&gt;    reprepro &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-11"&gt;&lt;/a&gt;    ruby1.9.1 &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-12"&gt;&lt;/a&gt;    ruby1.9.1-dev &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-13"&gt;&lt;/a&gt;    &lt;span class="nv"&gt;s3cmd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.1.* &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_d7eead7d24c740d48d7f68e82f22879f-14"&gt;&lt;/a&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; rm -rf /var/lib/apt/lists/*
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/develop/dev-best-practices/"&gt;Docker development best practices&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;RUN&lt;/code&gt; で &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;apt-get&lt;/span&gt;&lt;/code&gt; するときはこうすると良さそう&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;2行で書くより、1行で書く&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;1行で書くと、イメージを小さくできる ( &lt;code class="docutils literal"&gt;layers&lt;/code&gt; がなんのことなのかはよくわからない)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;The first creates two layers in the image, while the second only creates one.&lt;/cite&gt;&lt;/p&gt;
&lt;pre class="code docker"&gt;&lt;a name="rest_code_d292d35471d64bc2a68f149a0b4a609a-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;RUN&lt;/span&gt; apt-get -y update
&lt;a name="rest_code_d292d35471d64bc2a68f149a0b4a609a-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;RUN&lt;/span&gt; apt-get install -y python
&lt;/pre&gt;&lt;pre class="code docker"&gt;&lt;a name="rest_code_b72136a7ab3b42b8aaa9ca326f506752-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;RUN&lt;/span&gt; apt-get -y update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install -y python
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://github.com/righ/djample/"&gt;くろのて勉強会 &amp;gt; DRF勉強会 (全6回) &amp;gt; djample&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;現場で使える Django の教科書 &amp;gt; D: Docker でラクラク開発&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://qiita.com/yagince/items/deba267f789604643bab"&gt;Docker Ubuntu18.04でtzdataをinstallするときにtimezoneの選択をしないでinstallする&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;途中で何も尋ねてほしくないときは、 &lt;code class="docutils literal"&gt;ENV DEBIAN_FRONTEND=noninteractive&lt;/code&gt; すると良さそう&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://stackoverflow.com/questions/27022373/python3-importerror-no-module-named-ctypes-when-using-value-from-module-mul/48045929"&gt;ModuleNotFoundError: No module named '_ctypes' の解決方法&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;事前に &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;libffi-dev&lt;/span&gt;&lt;/code&gt; パッケージのインストールが必要&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://www.t3a.jp/blog/infrastructure/set-timezone/"&gt;[Linux]タイムゾーン(Timezone)をUTCから日本標準時(JST)に変更する&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;シンボリックリンクを張り替える&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;ln &lt;span class="pre"&gt;-sf&lt;/span&gt; /usr/share/zoneinfo/Asia/Tokyo /etc/localtime&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.python.org/ja/3/using/unix.html#building-python"&gt;2.2. Python のビルド&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;make install&lt;/code&gt; の代わりに &lt;code class="docutils literal"&gt;make altinstall&lt;/code&gt; 推奨&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;警告 make install は python3 バイナリを上書きまたはリンクを破壊してしまうかもしれません。そのため、make install の代わりに exec_prefix/bin/pythonversion のみインストールする make altinstall が推奨されています。&lt;/cite&gt; だそうです。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id11"&gt;つくりかた&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;実際には、 PostgreSQL か MySQL かどちらか使うほうのみを生きとする。&lt;/p&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id12"&gt;構成&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_794807752c17459d97ab3222c0d50fc1-1"&gt;&lt;/a&gt;$ tree fufufu
&lt;a name="rest_code_794807752c17459d97ab3222c0d50fc1-2"&gt;&lt;/a&gt;fufufu
&lt;a name="rest_code_794807752c17459d97ab3222c0d50fc1-3"&gt;&lt;/a&gt;├── Dockerfile-app        &lt;span class="c1"&gt;# 1. Django プロジェクト作るよう Dockerfile&lt;/span&gt;
&lt;a name="rest_code_794807752c17459d97ab3222c0d50fc1-4"&gt;&lt;/a&gt;├── Dockerfile-mysql      &lt;span class="c1"&gt;# 2. MySQL よう Dockerfile&lt;/span&gt;
&lt;a name="rest_code_794807752c17459d97ab3222c0d50fc1-5"&gt;&lt;/a&gt;├── Dockerfile-postgres   &lt;span class="c1"&gt;# 3. PostgreSQL よう Dockerfile&lt;/span&gt;
&lt;a name="rest_code_794807752c17459d97ab3222c0d50fc1-6"&gt;&lt;/a&gt;├── docker-compose.yml    &lt;span class="c1"&gt;# 4. Composeファイル&lt;/span&gt;
&lt;a name="rest_code_794807752c17459d97ab3222c0d50fc1-7"&gt;&lt;/a&gt;└── requirements.txt      &lt;span class="c1"&gt;# 5. requirements.txt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id13"&gt;設定ファイル&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;Dockerfile-app&lt;/span&gt;&lt;/code&gt; : Django プロジェクトを入れるコンテナ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;Dockerfile-app&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; ubuntu:18.04&lt;/span&gt;

&lt;span class="c"&gt;# インストール中に何も尋ねてくるな&lt;/span&gt;
&lt;span class="k"&gt;ENV&lt;/span&gt; &lt;span class="nv"&gt;DEBIAN_FRONTEND&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;noninteractive

&lt;span class="c"&gt;# Python の環境変数を設定&lt;/span&gt;
&lt;span class="c"&gt;# stdout, stderr のバッファを無効に&lt;/span&gt;
&lt;span class="k"&gt;ENV&lt;/span&gt; PYTHONUNBUFFERED &lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="c"&gt;# ソースモジュールのインポート時に .pyc ファイルを作成しない&lt;/span&gt;
&lt;span class="k"&gt;ENV&lt;/span&gt; PYTHONDONTWRITEBYTECODE &lt;span class="m"&gt;1&lt;/span&gt;

&lt;span class="c"&gt;# locales をインストールして設定する&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; apt-get clean &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install -y locales &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; rm -rf /var/lib/apt/lists/* &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; localedef -i en_US -c -f UTF-8 -A /usr/share/locale/locale.alias en_US.UTF-8
&lt;span class="k"&gt;ENV&lt;/span&gt; LANG en_US.UTF-8
&lt;span class="k"&gt;ENV&lt;/span&gt; LANGUAGE en_US:en
&lt;span class="k"&gt;ENV&lt;/span&gt; LC_ALL en_US.UTF-8

&lt;span class="c"&gt;# タイムゾーンに JST を設定&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime

&lt;span class="c"&gt;# Python ビルドに必要な deb パッケージのインストール&lt;/span&gt;
&lt;span class="c"&gt;# `libffi-dev`: 3.6 では不要 (?) 、3.7 では必要&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; apt-get clean &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install -y &lt;span class="se"&gt;\&lt;/span&gt;
    build-essential &lt;span class="se"&gt;\&lt;/span&gt;
    python3-dev &lt;span class="se"&gt;\&lt;/span&gt;
    libsqlite3-dev &lt;span class="se"&gt;\&lt;/span&gt;
    libreadline6-dev &lt;span class="se"&gt;\&lt;/span&gt;
    libgdbm-dev &lt;span class="se"&gt;\&lt;/span&gt;
    zlib1g-dev &lt;span class="se"&gt;\&lt;/span&gt;
    libbz2-dev &lt;span class="se"&gt;\&lt;/span&gt;
    sqlite3 &lt;span class="se"&gt;\&lt;/span&gt;
    tk-dev &lt;span class="se"&gt;\&lt;/span&gt;
    zip &lt;span class="se"&gt;\&lt;/span&gt;
    libssl-dev &lt;span class="se"&gt;\&lt;/span&gt;
    libffi-dev &lt;span class="se"&gt;\&lt;/span&gt;
    wget &lt;span class="se"&gt;\&lt;/span&gt;
 &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; rm -rf /var/lib/apt/lists/*

&lt;span class="c"&gt;# Python をソースファイルからビルドしてインストール&lt;/span&gt;
&lt;span class="c"&gt;# `make altinstall`: `make install` の代わりに推奨&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; wget https://www.python.org/ftp/python/3.7.3/Python-3.7.3.tgz &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; tar xf Python-3.7.3.tgz &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; Python-3.7.3 &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; ./configure --prefix&lt;span class="o"&gt;=&lt;/span&gt;/opt/python3.7.3 &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; make &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; make altinstall

&lt;span class="c"&gt;# Python のシンボリックリンクを作成&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; ln -s /opt/python3.7.3/bin/python3.7 /usr/local/bin/python

&lt;span class="c"&gt;# pip のシンボリックリンクを作成&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; ln -s /opt/python3.7.3/bin/pip3.7 /usr/local/bin/pip

&lt;span class="c"&gt;# pip をアップグレード&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; pip install -U pip

&lt;span class="c"&gt;# mysqlclient のインストールに必要なので、インストールしておく&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; apt-get clean &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install -y &lt;span class="se"&gt;\&lt;/span&gt;
    default-libmysqlclient-dev &lt;span class="se"&gt;\&lt;/span&gt;
 &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; rm -rf /var/lib/apt/lists/*
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;Dockerfile-mysql&lt;/span&gt;&lt;/code&gt; : MySQL を入れるコンテナ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;Dockerfile-mysql&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; mysql:latest&lt;/span&gt;

&lt;span class="c"&gt;# locales をインストールして設定する&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install -y locales &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; rm -rf /var/lib/apt/lists/* &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; localedef -i en_US -c -f UTF-8 -A /usr/share/locale/locale.alias en_US.UTF-8
&lt;span class="k"&gt;ENV&lt;/span&gt; LANG en_US.UTF-8
&lt;span class="k"&gt;ENV&lt;/span&gt; LANGUAGE en_US:en
&lt;span class="k"&gt;ENV&lt;/span&gt; LC_ALL en_US.UTF-8

&lt;span class="c"&gt;# タイムゾーンに JST を設定&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;Dockerfile-postgres&lt;/span&gt;&lt;/code&gt; : PostgreSQL を入れるコンテナ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;Dockerfile-postgres&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; postgres:latest&lt;/span&gt;

&lt;span class="c"&gt;## locales をインストールして設定する (postgres の場合は、公式イメージで実行済み)&lt;/span&gt;
&lt;span class="c"&gt;## https://github.com/docker-library/postgres/blob/85aadc08c347cd20f199902c4b8b4f736341c3b8/11/Dockerfile&lt;/span&gt;
&lt;span class="c"&gt;#RUN apt-get update &amp;amp;&amp;amp; apt-get install -y locales &amp;amp;&amp;amp; rm -rf /var/lib/apt/lists/* \&lt;/span&gt;
&lt;span class="c"&gt;#  &amp;amp;&amp;amp; localedef -i en_US -c -f UTF-8 -A /usr/share/locale/locale.alias en_US.UTF-8&lt;/span&gt;
&lt;span class="c"&gt;#ENV LANG en_US.UTF-8&lt;/span&gt;
&lt;span class="k"&gt;ENV&lt;/span&gt; LANGUAGE en_US:en
&lt;span class="k"&gt;ENV&lt;/span&gt; LC_ALL en_US.UTF-8

&lt;span class="c"&gt;# タイムゾーンに JST を設定&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;docker-compose.yml&lt;/span&gt;&lt;/code&gt; : Composeファイル&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;docker-compose.yml&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;version&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;'3'&lt;/span&gt;

&lt;span class="nt"&gt;services&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;container_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufufu_app&lt;/span&gt;
    &lt;span class="nt"&gt;build&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.&lt;/span&gt;
      &lt;span class="nt"&gt;dockerfile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Dockerfile-app&lt;/span&gt;
    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.:/fufufu&lt;/span&gt;
    &lt;span class="nt"&gt;working_dir&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/fufufu&lt;/span&gt;
    &lt;span class="nt"&gt;command&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;bash -c "pip install -r requirements.txt &amp;amp;&amp;amp; bash"&lt;/span&gt;
    &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"8000:8000"&lt;/span&gt;
    &lt;span class="nt"&gt;tty&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;true&lt;/span&gt;  &lt;span class="c1"&gt;# 起動し続ける&lt;/span&gt;
    &lt;span class="nt"&gt;depends_on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;mysql&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;postgres&lt;/span&gt;

  &lt;span class="nt"&gt;mysql&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;container_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufufu_mysql&lt;/span&gt;
    &lt;span class="nt"&gt;build&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.&lt;/span&gt;
      &lt;span class="nt"&gt;dockerfile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Dockerfile-mysql&lt;/span&gt;
    &lt;span class="nt"&gt;command&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;--character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci&lt;/span&gt;
    &lt;span class="nt"&gt;restart&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;always&lt;/span&gt;
    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"mysql-data:/var/lib/mysql"&lt;/span&gt;
    &lt;span class="nt"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufufu&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_DATABASE&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufufu&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_USER&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufufu&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_PASSWORD&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufufu&lt;/span&gt;

  &lt;span class="nt"&gt;postgres&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;container_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufufu_postgres&lt;/span&gt;
    &lt;span class="nt"&gt;build&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.&lt;/span&gt;
      &lt;span class="nt"&gt;dockerfile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Dockerfile-postgres&lt;/span&gt;
    &lt;span class="nt"&gt;restart&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;always&lt;/span&gt;
    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"postgres-data:/var/lib/postgresql/data"&lt;/span&gt;
    &lt;span class="nt"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;POSTGRES_DB&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufufu&lt;/span&gt;
      &lt;span class="nt"&gt;POSTGRES_USER&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufufu&lt;/span&gt;
      &lt;span class="nt"&gt;POSTGRES_PASSWORD&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufufu&lt;/span&gt;

&lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;mysql-data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;postgres-data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;requirements.txt&lt;/code&gt; : requirements.txt&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;requirements.txt&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="na"&gt;Django&amp;gt;&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;2.1&lt;/span&gt;
&lt;span class="na"&gt;mysqlclient&lt;/span&gt;
&lt;span class="na"&gt;psycopg2-binary&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id14"&gt;起動&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_39b25f16f7b94ce08d784fe4f04e6838-1"&gt;&lt;/a&gt;$ docker-compose up
&lt;a name="rest_code_39b25f16f7b94ce08d784fe4f04e6838-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 再度 image ビルドからやり直したい&lt;/span&gt;
&lt;a name="rest_code_39b25f16f7b94ce08d784fe4f04e6838-3"&gt;&lt;/a&gt;$ docker-compose up --build
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id15"&gt;つかいかた&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="app"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id16"&gt;app コンテナ&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_50c49778b01f467ea9faed6dd7184f6d-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Django プロジェクトのコンテナに入る&lt;/span&gt;
&lt;a name="rest_code_50c49778b01f467ea9faed6dd7184f6d-2"&gt;&lt;/a&gt;$ docker container &lt;span class="nb"&gt;exec&lt;/span&gt; -it fufufu_app bash
&lt;a name="rest_code_50c49778b01f467ea9faed6dd7184f6d-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Django プロジェクトを作成する&lt;/span&gt;
&lt;a name="rest_code_50c49778b01f467ea9faed6dd7184f6d-4"&gt;&lt;/a&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /fufufu
&lt;a name="rest_code_50c49778b01f467ea9faed6dd7184f6d-5"&gt;&lt;/a&gt;$ /opt/python3.7.3/lib/python3.7/site-packages/django/bin/django-admin.py startproject config .
&lt;a name="rest_code_50c49778b01f467ea9faed6dd7184f6d-6"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# runserver する ( settings.py の ``ALLOWED_HOSTS`` に ``'0.0.0.0'`` を書いておかないと ``DisallowedHost`` になります)&lt;/span&gt;
&lt;a name="rest_code_50c49778b01f467ea9faed6dd7184f6d-7"&gt;&lt;/a&gt;$ python manage.py runserver &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:8000
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="mysql-postgresql"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id17"&gt;MySQL, PostgreSQL コンテナ&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_584744b579fa4d7fb82355ed78887635-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# MySQL のコンテナに入る&lt;/span&gt;
&lt;a name="rest_code_584744b579fa4d7fb82355ed78887635-2"&gt;&lt;/a&gt;$ docker container &lt;span class="nb"&gt;exec&lt;/span&gt; -it fufufu_mysql bash
&lt;a name="rest_code_584744b579fa4d7fb82355ed78887635-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# MySQL に入る&lt;/span&gt;
&lt;a name="rest_code_584744b579fa4d7fb82355ed78887635-4"&gt;&lt;/a&gt;$ mysql -u fufufu -D fufufu -p
&lt;a name="rest_code_584744b579fa4d7fb82355ed78887635-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_584744b579fa4d7fb82355ed78887635-6"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# PostgreSQL のコンテナに入る&lt;/span&gt;
&lt;a name="rest_code_584744b579fa4d7fb82355ed78887635-7"&gt;&lt;/a&gt;$ docker container &lt;span class="nb"&gt;exec&lt;/span&gt; -it fufufu_postgres bash
&lt;a name="rest_code_584744b579fa4d7fb82355ed78887635-8"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# PostgreSQL に入る&lt;/span&gt;
&lt;a name="rest_code_584744b579fa4d7fb82355ed78887635-9"&gt;&lt;/a&gt;$ psql -U fufufu fufufu
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id18"&gt;感想&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;Python をソースファイルからビルドしてインストール&lt;/code&gt; するのは時間がかかる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Django プロジェクトを作成するのに、venv を作らず、&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;/opt/python3.7.3/lib/python3.7/site-packages/django/bin/django-admin.py&lt;/span&gt; startproject config .&lt;/code&gt; じゃなくて、 &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;django-admin.py&lt;/span&gt; startproject config .&lt;/code&gt; できる方法ないのだろうか...&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;手動で &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;/opt/python3.7.3/lib/python3.7/site-packages/django/bin/&lt;/span&gt;&lt;/code&gt; に PATH を通せばできるけどそうじゃなくて自動でやってくれないのかな...&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id19"&gt;その他&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id20"&gt;Python 公式イメージのルーツ&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;python:latest, python:3 =&amp;gt; buildpack-deps:stretch =&amp;gt; debian:stretch&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;ubuntu は Debian-based ということだけれど、 Debian と ubuntu はどんな風に違うんだろうなあ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MySQL, PostgreSQL の公式イメージも Debian (debian:stretch-slim) だった&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="docker-hub"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/#id21"&gt;Docker Hub&lt;/a&gt;&lt;/h4&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://hub.docker.com/_/python"&gt;python Docker Official Images&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://hub.docker.com/_/buildpack-deps"&gt;buildpack-deps Docker Official Images&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;A collection of common build dependencies used for installing various modules, e.g., gems.&lt;/cite&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://hub.docker.com/_/debian"&gt;Debian Docker Official Images&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>docker</category><guid>https://32imuf.com/docker/create-django-env-with-docker-compose-psql-mysql/</guid><pubDate>Tue, 30 Apr 2019 15:00:00 GMT</pubDate></item><item><title>Docker Compose で MySQL DB をつくり Compose 外 (非 docker) の SQLAlchemy から接続する</title><link>https://32imuf.com/docker/connect-from-sqla-to-mysqldb/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id1" id="id19"&gt;リファレンス・ガイド&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#sqlalchemy" id="id20"&gt;SQLAlchemy&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#docker-hub" id="id21"&gt;Docker Hub&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#pypi" id="id22"&gt;PyPI&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#mysql-db" id="id23"&gt;MySQL DB をつくる&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id2" id="id24"&gt;1. 準備&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id3" id="id25"&gt;ディレクトリ構成&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id4" id="id26"&gt;設定ファイル&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id5" id="id27"&gt;2. 起動&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id6" id="id28"&gt;SQLAlchemy の設定&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id7" id="id29"&gt;mysqlclient&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id8" id="id30"&gt;接続文字列&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id9" id="id31"&gt;事前準備&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id10" id="id32"&gt;PyMySQL&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id11" id="id33"&gt;接続文字列&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id12" id="id34"&gt;事前準備&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id13" id="id35"&gt;mysql-connector-python&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id14" id="id36"&gt;接続文字列&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id15" id="id37"&gt;事前準備&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id16" id="id38"&gt;使ったメモ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id17" id="id39"&gt;※ 1.&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#note-aborted-connection" id="id40"&gt;※ 2. [Note] Aborted connection ...&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id18" id="id41"&gt;参考ページ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id19"&gt;リファレンス・ガイド&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="sqlalchemy"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id20"&gt;SQLAlchemy&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.sqlalchemy.org/en/latest/dialects/mysql.html"&gt;SQLAlchemy 1.3 Documentation: MySQL&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="docker-hub"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id21"&gt;Docker Hub&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://hub.docker.com/_/mysql"&gt;mysql Docker Official Images&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="pypi"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id22"&gt;PyPI&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://pypi.org/project/mysqlclient/"&gt;mysqlclient&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://pypi.org/project/PyMySQL/"&gt;PyMySQL&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://pypi.org/project/mysql-connector-python/"&gt;mysql-connector-python&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="mysql-db"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id23"&gt;MySQL DB をつくる&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id24"&gt;1. 準備&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="id3"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id25"&gt;ディレクトリ構成&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_879193b4e6904a5ea59f9bb86ad52078-1"&gt;&lt;/a&gt;$ tree mmm
&lt;a name="rest_code_879193b4e6904a5ea59f9bb86ad52078-2"&gt;&lt;/a&gt;mmm
&lt;a name="rest_code_879193b4e6904a5ea59f9bb86ad52078-3"&gt;&lt;/a&gt;├── Dockerfile-mysql
&lt;a name="rest_code_879193b4e6904a5ea59f9bb86ad52078-4"&gt;&lt;/a&gt;└── docker-compose.yml
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id26"&gt;設定ファイル&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Dockerfile-mysql&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;Dockerfile-mysql&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; mysql:5.7.12&lt;/span&gt;
&lt;span class="c"&gt;# `5.7.12` は自分の使いたいイメージのタグ&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; apt-get clean &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install -y locales locales-all vim
&lt;span class="c"&gt;# ↑のイメージそのままだと vi も vim も入っていなくて不便だったので vim も入れておく&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; locale-gen ja_JP.UTF-8
&lt;span class="k"&gt;ENV&lt;/span&gt; LANG ja_JP.UTF-8
&lt;span class="k"&gt;ENV&lt;/span&gt; LANGUAGE ja_JP:en
&lt;span class="k"&gt;ENV&lt;/span&gt; LC_ALL ja_JP.UTF-8
&lt;span class="k"&gt;RUN&lt;/span&gt; ln -sf /usr/share/zoneinfo/Japan /etc/localtime
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;docker-compose.yml&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;docker-compose.yml&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;version&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;'3'&lt;/span&gt;

&lt;span class="nt"&gt;services&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;db&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;container_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;mmm_db&lt;/span&gt;
    &lt;span class="nt"&gt;build&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.&lt;/span&gt;
      &lt;span class="nt"&gt;dockerfile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Dockerfile-mysql&lt;/span&gt;
    &lt;span class="c1"&gt;# 文字コードの設定をしておく&lt;/span&gt;
    &lt;span class="nt"&gt;command&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;--character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci&lt;/span&gt;
    &lt;span class="nt"&gt;restart&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;always&lt;/span&gt;
    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"db-data:/var/lib/mysql"&lt;/span&gt;
    &lt;span class="nt"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;mmm&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_DATABASE&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;mmm&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_USER&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;mmm&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_PASSWORD&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;mmm&lt;/span&gt;
    &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"3306:3306"&lt;/span&gt;  &lt;span class="c1"&gt;# 大事。ここを書いておかないと、 compose の外から繋げない。&lt;/span&gt;

&lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;db-data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id27"&gt;2. 起動&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_856d468a3cbe4c3d8bcadd98e62b8277-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# mmm 直下で実行する&lt;/span&gt;
&lt;a name="rest_code_856d468a3cbe4c3d8bcadd98e62b8277-2"&gt;&lt;/a&gt;$ docker-compose up
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id28"&gt;SQLAlchemy の設定&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id29"&gt;mysqlclient&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="id8"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id30"&gt;接続文字列&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_c268db5ce9ad4d61ac4c54357cd423be-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;mysqldb&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;mmm&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;mmm&lt;/span&gt;&lt;span class="nd"&gt;@127.0.0.1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3306&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mmm&lt;/span&gt;&lt;span class="err"&gt;?&lt;/span&gt;&lt;span class="n"&gt;charset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;utf8mb4&lt;/span&gt;
&lt;a name="rest_code_c268db5ce9ad4d61ac4c54357cd423be-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# mysql+mysqldb://&amp;lt;user&amp;gt;:&amp;lt;password&amp;gt;@&amp;lt;host&amp;gt;[:&amp;lt;port&amp;gt;]/&amp;lt;dbname&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id31"&gt;事前準備&lt;/a&gt;&lt;/h4&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;Python3 他のインストール&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;sudo apt-get install python3-dev default-libmysqlclient-dev ＃Debian / Ubuntu&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;sudo yum install python3-devel mysql-devel ＃Red Hat / CentOS&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;brew install mysql-connector-c # macOS (Homebrew) (Currently, it has bug. See below)&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;macOS の場合はバグあるらしくちょっと小細工が必要&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;/usr/local/bin/mysql_config&lt;/code&gt; を編集しないといけない (PyPI の Project description, GitHub の README に書いてある)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;mysql_config&lt;/code&gt; は &lt;code class="docutils literal"&gt;$ which mysql_config&lt;/code&gt; で探せる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;ol class="arabic" start="2"&gt;
&lt;li&gt;&lt;p&gt;mysqlclient のインストール&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_9e36c6bb03f24ea78a6e6a8b671da9b9-1"&gt;&lt;/a&gt;pip install mysqlclient
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id32"&gt;PyMySQL&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="id11"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id33"&gt;接続文字列&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_9491b99551c945c6bf794715d906bc7f-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;pymysql&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;mmm&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;mmm&lt;/span&gt;&lt;span class="nd"&gt;@127.0.0.1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3306&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mmm&lt;/span&gt;&lt;span class="err"&gt;?&lt;/span&gt;&lt;span class="n"&gt;charset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;utf8mb4&lt;/span&gt;
&lt;a name="rest_code_9491b99551c945c6bf794715d906bc7f-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# mysql+pymysql://&amp;lt;username&amp;gt;:&amp;lt;password&amp;gt;@&amp;lt;host&amp;gt;/&amp;lt;dbname&amp;gt;[?&amp;lt;options&amp;gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id34"&gt;事前準備&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;PyMySQL のインストール&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_7d6291fa27ff4000b6e4396254b978f6-1"&gt;&lt;/a&gt;pip install PyMySQL
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id13"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id35"&gt;mysql-connector-python&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="id14"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id36"&gt;接続文字列&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_7a55ebad29da4cd790dea2417493c370-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;mysqlconnector&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;mmm&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;mmm&lt;/span&gt;&lt;span class="nd"&gt;@127.0.0.1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3306&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mmm&lt;/span&gt;&lt;span class="err"&gt;?&lt;/span&gt;&lt;span class="n"&gt;charset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;utf8mb4&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;
&lt;a name="rest_code_7a55ebad29da4cd790dea2417493c370-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# mysql+mysqlconnector://&amp;lt;user&amp;gt;:&amp;lt;password&amp;gt;@&amp;lt;host&amp;gt;[:&amp;lt;port&amp;gt;]/&amp;lt;dbname&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id15"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id37"&gt;事前準備&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;mysql-connector-python のインストール&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_5897086c3ac1400eabcd8190fe19813f-1"&gt;&lt;/a&gt;pip install mysql-connector-python
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id16"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id38"&gt;使ったメモ&lt;/a&gt;&lt;/h2&gt;
&lt;table class="colwidths-auto"&gt;
&lt;thead&gt;
&lt;tr&gt;&lt;th class="head stub"&gt;&lt;/th&gt;
&lt;th class="head"&gt;&lt;p&gt;mysqlclient&lt;/p&gt;&lt;/th&gt;
&lt;th class="head"&gt;&lt;p&gt;PyMySQL&lt;/p&gt;&lt;/th&gt;
&lt;th class="head"&gt;&lt;p&gt;mysql-connector-python&lt;/p&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;th class="stub"&gt;&lt;p&gt;準備 ※1&lt;/p&gt;&lt;/th&gt;
&lt;td&gt;&lt;p&gt;ただの Python3 だけでは済まない、 &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;python3-dev&lt;/span&gt;&lt;/code&gt; をインストールする必要がある&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;python3&lt;/code&gt; パッケージ (実態は &lt;code class="docutils literal"&gt;python3.7&lt;/code&gt; とか) は実行に必要なものだけが入る&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;Python.h&lt;/code&gt; などのヘッダファイルや &lt;code class="docutils literal"&gt;python3.7.a&lt;/code&gt; などのスタティックリンクライブラリは入っていない&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;これらは、 &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;python3-dev&lt;/span&gt;&lt;/code&gt; (&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;python3.7-dev&lt;/span&gt;&lt;/code&gt;) でインストールされる。実行に必要がないため別れている。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;mysqlclient は C拡張を含んでるのでビルドする必要がある&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ビルドには &lt;code class="docutils literal"&gt;Python.h&lt;/code&gt; などのヘッダファイルが必要&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;昨今は C拡張であってもビルド済の wheel が pypi にあがってたりしてインストール時にビルドが必要ないものも増えているが、 mysqlclient は SSL のリンクの都合上 wheel を提供していないよう&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/td&gt;
&lt;td&gt;&lt;p&gt;ただの Python3 だけで済む&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;PyMySQL は C拡張を含まずピュア Python なのでビルドする必要がない&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;この場合 SSL はpythonをインストールしたときにリンクしたものを使う&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td&gt;&lt;p&gt;ただの Python3 だけで済む&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;th class="stub"&gt;&lt;p&gt;[Note] Aborted connection ※2&lt;/p&gt;&lt;/th&gt;
&lt;td&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;log_warnings = 2&lt;/code&gt; でも出ない&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;log_warnings = 2&lt;/code&gt; だと出る, 1 だと出ない&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;log_warnings = 2&lt;/code&gt; だと出る, 1 だと出ない&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;th class="stub"&gt;&lt;p&gt;SQLAlchemy のおし具合&lt;/p&gt;&lt;/th&gt;
&lt;td&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;mysqlclient supports Python 2 and Python 3 and is very stable.&lt;/cite&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一番おすすめに見える (個人の感想)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;The pymysql DBAPI is a pure Python port of the MySQL-python (MySQLdb) driver, and targets 100% compatibility.&lt;/cite&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;二番目におすすめに見える (個人の感想)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;特記事項なし&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;付け加えて言いたいことがないようなので、ふつうかな (個人の感想)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;th class="stub"&gt;&lt;p&gt;わたしの感想&lt;/p&gt;&lt;/th&gt;
&lt;td&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;ただの Python3 だけでは済まないのが手軽感減少、Mac だとけっこうめんどう。どうにかしてほしい。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;でも &lt;code class="docutils literal"&gt;Aborted connection&lt;/code&gt; が出ないのはなるほどと思った&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Django もこれをおすすめしていたので、できればこれが良いが、インストールのところがどうしてもひっかかる。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td&gt;&lt;p&gt;install が手軽でよい。 &lt;code class="docutils literal"&gt;Aborted connection&lt;/code&gt; はあまり気にしなくて良さそうでもあるし、 SQLA さんも二番目におすすめしている (空想) のでこれがいいかなあ。&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;install が手軽でよい。ほかはとくになし。&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;th class="stub"&gt;&lt;p&gt;aodag さんに教えてもらったことメモ&lt;/p&gt;&lt;/th&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;&lt;strong&gt;sqlalchemy で使うなら pymysql 使っとけ（断言）&lt;/strong&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class="section" id="id17"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id39"&gt;※ 1.&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;python3-dev&lt;/span&gt;&lt;/code&gt; が必要 or 不要な理由も aodag さんに教えていただきました。ありがとうございました。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="note-aborted-connection"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id40"&gt;※ 2. [Note] Aborted connection ...&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://dev.mysql.com/doc/refman/5.7/en/communication-errors.html"&gt;B.6.2.10 Communication Errors and Aborted Connections&lt;/a&gt;&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_c5d7b32b341c457481a8ee3120b9a3ec-1"&gt;&lt;/a&gt;db_1  &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-03-24T06:38:23.691896Z &lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Note&lt;span class="o"&gt;]&lt;/span&gt; Aborted connection &lt;span class="m"&gt;2&lt;/span&gt; to db: &lt;span class="s1"&gt;'mmm'&lt;/span&gt; user: &lt;span class="s1"&gt;'mmm'&lt;/span&gt; host: &lt;span class="s1"&gt;'172.27.0.1'&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Got an error reading communication packets&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;クライアントの接続方法とか切断方法に何か問題があるらしい&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;わたしの場合、同じコードでもドライバーによって出たり出なかったりする&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ログレベルを下げると出なくなる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;同じ事象のひとが世界中にけっこういる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;このログが出ていても、(ワーニングログがたくさん出ること以外に)「困った!」というひとはあまりいなそう&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id18"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/connect-from-sqla-to-mysqldb/#id41"&gt;参考ページ&lt;/a&gt;&lt;/h4&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://weblabo.oscasierra.net/mysql-error-reading-communication-packets/"&gt;MySQLで「Got an error reading communication packets」というエラーが出力される原因と対策&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://qiita.com/hit/items/da50428ca4b4162162a8"&gt;[MariaDB] Aborted connectionのワーニング対応に大いにハマる・・&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;などなど... ありがとうございました。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>docker</category><guid>https://32imuf.com/docker/connect-from-sqla-to-mysqldb/</guid><pubDate>Sat, 23 Mar 2019 15:00:00 GMT</pubDate></item><item><title>Docker Compose で Django/MySQL 環境をつくる その2</title><link>https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id1" id="id11"&gt;リファレンス・ガイド・参考書籍&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id2" id="id12"&gt;環境構築&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id3" id="id13"&gt;1. 準備&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id4" id="id14"&gt;ディレクトリ構成&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id5" id="id15"&gt;設定ファイル&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id7" id="id16"&gt;2. 最初の1回だけ実行&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id8" id="id17"&gt;3. 実行後の状態&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#settings-mysql" id="id18"&gt;4. settings に mysql の定義を追記する&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#webdb" id="id19"&gt;5. web・db コンテナを起動する&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id9" id="id20"&gt;環境構築メモ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#default-authentication-plugin-mysql-native-password" id="id21"&gt;&lt;strong&gt;※1&lt;/strong&gt;: default-authentication-plugin=mysql_native_password について&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#skip-host-cache-skip-name-resolve" id="id22"&gt;&lt;strong&gt;※2&lt;/strong&gt;: skip-host-cache, skip-name-resolve について&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id10" id="id23"&gt;使い方メモ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#image" id="id24"&gt;再び image ビルドしたくなったら&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id11"&gt;リファレンス・ガイド・参考書籍&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql"&gt;Docker Compose で Django/MySQL 環境をつくる&lt;/a&gt; と同じ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;現場で使える Django の教科書《基礎編》&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id12"&gt;環境構築&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id13"&gt;1. 準備&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="id4"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id14"&gt;ディレクトリ構成&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_ffb84bbee38e47339980de1eb7a60df7-1"&gt;&lt;/a&gt;$ tree fufu
&lt;a name="rest_code_ffb84bbee38e47339980de1eb7a60df7-2"&gt;&lt;/a&gt;fufu
&lt;a name="rest_code_ffb84bbee38e47339980de1eb7a60df7-3"&gt;&lt;/a&gt;├── Dockerfile-mysql
&lt;a name="rest_code_ffb84bbee38e47339980de1eb7a60df7-4"&gt;&lt;/a&gt;├── Dockerfile-web
&lt;a name="rest_code_ffb84bbee38e47339980de1eb7a60df7-5"&gt;&lt;/a&gt;├── docker-compose.yml
&lt;a name="rest_code_ffb84bbee38e47339980de1eb7a60df7-6"&gt;&lt;/a&gt;├── mysql
&lt;a name="rest_code_ffb84bbee38e47339980de1eb7a60df7-7"&gt;&lt;/a&gt;│   └── conf.d
&lt;a name="rest_code_ffb84bbee38e47339980de1eb7a60df7-8"&gt;&lt;/a&gt;│       └── mysql.cnf
&lt;a name="rest_code_ffb84bbee38e47339980de1eb7a60df7-9"&gt;&lt;/a&gt;└── requirements.txt
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id15"&gt;設定ファイル&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Dockerfile-web&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;Dockerfile-web&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; python:3&lt;/span&gt;
&lt;span class="k"&gt;ENV&lt;/span&gt; PYTHONUNBUFFERED &lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; mkdir /code
&lt;span class="k"&gt;WORKDIR&lt;/span&gt;&lt;span class="s"&gt; /code&lt;/span&gt;
&lt;span class="k"&gt;ADD&lt;/span&gt; requirements.txt /code/
&lt;span class="k"&gt;RUN&lt;/span&gt; pip install -r requirements.txt
&lt;span class="k"&gt;ADD&lt;/span&gt; . /code/
&lt;span class="c"&gt;# アプリケーションは `apps` ディレクトリ配下に作りたかったので、追加&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; mkdir apps
&lt;span class="k"&gt;WORKDIR&lt;/span&gt;&lt;span class="s"&gt; apps&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;docker-compose.yml&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;docker-compose.yml&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;version&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;'3'&lt;/span&gt;

&lt;span class="nt"&gt;services&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;db&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;container_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufu_db&lt;/span&gt;
    &lt;span class="nt"&gt;build&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.&lt;/span&gt;
      &lt;span class="nt"&gt;dockerfile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Dockerfile-mysql&lt;/span&gt;
    &lt;span class="nt"&gt;command&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;--default-authentication-plugin=mysql_native_password&lt;/span&gt;
    &lt;span class="nt"&gt;restart&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;always&lt;/span&gt;
    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"db-data:/var/lib/mysql"&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"./mysql/conf.d:/etc/mysql/conf.d"&lt;/span&gt;
    &lt;span class="nt"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufu&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_DATABASE&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufu&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_USER&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufu&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_PASSWORD&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufu&lt;/span&gt;

  &lt;span class="nt"&gt;web&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;container_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fufu_web&lt;/span&gt;
    &lt;span class="nt"&gt;build&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.&lt;/span&gt;
      &lt;span class="nt"&gt;dockerfile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Dockerfile-web&lt;/span&gt;
    &lt;span class="nt"&gt;command&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;python3 manage.py runserver 0.0.0.0:8000 --settings=settings.local&lt;/span&gt;
    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.:/code&lt;/span&gt;
    &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"3236:8000"&lt;/span&gt;
    &lt;span class="nt"&gt;depends_on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;db&lt;/span&gt;

&lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;db-data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;mysql.cnf&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;mysql.cnf&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Copyright (c) 2015, 2016, Oracle and/or its affiliates. All rights reserved.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# This program is free software; you can redistribute it and/or modify&lt;/span&gt;
&lt;span class="c1"&gt;# it under the terms of the GNU General Public License, version 2.0,&lt;/span&gt;
&lt;span class="c1"&gt;# as published by the Free Software Foundation.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# This program is also distributed with certain software (including&lt;/span&gt;
&lt;span class="c1"&gt;# but not limited to OpenSSL) that is licensed under separate terms,&lt;/span&gt;
&lt;span class="c1"&gt;# as designated in a particular file or component or in included license&lt;/span&gt;
&lt;span class="c1"&gt;# documentation.  The authors of MySQL hereby grant you an additional&lt;/span&gt;
&lt;span class="c1"&gt;# permission to link the program and your derivative works with the&lt;/span&gt;
&lt;span class="c1"&gt;# separately licensed software that they have included with MySQL.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# This program is distributed in the hope that it will be useful,&lt;/span&gt;
&lt;span class="c1"&gt;# but WITHOUT ANY WARRANTY; without even the implied warranty of&lt;/span&gt;
&lt;span class="c1"&gt;# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&lt;/span&gt;
&lt;span class="c1"&gt;# GNU General Public License, version 2.0, for more details.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# You should have received a copy of the GNU General Public License&lt;/span&gt;
&lt;span class="c1"&gt;# along with this program; if not, write to the Free Software&lt;/span&gt;
&lt;span class="c1"&gt;# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301  USA&lt;/span&gt;

&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# The MySQL  Client configuration file.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# For explanations see&lt;/span&gt;
&lt;span class="c1"&gt;# http://dev.mysql.com/doc/mysql/en/server-system-variables.html&lt;/span&gt;


&lt;span class="na"&gt;[mysqld]  # *** mysqlサーバーの設定 ***************&lt;/span&gt;
&lt;span class="c1"&gt;# https://dev.mysql.com/doc/refman/8.0/en/upgrading-from-previous-series.html#upgrade-caching-sha2-password&lt;/span&gt;
&lt;span class="c1"&gt;# https://dev.mysql.com/doc/refman/8.0/en/upgrading-from-previous-series.html#upgrade-caching-sha2-password-compatible-connectors&lt;/span&gt;
&lt;span class="c1"&gt;# https://dev.mysql.com/doc/mysqld-version-reference/en/optvar-changes-8-0.html&lt;/span&gt;
&lt;span class="c1"&gt;# [環境構築メモ ※1 参照のこと]&lt;/span&gt;
&lt;span class="na"&gt;default-authentication-plugin&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;mysql_native_password&lt;/span&gt;

&lt;span class="c1"&gt;# デフォルト状態で /etc/mysql/conf.d/docker.cnf に定義されているやつをコピーしておく&lt;/span&gt;
&lt;span class="c1"&gt;# もしくは、 docker.cnf として作っておく&lt;/span&gt;
&lt;span class="c1"&gt;# [環境構築メモ ※2 参照のこと]&lt;/span&gt;
&lt;span class="na"&gt;skip-host-cache&lt;/span&gt;
&lt;span class="na"&gt;skip-name-resolve&lt;/span&gt;

&lt;span class="c1"&gt;# https://mysqlserverteam.com/mysql-8-0-kana-sensitive-collation-for-japanese-ja_jp/&lt;/span&gt;
&lt;span class="na"&gt;collation-server&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;utf8mb4_ja_0900_as_cs_ks&lt;/span&gt;
&lt;span class="na"&gt;character-set-server&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;utf8mb4&lt;/span&gt;
&lt;span class="c1"&gt;# https://dev.mysql.com/doc/refman/8.0/en/server-options.html#option_mysqld_default-time-zone&lt;/span&gt;
&lt;span class="na"&gt;default-time-zone&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;'Asia/Tokyo'&lt;/span&gt;

&lt;span class="na"&gt;[client]  # *** mysqlクライアントの設定 ************&lt;/span&gt;
&lt;span class="na"&gt;default-character-set&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;utf8mb4&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;docker.cnf&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;docker.cnf&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="na"&gt;[mysqld]  # *** mysqlサーバーの設定 ***************&lt;/span&gt;
&lt;span class="na"&gt;skip-host-cache&lt;/span&gt;
&lt;span class="na"&gt;skip-name-resolve&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;あとの設定ファイルは &lt;a class="reference external" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql"&gt;Docker Compose で Django/MySQL 環境をつくる&lt;/a&gt; と同じ&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id16"&gt;2. 最初の1回だけ実行&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;web, db の docker image をビルド -&amp;gt; web で startproject する。 (ログを良く見ると、たぶん db コンテナの起動もしている。)&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# fufu 直下で実行する&lt;/span&gt;
$ docker-compose run web django-admin.py startproject config .
Building db
Step &lt;span class="m"&gt;1&lt;/span&gt;/7 : FROM mysql:latest
latest: Pulling from library/mysql
177e7ef0df69: Pulling fs layer
cac25352c4c8: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
8585afabb40a: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
1e4af4996053: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
c326522894da: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
9020d6b6b171: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
55eb37ec6e5f: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
37f3f3d72fbd: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
03f098d64268: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
46a52a54cfe9: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
202bc662895d: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
46014f07b258: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
Digest: sha256:196c04e1944c5e4ea3ab86ae5f78f697cf18ee43865f25e334a6ffb1dbea81e6
Status: Downloaded newer image &lt;span class="k"&gt;for&lt;/span&gt; mysql:latest
 ---&amp;gt; 102816b1ee7d
Step &lt;span class="m"&gt;2&lt;/span&gt;/7 : RUN apt-get clean &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install -y locales locales-all
 ---&amp;gt; Running in 976810f0d320
Get:1 http://repo.mysql.com/apt/debian stretch InRelease &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;.2 kB&lt;span class="o"&gt;]&lt;/span&gt;
Get:5 http://repo.mysql.com/apt/debian stretch/mysql-8.0 amd64 Packages &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;7186&lt;/span&gt; B&lt;span class="o"&gt;]&lt;/span&gt;
Ign:2 http://cdn-fastly.deb.debian.org/debian stretch InRelease
Get:3 http://security-cdn.debian.org/debian-security stretch/updates InRelease &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;94&lt;/span&gt;.3 kB&lt;span class="o"&gt;]&lt;/span&gt;
Get:4 http://cdn-fastly.deb.debian.org/debian stretch-updates InRelease &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;91&lt;/span&gt;.0 kB&lt;span class="o"&gt;]&lt;/span&gt;
Get:7 http://security-cdn.debian.org/debian-security stretch/updates/main amd64 Packages &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;464&lt;/span&gt; kB&lt;span class="o"&gt;]&lt;/span&gt;
Get:6 http://cdn-fastly.deb.debian.org/debian stretch Release &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;118&lt;/span&gt; kB&lt;span class="o"&gt;]&lt;/span&gt;
Get:8 http://cdn-fastly.deb.debian.org/debian stretch-updates/main amd64 Packages &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;5152&lt;/span&gt; B&lt;span class="o"&gt;]&lt;/span&gt;
Get:9 http://cdn-fastly.deb.debian.org/debian stretch Release.gpg &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2434&lt;/span&gt; B&lt;span class="o"&gt;]&lt;/span&gt;
Get:10 http://cdn-fastly.deb.debian.org/debian stretch/main amd64 Packages &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;7089&lt;/span&gt; kB&lt;span class="o"&gt;]&lt;/span&gt;
Fetched &lt;span class="m"&gt;7890&lt;/span&gt; kB in 5s &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1505&lt;/span&gt; kB/s&lt;span class="o"&gt;)&lt;/span&gt;
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
The following additional packages will be installed:
  libc-l10n
The following NEW packages will be installed:
  libc-l10n locales locales-all
&lt;span class="m"&gt;0&lt;/span&gt; upgraded, &lt;span class="m"&gt;3&lt;/span&gt; newly installed, &lt;span class="m"&gt;0&lt;/span&gt; to remove and &lt;span class="m"&gt;1&lt;/span&gt; not upgraded.
Need to get &lt;span class="m"&gt;7732&lt;/span&gt; kB of archives.
After this operation, &lt;span class="m"&gt;144&lt;/span&gt; MB of additional disk space will be used.
Get:1 http://cdn-fastly.deb.debian.org/debian stretch/main amd64 libc-l10n all &lt;span class="m"&gt;2&lt;/span&gt;.24-11+deb9u3 &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;820&lt;/span&gt; kB&lt;span class="o"&gt;]&lt;/span&gt;
Get:2 http://cdn-fastly.deb.debian.org/debian stretch/main amd64 locales all &lt;span class="m"&gt;2&lt;/span&gt;.24-11+deb9u3 &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;3287&lt;/span&gt; kB&lt;span class="o"&gt;]&lt;/span&gt;
Get:3 http://cdn-fastly.deb.debian.org/debian stretch/main amd64 locales-all amd64 &lt;span class="m"&gt;2&lt;/span&gt;.24-11+deb9u3 &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;3624&lt;/span&gt; kB&lt;span class="o"&gt;]&lt;/span&gt;
debconf: delaying package configuration, since apt-utils is not installed
Fetched &lt;span class="m"&gt;7732&lt;/span&gt; kB in 3s &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2190&lt;/span&gt; kB/s&lt;span class="o"&gt;)&lt;/span&gt;
Selecting previously unselected package libc-l10n.
&lt;span class="o"&gt;(&lt;/span&gt;Reading database ... &lt;span class="m"&gt;8866&lt;/span&gt; files and directories currently installed.&lt;span class="o"&gt;)&lt;/span&gt;
Preparing to unpack .../libc-l10n_2.24-11+deb9u3_all.deb ...
Unpacking libc-l10n &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.24-11+deb9u3&lt;span class="o"&gt;)&lt;/span&gt; ...
Selecting previously unselected package locales.
Preparing to unpack .../locales_2.24-11+deb9u3_all.deb ...
Unpacking locales &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.24-11+deb9u3&lt;span class="o"&gt;)&lt;/span&gt; ...
Selecting previously unselected package locales-all.
Preparing to unpack .../locales-all_2.24-11+deb9u3_amd64.deb ...
Unpacking locales-all &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.24-11+deb9u3&lt;span class="o"&gt;)&lt;/span&gt; ...
Setting up libc-l10n &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.24-11+deb9u3&lt;span class="o"&gt;)&lt;/span&gt; ...
Setting up locales &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.24-11+deb9u3&lt;span class="o"&gt;)&lt;/span&gt; ...
debconf: unable to initialize frontend: Dialog
debconf: &lt;span class="o"&gt;(&lt;/span&gt;TERM is not set, so the dialog frontend is not usable.&lt;span class="o"&gt;)&lt;/span&gt;
debconf: falling back to frontend: Readline
Generating locales &lt;span class="o"&gt;(&lt;/span&gt;this might take a &lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;...
Generation complete.
Setting up locales-all &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.24-11+deb9u3&lt;span class="o"&gt;)&lt;/span&gt; ...
Removing intermediate container 976810f0d320
 ---&amp;gt; a38ea7bd8cf5
Step &lt;span class="m"&gt;3&lt;/span&gt;/7 : RUN locale-gen ja_JP.UTF-8
 ---&amp;gt; Running in 45929bff7253
Generating locales &lt;span class="o"&gt;(&lt;/span&gt;this might take a &lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;...
Generation complete.
Removing intermediate container 45929bff7253
 ---&amp;gt; 61f34eeb1373
Step &lt;span class="m"&gt;4&lt;/span&gt;/7 : ENV LANG ja_JP.UTF-8
 ---&amp;gt; Running in 0edd321d2039
Removing intermediate container 0edd321d2039
 ---&amp;gt; 9d081db59b9d
Step &lt;span class="m"&gt;5&lt;/span&gt;/7 : ENV LANGUAGE ja_JP:en
 ---&amp;gt; Running in 3770c59b22a2
Removing intermediate container 3770c59b22a2
 ---&amp;gt; d1c0b275dfa6
Step &lt;span class="m"&gt;6&lt;/span&gt;/7 : ENV LC_ALL ja_JP.UTF-8
 ---&amp;gt; Running in 751e7ba46d23
Removing intermediate container 751e7ba46d23
 ---&amp;gt; 8b58a86198fe
Step &lt;span class="m"&gt;7&lt;/span&gt;/7 : RUN ln -sf /usr/share/zoneinfo/Japan /etc/localtime
 ---&amp;gt; Running in 4ee911d35ca8
Removing intermediate container 4ee911d35ca8
 ---&amp;gt; ae9e35a54368
Successfully built ae9e35a54368
Successfully tagged fufu_db:latest
WARNING: Image &lt;span class="k"&gt;for&lt;/span&gt; service db was built because it did not already exist. To rebuild this image you must use &lt;span class="sb"&gt;`&lt;/span&gt;docker-compose build&lt;span class="sb"&gt;`&lt;/span&gt; or &lt;span class="sb"&gt;`&lt;/span&gt;docker-compose up --build&lt;span class="sb"&gt;`&lt;/span&gt;.
Starting fufu_db ... &lt;span class="k"&gt;done&lt;/span&gt;
Building web
Step &lt;span class="m"&gt;1&lt;/span&gt;/9 : FROM python:3
 ---&amp;gt; 7c5fd2af3815
Step &lt;span class="m"&gt;2&lt;/span&gt;/9 : ENV PYTHONUNBUFFERED &lt;span class="m"&gt;1&lt;/span&gt;
 ---&amp;gt; Running in 1e7af8a959ba
Removing intermediate container 1e7af8a959ba
 ---&amp;gt; 145e89eeda68
Step &lt;span class="m"&gt;3&lt;/span&gt;/9 : RUN mkdir /code
 ---&amp;gt; Running in 8d0cf8c1af79
Removing intermediate container 8d0cf8c1af79
 ---&amp;gt; 50ee8eeb1e91
Step &lt;span class="m"&gt;4&lt;/span&gt;/9 : WORKDIR /code
 ---&amp;gt; Running in 170815b8e495
Removing intermediate container 170815b8e495
 ---&amp;gt; 2bb29d2d6a2d
Step &lt;span class="m"&gt;5&lt;/span&gt;/9 : ADD requirements.txt /code/
 ---&amp;gt; e7d415a86747
Step &lt;span class="m"&gt;6&lt;/span&gt;/9 : RUN pip install -r requirements.txt
 ---&amp;gt; Running in aca007d771ea
Collecting Django&amp;gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.11 &lt;span class="o"&gt;(&lt;/span&gt;from -r requirements.txt &lt;span class="o"&gt;(&lt;/span&gt;line &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
  Downloading https://files.pythonhosted.org/packages/36/50/078a42b4e9bedb94efd3e0278c0eb71650ed9672cdc91bd5542953bec17f/Django-2.1.5-py3-none-any.whl &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;7&lt;/span&gt;.3MB&lt;span class="o"&gt;)&lt;/span&gt;
Collecting mysqlclient&amp;gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.3.7 &lt;span class="o"&gt;(&lt;/span&gt;from -r requirements.txt &lt;span class="o"&gt;(&lt;/span&gt;line &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
  Downloading https://files.pythonhosted.org/packages/f7/a2/1230ebbb4b91f42ad6b646e59eb8855559817ad5505d81c1ca2b5a216040/mysqlclient-1.3.14.tar.gz &lt;span class="o"&gt;(&lt;/span&gt;91kB&lt;span class="o"&gt;)&lt;/span&gt;
Collecting mysql-connector-python &lt;span class="o"&gt;(&lt;/span&gt;from -r requirements.txt &lt;span class="o"&gt;(&lt;/span&gt;line &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
  Downloading https://files.pythonhosted.org/packages/83/e3/a8782597a548cbaab0e4a24060ecd44da7058a376c0d62182b1aa9797a13/mysql_connector_python-8.0.13-cp37-cp37m-manylinux1_x86_64.whl &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;8&lt;/span&gt;.2MB&lt;span class="o"&gt;)&lt;/span&gt;
Collecting pytz &lt;span class="o"&gt;(&lt;/span&gt;from Django&amp;gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.11-&amp;gt;-r requirements.txt &lt;span class="o"&gt;(&lt;/span&gt;line &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
  Downloading https://files.pythonhosted.org/packages/61/28/1d3920e4d1d50b19bc5d24398a7cd85cc7b9a75a490570d5a30c57622d34/pytz-2018.9-py2.py3-none-any.whl &lt;span class="o"&gt;(&lt;/span&gt;510kB&lt;span class="o"&gt;)&lt;/span&gt;
Collecting protobuf&amp;gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.0.0 &lt;span class="o"&gt;(&lt;/span&gt;from mysql-connector-python-&amp;gt;-r requirements.txt &lt;span class="o"&gt;(&lt;/span&gt;line &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
  Downloading https://files.pythonhosted.org/packages/3a/30/289ead101f94998d88e8961a3548aea29417ae0057be23972483cddebf4f/protobuf-3.6.1-cp37-cp37m-manylinux1_x86_64.whl &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.1MB&lt;span class="o"&gt;)&lt;/span&gt;
Requirement already satisfied: setuptools in /usr/local/lib/python3.7/site-packages &lt;span class="o"&gt;(&lt;/span&gt;from protobuf&amp;gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.0.0-&amp;gt;mysql-connector-python-&amp;gt;-r requirements.txt &lt;span class="o"&gt;(&lt;/span&gt;line &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;40&lt;/span&gt;.6.3&lt;span class="o"&gt;)&lt;/span&gt;
Collecting six&amp;gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.9 &lt;span class="o"&gt;(&lt;/span&gt;from protobuf&amp;gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.0.0-&amp;gt;mysql-connector-python-&amp;gt;-r requirements.txt &lt;span class="o"&gt;(&lt;/span&gt;line &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
  Downloading https://files.pythonhosted.org/packages/73/fb/00a976f728d0d1fecfe898238ce23f502a721c0ac0ecfedb80e0d88c64e9/six-1.12.0-py2.py3-none-any.whl
Building wheels &lt;span class="k"&gt;for&lt;/span&gt; collected packages: mysqlclient
  Running setup.py bdist_wheel &lt;span class="k"&gt;for&lt;/span&gt; mysqlclient: started
  Running setup.py bdist_wheel &lt;span class="k"&gt;for&lt;/span&gt; mysqlclient: finished with status &lt;span class="s1"&gt;'done'&lt;/span&gt;
  Stored in directory: /root/.cache/pip/wheels/6d/7d/cb/181963137c414938d4faac9a57c966fb3a6ef675c25641c41a
Successfully built mysqlclient
Installing collected packages: pytz, Django, mysqlclient, six, protobuf, mysql-connector-python
Successfully installed Django-2.1.5 mysql-connector-python-8.0.13 mysqlclient-1.3.14 protobuf-3.6.1 pytz-2018.9 six-1.12.0
Removing intermediate container aca007d771ea
 ---&amp;gt; 950aa5581bf7
Step &lt;span class="m"&gt;7&lt;/span&gt;/9 : ADD . /code/
 ---&amp;gt; 8d7f1f5cc717
Step &lt;span class="m"&gt;8&lt;/span&gt;/9 : RUN mkdir apps
 ---&amp;gt; c46748e3db9b
Step &lt;span class="m"&gt;9&lt;/span&gt;/9 : WORKDIR apps
 ---&amp;gt; c642446504e2
Successfully built c642446504e2
Successfully tagged fufu_web:latest
WARNING: Image &lt;span class="k"&gt;for&lt;/span&gt; service web was built because it did not already exist. To rebuild this image you must use &lt;span class="sb"&gt;`&lt;/span&gt;docker-compose build&lt;span class="sb"&gt;`&lt;/span&gt; or &lt;span class="sb"&gt;`&lt;/span&gt;docker-compose up --build&lt;span class="sb"&gt;`&lt;/span&gt;.
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id17"&gt;3. 実行後の状態&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-1"&gt;&lt;/a&gt;$ tree fufu
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-2"&gt;&lt;/a&gt;fufu
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-3"&gt;&lt;/a&gt;├── Dockerfile-mysql
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-4"&gt;&lt;/a&gt;├── Dockerfile-web
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-5"&gt;&lt;/a&gt;├── apps
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-6"&gt;&lt;/a&gt;│   ├── config
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-7"&gt;&lt;/a&gt;│   │   ├── __init__.py
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-8"&gt;&lt;/a&gt;│   │   ├── settings.py
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-9"&gt;&lt;/a&gt;│   │   ├── urls.py
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-10"&gt;&lt;/a&gt;│   │   └── wsgi.py
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-11"&gt;&lt;/a&gt;│   └── manage.py
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-12"&gt;&lt;/a&gt;├── docker-compose.yml
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-13"&gt;&lt;/a&gt;├── mysql
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-14"&gt;&lt;/a&gt;│   └── conf.d
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-15"&gt;&lt;/a&gt;│       └── mysql.cnf
&lt;a name="rest_code_e5362a89be5c4600b2cecf61b292004b-16"&gt;&lt;/a&gt;└── requirements.txt
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="settings-mysql"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id18"&gt;4. settings に mysql の定義を追記する&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;settings は環境ごとに分けたいので、 &lt;code class="docutils literal"&gt;apps&lt;/code&gt; 配下に settings ディレクトリを作ってそこ移動する&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_fb91b92304674d48af673d6c1f5b38c7-1"&gt;&lt;/a&gt;$ tree apps
&lt;a name="rest_code_fb91b92304674d48af673d6c1f5b38c7-2"&gt;&lt;/a&gt;apps
&lt;a name="rest_code_fb91b92304674d48af673d6c1f5b38c7-3"&gt;&lt;/a&gt;├── config
&lt;a name="rest_code_fb91b92304674d48af673d6c1f5b38c7-4"&gt;&lt;/a&gt;│   ├── __init__.py
&lt;a name="rest_code_fb91b92304674d48af673d6c1f5b38c7-5"&gt;&lt;/a&gt;│   ├── urls.py
&lt;a name="rest_code_fb91b92304674d48af673d6c1f5b38c7-6"&gt;&lt;/a&gt;│   └── wsgi.py
&lt;a name="rest_code_fb91b92304674d48af673d6c1f5b38c7-7"&gt;&lt;/a&gt;├── manage.py
&lt;a name="rest_code_fb91b92304674d48af673d6c1f5b38c7-8"&gt;&lt;/a&gt;└── settings
&lt;a name="rest_code_fb91b92304674d48af673d6c1f5b38c7-9"&gt;&lt;/a&gt;    └── local.py  &lt;span class="c1"&gt;# ← ローカル環境用&lt;/span&gt;
&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;settings/local.py&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_59ece0304025491fa3ec3c22e5160315-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;DATABASES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_59ece0304025491fa3ec3c22e5160315-2"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'default'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_59ece0304025491fa3ec3c22e5160315-3"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'ENGINE'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'django.db.backends.mysql'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_59ece0304025491fa3ec3c22e5160315-4"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'NAME'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'fufu'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_59ece0304025491fa3ec3c22e5160315-5"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'USER'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'fufu'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_59ece0304025491fa3ec3c22e5160315-6"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'PASSWORD'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'fufu'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_59ece0304025491fa3ec3c22e5160315-7"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'HOST'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'db'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# ここは docker-compose ファイルに指定したサービス名でないといけないらしい&lt;/span&gt;
&lt;a name="rest_code_59ece0304025491fa3ec3c22e5160315-8"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'PORT'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3306&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_59ece0304025491fa3ec3c22e5160315-9"&gt;&lt;/a&gt;    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_59ece0304025491fa3ec3c22e5160315-10"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="webdb"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id19"&gt;5. web・db コンテナを起動する&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_3d72310557a04e38a779bfb8311c994e-1"&gt;&lt;/a&gt;$ docker-compose up
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id20"&gt;環境構築メモ&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="default-authentication-plugin-mysql-native-password"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id21"&gt;&lt;strong&gt;※1&lt;/strong&gt;: default-authentication-plugin=mysql_native_password について&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;MySQL 8.0.4 からデフォルトの認証 plugin のデフォルト値が &lt;code class="docutils literal"&gt;mysql_native_password&lt;/code&gt; から &lt;code class="docutils literal"&gt;caching_sha2_password&lt;/code&gt; へ変更になった&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;そのため、 &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;default-authentication-plugin&lt;/span&gt;&lt;/code&gt; を指定していない状態で &lt;code class="docutils literal"&gt;caching_sha2_password&lt;/code&gt; に対応していないクライアント (今回の場合は &lt;code class="docutils literal"&gt;web&lt;/code&gt; ) から接続しようとすると、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;こんなエラー↓が出て接続できない ( &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;docker-compose&lt;/span&gt; up&lt;/code&gt; 時にこうなる)&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;web_1  &lt;span class="p"&gt;|&lt;/span&gt; Performing system checks...
web_1  &lt;span class="p"&gt;|&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt; System check identified no issues &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt; silenced&lt;span class="o"&gt;)&lt;/span&gt;.
web_1  &lt;span class="p"&gt;|&lt;/span&gt; Unhandled exception in thread started by &amp;lt;&lt;span class="k"&gt;function&lt;/span&gt; check_errors.&amp;lt;locals&amp;gt;.wrapper at 0x7fe293c032f0&amp;gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt; Traceback &lt;span class="o"&gt;(&lt;/span&gt;most recent call last&lt;span class="o"&gt;)&lt;/span&gt;:
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/backends/base/base.py"&lt;/span&gt;, line &lt;span class="m"&gt;216&lt;/span&gt;, in ensure_connection
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     self.connect&lt;span class="o"&gt;()&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/backends/base/base.py"&lt;/span&gt;, line &lt;span class="m"&gt;194&lt;/span&gt;, in connect
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     self.connection &lt;span class="o"&gt;=&lt;/span&gt; self.get_new_connection&lt;span class="o"&gt;(&lt;/span&gt;conn_params&lt;span class="o"&gt;)&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/backends/mysql/base.py"&lt;/span&gt;, line &lt;span class="m"&gt;227&lt;/span&gt;, in get_new_connection
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     &lt;span class="k"&gt;return&lt;/span&gt; Database.connect&lt;span class="o"&gt;(&lt;/span&gt;**conn_params&lt;span class="o"&gt;)&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/MySQLdb/__init__.py"&lt;/span&gt;, line &lt;span class="m"&gt;85&lt;/span&gt;, in Connect
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     &lt;span class="k"&gt;return&lt;/span&gt; Connection&lt;span class="o"&gt;(&lt;/span&gt;*args, **kwargs&lt;span class="o"&gt;)&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/MySQLdb/connections.py"&lt;/span&gt;, line &lt;span class="m"&gt;208&lt;/span&gt;, in __init__
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     super&lt;span class="o"&gt;(&lt;/span&gt;Connection, self&lt;span class="o"&gt;)&lt;/span&gt;.__init__&lt;span class="o"&gt;(&lt;/span&gt;*args, **kwargs2&lt;span class="o"&gt;)&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt; _mysql_exceptions.OperationalError: &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2006&lt;/span&gt;, &lt;span class="s2"&gt;"Authentication plugin 'caching_sha2_password' cannot be loaded: /usr/lib/x86_64-linux-gnu/mariadb18/plugin/caching_sha2_password.so: cannot open shared object file: No such file or directory"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt; The above exception was the direct cause of the following exception:
web_1  &lt;span class="p"&gt;|&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt; Traceback &lt;span class="o"&gt;(&lt;/span&gt;most recent call last&lt;span class="o"&gt;)&lt;/span&gt;:
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/utils/autoreload.py"&lt;/span&gt;, line &lt;span class="m"&gt;225&lt;/span&gt;, in wrapper
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     fn&lt;span class="o"&gt;(&lt;/span&gt;*args, **kwargs&lt;span class="o"&gt;)&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/core/management/commands/runserver.py"&lt;/span&gt;, line &lt;span class="m"&gt;120&lt;/span&gt;, in inner_run
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     self.check_migrations&lt;span class="o"&gt;()&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/core/management/base.py"&lt;/span&gt;, line &lt;span class="m"&gt;442&lt;/span&gt;, in check_migrations
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     &lt;span class="nv"&gt;executor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; MigrationExecutor&lt;span class="o"&gt;(&lt;/span&gt;connections&lt;span class="o"&gt;[&lt;/span&gt;DEFAULT_DB_ALIAS&lt;span class="o"&gt;])&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/migrations/executor.py"&lt;/span&gt;, line &lt;span class="m"&gt;18&lt;/span&gt;, in __init__
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     self.loader &lt;span class="o"&gt;=&lt;/span&gt; MigrationLoader&lt;span class="o"&gt;(&lt;/span&gt;self.connection&lt;span class="o"&gt;)&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/migrations/loader.py"&lt;/span&gt;, line &lt;span class="m"&gt;49&lt;/span&gt;, in __init__
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     self.build_graph&lt;span class="o"&gt;()&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/migrations/loader.py"&lt;/span&gt;, line &lt;span class="m"&gt;212&lt;/span&gt;, in build_graph
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     self.applied_migrations &lt;span class="o"&gt;=&lt;/span&gt; recorder.applied_migrations&lt;span class="o"&gt;()&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/migrations/recorder.py"&lt;/span&gt;, line &lt;span class="m"&gt;61&lt;/span&gt;, in applied_migrations
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     &lt;span class="k"&gt;if&lt;/span&gt; self.has_table&lt;span class="o"&gt;()&lt;/span&gt;:
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/migrations/recorder.py"&lt;/span&gt;, line &lt;span class="m"&gt;44&lt;/span&gt;, in has_table
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     &lt;span class="k"&gt;return&lt;/span&gt; self.Migration._meta.db_table in self.connection.introspection.table_names&lt;span class="o"&gt;(&lt;/span&gt;self.connection.cursor&lt;span class="o"&gt;())&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/backends/base/base.py"&lt;/span&gt;, line &lt;span class="m"&gt;255&lt;/span&gt;, in cursor
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     &lt;span class="k"&gt;return&lt;/span&gt; self._cursor&lt;span class="o"&gt;()&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/backends/base/base.py"&lt;/span&gt;, line &lt;span class="m"&gt;232&lt;/span&gt;, in _cursor
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     self.ensure_connection&lt;span class="o"&gt;()&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/backends/base/base.py"&lt;/span&gt;, line &lt;span class="m"&gt;216&lt;/span&gt;, in ensure_connection
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     self.connect&lt;span class="o"&gt;()&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/utils.py"&lt;/span&gt;, line &lt;span class="m"&gt;89&lt;/span&gt;, in __exit__
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     raise dj_exc_value.with_traceback&lt;span class="o"&gt;(&lt;/span&gt;traceback&lt;span class="o"&gt;)&lt;/span&gt; from exc_value
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/backends/base/base.py"&lt;/span&gt;, line &lt;span class="m"&gt;216&lt;/span&gt;, in ensure_connection
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     self.connect&lt;span class="o"&gt;()&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/backends/base/base.py"&lt;/span&gt;, line &lt;span class="m"&gt;194&lt;/span&gt;, in connect
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     self.connection &lt;span class="o"&gt;=&lt;/span&gt; self.get_new_connection&lt;span class="o"&gt;(&lt;/span&gt;conn_params&lt;span class="o"&gt;)&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/django/db/backends/mysql/base.py"&lt;/span&gt;, line &lt;span class="m"&gt;227&lt;/span&gt;, in get_new_connection
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     &lt;span class="k"&gt;return&lt;/span&gt; Database.connect&lt;span class="o"&gt;(&lt;/span&gt;**conn_params&lt;span class="o"&gt;)&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/MySQLdb/__init__.py"&lt;/span&gt;, line &lt;span class="m"&gt;85&lt;/span&gt;, in Connect
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     &lt;span class="k"&gt;return&lt;/span&gt; Connection&lt;span class="o"&gt;(&lt;/span&gt;*args, **kwargs&lt;span class="o"&gt;)&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt;   File &lt;span class="s2"&gt;"/usr/local/lib/python3.7/site-packages/MySQLdb/connections.py"&lt;/span&gt;, line &lt;span class="m"&gt;208&lt;/span&gt;, in __init__
web_1  &lt;span class="p"&gt;|&lt;/span&gt;     super&lt;span class="o"&gt;(&lt;/span&gt;Connection, self&lt;span class="o"&gt;)&lt;/span&gt;.__init__&lt;span class="o"&gt;(&lt;/span&gt;*args, **kwargs2&lt;span class="o"&gt;)&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt; django.db.utils.OperationalError: &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2006&lt;/span&gt;, &lt;span class="s2"&gt;"Authentication plugin 'caching_sha2_password' cannot be loaded: /usr/lib/x86_64-linux-gnu/mariadb18/plugin/caching_sha2_password.so: cannot open shared object file: No such file or directory"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Django から MySQL に接続する際は、 &lt;code class="docutils literal"&gt;caching_sha2_password&lt;/code&gt; に対応していない &lt;code class="docutils literal"&gt;mysqlclient&lt;/code&gt; を使っているようなので、それでも接続できるように、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;default-authentication-plugin=mysql_native_password&lt;/span&gt;&lt;/code&gt; の指定が必要 (なんだと思う)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;後から該当ユーザーの &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;default-authentication-plugin&lt;/span&gt;&lt;/code&gt; を変更するにはこう↓&lt;/p&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_a426a7fc80c34393aeec5b0d8ba80b2e-1"&gt;&lt;/a&gt;ALTER USER &lt;span class="s1"&gt;'fufu'&lt;/span&gt;
&lt;a name="rest_code_a426a7fc80c34393aeec5b0d8ba80b2e-2"&gt;&lt;/a&gt;  IDENTIFIED WITH mysql_native_password
&lt;a name="rest_code_a426a7fc80c34393aeec5b0d8ba80b2e-3"&gt;&lt;/a&gt;  BY &lt;span class="s1"&gt;'fufu'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="skip-host-cache-skip-name-resolve"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id22"&gt;&lt;strong&gt;※2&lt;/strong&gt;: skip-host-cache, skip-name-resolve について&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Docker Hub の MySQL 公式イメージ &lt;code class="docutils literal"&gt;mysql:latest&lt;/code&gt; からコンテナをそのまま起動すると、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;デフォルト状態で &lt;code class="docutils literal"&gt;/etc/mysql/conf.d/docker.cnf&lt;/code&gt; の &lt;code class="docutils literal"&gt;[mysqld]&lt;/code&gt; セクションにこのふたつが定義されている&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;2018/12/29 の Update で追加されたように (?) 見える&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;このふたつがないと、こんな感じ↓で延々とエラーになり、 db コンテナが起動できない&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ docker-compose up
Creating network &lt;span class="s2"&gt;"fufu_default"&lt;/span&gt; with the default driver
Creating volume &lt;span class="s2"&gt;"fufu_db-data"&lt;/span&gt; with default driver
Creating fufu_db ... &lt;span class="k"&gt;done&lt;/span&gt;
Creating fufu_web ... &lt;span class="k"&gt;done&lt;/span&gt;
Attaching to fufu_db, fufu_web
db_1   &lt;span class="p"&gt;|&lt;/span&gt; Initializing database
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:51.840057Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:51.840160Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013169&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; initializing of server in progress as process &lt;span class="m"&gt;31&lt;/span&gt;

&lt;span class="o"&gt;(&lt;/span&gt;中略&lt;span class="o"&gt;)&lt;/span&gt;

db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441764Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441886Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013236&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Newly created data directory /var/lib/mysql/ is unusable. You can safely remove it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441926Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:55.045197Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
fufu_db exited with code &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; Initializing database
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:51.840057Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:51.840160Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013169&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; initializing of server in progress as process &lt;span class="m"&gt;31&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441764Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441886Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013236&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Newly created data directory /var/lib/mysql/ is unusable. You can safely remove it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441926Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:55.045197Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:57.680035Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:57.680129Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:55:57.942301Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.026899Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.029078Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031090Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031510Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031827Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031895Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:55:58.032460Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:55:58.032548Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.032782Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.032832Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.032975Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:59.851741Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.499663Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.499753Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:02.758687Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.841674Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.844213Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846178Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846616Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846911Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846948Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:02.847441Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:02.847506Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.847644Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.847671Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.847769Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:04.258157Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
fufu_db exited with code &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; Initializing database
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:51.840057Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:51.840160Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013169&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; initializing of server in progress as process &lt;span class="m"&gt;31&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441764Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441886Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013236&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Newly created data directory /var/lib/mysql/ is unusable. You can safely remove it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441926Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:55.045197Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:57.680035Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:57.680129Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:55:57.942301Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.026899Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.029078Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031090Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031510Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031827Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031895Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:55:58.032460Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:55:58.032548Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.032782Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.032832Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.032975Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:59.851741Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.499663Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.499753Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:02.758687Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.841674Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.844213Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846178Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846616Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846911Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846948Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:02.847441Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:02.847506Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.847644Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.847671Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.847769Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:04.258157Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:06.885337Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:06.885434Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:07.153069Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.236161Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.238540Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.240561Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.240967Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241151Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241186Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:07.241673Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:07.241732Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241871Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241902Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241995Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:09.048029Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.651915Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.652007Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:11.912327Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.994607Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.996767Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.998486Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.998844Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999016Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999047Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:11.999541Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:11.999601Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999753Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999778Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999874Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:13.815771Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
fufu_db exited with code &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; Initializing database
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:51.840057Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:51.840160Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013169&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; initializing of server in progress as process &lt;span class="m"&gt;31&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441764Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441886Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013236&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Newly created data directory /var/lib/mysql/ is unusable. You can safely remove it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441926Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:55.045197Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:57.680035Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:57.680129Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:55:57.942301Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.026899Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.029078Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031090Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031510Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031827Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031895Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:55:58.032460Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:55:58.032548Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.032782Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.032832Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.032975Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:59.851741Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.499663Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.499753Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:02.758687Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.841674Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.844213Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846178Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846616Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846911Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846948Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:02.847441Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:02.847506Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.847644Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.847671Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.847769Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:04.258157Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:06.885337Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:06.885434Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:07.153069Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.236161Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.238540Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.240561Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.240967Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241151Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241186Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:07.241673Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:07.241732Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241871Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241902Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241995Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:09.048029Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.651915Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.652007Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:11.912327Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.994607Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.996767Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.998486Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.998844Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999016Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999047Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:11.999541Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:11.999601Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999753Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999778Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999874Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:13.815771Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.554707Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.554806Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:16.812075Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.895053Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.897313Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.899059Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.899390Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.899657Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.899694Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:16.900291Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:16.900354Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.900626Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.900654Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.900826Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:18.720970Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.019641Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.019736Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:23.282147Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.310746Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.317461Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.319319Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.320932Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.321207Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.321237Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:23.321817Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:23.321890Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.322074Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.322097Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.322247Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:25.183207Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
fufu_db exited with code &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; Initializing database
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:51.840057Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:51.840160Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013169&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; initializing of server in progress as process &lt;span class="m"&gt;31&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441764Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441886Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013236&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Newly created data directory /var/lib/mysql/ is unusable. You can safely remove it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:53.441926Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:55.045197Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:57.680035Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:57.680129Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:55:57.942301Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.026899Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.029078Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031090Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031510Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031827Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.031895Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:55:58.032460Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:55:58.032548Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.032782Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.032832Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:58.032975Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:55:59.851741Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.499663Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.499753Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:02.758687Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.841674Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.844213Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846178Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846616Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846911Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.846948Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:02.847441Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:02.847506Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.847644Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.847671Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:02.847769Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:04.258157Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:06.885337Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:06.885434Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:07.153069Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.236161Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.238540Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.240561Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.240967Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241151Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241186Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:07.241673Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:07.241732Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241871Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241902Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:07.241995Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:09.048029Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.651915Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.652007Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:11.912327Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.994607Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.996767Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.998486Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.998844Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999016Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999047Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:11.999541Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:11.999601Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999753Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999778Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:11.999874Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:13.815771Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.554707Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.554806Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:16.812075Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.895053Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.897313Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.899059Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.899390Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.899657Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.899694Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:16.900291Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:16.900354Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.900626Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.900654Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:16.900826Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:18.720970Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.019641Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.019736Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:23.282147Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.310746Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.317461Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.319319Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.320932Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.321207Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.321237Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:23.321817Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:23.321890Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.322074Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.322097Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:23.322247Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:25.183207Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:32.657838Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:32.657925Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:32.919082Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:33.002849Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:33.005166Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:33.006884Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:33.007190Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:33.007365Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:33.007399Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:33.007897Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:33.007959Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:33.008121Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:33.008148Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:33.008248Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:34.819455Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:48.777104Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011070&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="s1"&gt;'Disabling symbolic links using --skip-symbolic-links (or equivalent) is the default. Consider not using this option as it'&lt;/span&gt; is deprecated and will be removed in a future release.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:48.777198Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010116&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt; starting as process &lt;span class="m"&gt;1&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; mysqld: Table &lt;span class="s1"&gt;'mysql.plugin'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:49.036122Z 0 [ERROR] [MY-010735] [Server] Can'&lt;/span&gt;t open the mysql.plugin table. Please run mysql_upgrade to create it.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:49.117775Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010015&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Repl&lt;span class="o"&gt;]&lt;/span&gt; Gtid table is not ready to be used. Table &lt;span class="s1"&gt;'mysql.gtid_executed'&lt;/span&gt; cannot be opened.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:49.120188Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010068&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; CA certificate ca.pem is self signed.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:49.122183Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-011810&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Insecure configuration &lt;span class="k"&gt;for&lt;/span&gt; --pid-file: Location &lt;span class="s1"&gt;'/var/run/mysqld'&lt;/span&gt; in the path is accessible to all OS users. Consider choosing a different directory.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:49.122556Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010441&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Failed to open optimizer cost constant tables
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:49.122852Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-001146 - Table '&lt;/span&gt;mysql.component&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:49.122890Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-013129&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; A message intended &lt;span class="k"&gt;for&lt;/span&gt; a client cannot be sent there as no client-session is attached. Therefore, we&lt;span class="s1"&gt;'re sending the information to the error-log instead: MY-003543 - The mysql.component table is missing or has an incorrect definition.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:49.123460Z 0 [ERROR] [MY-010326] [Server] Fatal error: Can'&lt;/span&gt;t open and lock privilege tables: Table &lt;span class="s1"&gt;'mysql.user'&lt;/span&gt; doesn&lt;span class="s1"&gt;'t exist&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2019-01-20T11:56:49.123544Z 0 [Warning] [MY-010952] [Server] The privilege system failed to initialize correctly. If you have upgraded your server, make sure you'&lt;/span&gt;re executing mysql_upgrade to correct the issue.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:49.123830Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Warning&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010357&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Can&lt;span class="s1"&gt;'t open and lock time zone table: Table '&lt;/span&gt;mysql.time_zone_leap_second&lt;span class="s1"&gt;' doesn'&lt;/span&gt;t exist trying to live without them
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:49.123863Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010361&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Fatal error: Illegal or unknown default &lt;span class="nb"&gt;time&lt;/span&gt; zone &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:49.124062Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;ERROR&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010119&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; Aborting
db_1   &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt;-01-20T11:56:50.944319Z &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;MY-010910&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;Server&lt;span class="o"&gt;]&lt;/span&gt; /usr/sbin/mysqld: Shutdown &lt;span class="nb"&gt;complete&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;mysqld &lt;span class="m"&gt;8&lt;/span&gt;.0.13&lt;span class="o"&gt;)&lt;/span&gt;  MySQL Community Server - GPL.
fufu_db exited with code &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;わたしの場合は、 docker-compose ファイルでこう↓しているので、デフォルト状態では存在した &lt;code class="docutils literal"&gt;/etc/mysql/conf.d/docker.cnf&lt;/code&gt; を抹殺してしまっている&lt;/p&gt;
&lt;pre class="code yaml"&gt;&lt;a name="rest_code_8641135faa21472da3d49716633c3efe-1"&gt;&lt;/a&gt;&lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_8641135faa21472da3d49716633c3efe-2"&gt;&lt;/a&gt;  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"./mysql/conf.d:/etc/mysql/conf.d"&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;しかたがないので、自分の &lt;code class="docutils literal"&gt;mysql.cnf&lt;/code&gt; に転記することにした&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;このふたつがないとどうしてこのエラーになるのかわたしにはわかりません、だって全然関係ないこと言ってるように見えるのに...&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;このふたつの説明はここです: &lt;a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/host-cache.html"&gt;https://dev.mysql.com/doc/refman/8.0/en/host-cache.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id23"&gt;使い方メモ&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="image"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/#id24"&gt;再び image ビルドしたくなったら&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_2992a1b7439e49dca96ca06053e686ff-1"&gt;&lt;/a&gt;$ docker-compose run web django-admin.py startproject config .
&lt;/pre&gt;&lt;p&gt;とか&lt;/p&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_8fd75c9cb5bf42f5a0ac7a234b73def3-1"&gt;&lt;/a&gt;$ docker-compose run web django-admin.py startproject config .
&lt;a name="rest_code_8fd75c9cb5bf42f5a0ac7a234b73def3-2"&gt;&lt;/a&gt;$ docker-compose up
&lt;/pre&gt;&lt;p&gt;したあとに、再び image ビルドしたくなったら、&lt;/p&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_3884f16c069d4b5d96caf358a44da4d5-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# web をビルド&lt;/span&gt;
&lt;a name="rest_code_3884f16c069d4b5d96caf358a44da4d5-2"&gt;&lt;/a&gt;$ docker-compose build web
&lt;a name="rest_code_3884f16c069d4b5d96caf358a44da4d5-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_3884f16c069d4b5d96caf358a44da4d5-4"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# db をビルド&lt;/span&gt;
&lt;a name="rest_code_3884f16c069d4b5d96caf358a44da4d5-5"&gt;&lt;/a&gt;$ docker-compose build db
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>docker</category><guid>https://32imuf.com/docker/create-django-env-with-docker-compose-mysql-2/</guid><pubDate>Sat, 19 Jan 2019 15:00:00 GMT</pubDate></item><item><title>Docker Compose で Django/MySQL 環境をつくる</title><link>https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id1" id="id11"&gt;リファレンス・ガイド&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id2" id="id12"&gt;環境構築&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id3" id="id13"&gt;最初の1回だけ実行&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id4" id="id14"&gt;2回目以降&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id5" id="id15"&gt;ディレクトリ構成&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id6" id="id16"&gt;設定ファイル&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id7" id="id17"&gt;使い方メモ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id8" id="id18"&gt;イメージビルドからやり直したい&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#volume" id="id19"&gt;volume は消さない限り再利用される&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#web" id="id20"&gt;web のほうのコンテナだけ再起動したいとき&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id9" id="id21"&gt;web のほうのコンテナに入る&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#mysql" id="id22"&gt;mysql のほうのコンテナに入る&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id10" id="id23"&gt;mysql に入る&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#todo" id="id24"&gt;TODO&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id11"&gt;リファレンス・ガイド&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/compose/compose-file/"&gt;Compose file version 3 reference&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://hub.docker.com/_/mysql/"&gt;Docker Hub の MySQL 公式イメージぺージ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;docker-compose&lt;/span&gt;&lt;/code&gt; ファイルの書き方見本とか、 Environment Variables の一覧とかが載っていた&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/"&gt;MySQL 8.0 Reference Manual&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;MySQL 自体のリファレンス&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/environment-variables.html"&gt;MySQL Program Environment Variables&lt;/a&gt; :
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;docker-compose&lt;/span&gt;&lt;/code&gt; ファイルの &lt;code class="docutils literal"&gt;environment&lt;/code&gt; 部分に書けるやつを探すときに使った&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/server-options.html"&gt;Server Command Options&lt;/a&gt; :
&lt;code class="docutils literal"&gt;mysql.cnf&lt;/code&gt; に書けるやつ、 &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;docker-compose&lt;/span&gt;&lt;/code&gt; ファイルの &lt;code class="docutils literal"&gt;command&lt;/code&gt; 部分に書けるやつを探すときに使った&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html"&gt;Server System Variables&lt;/a&gt; :
&lt;code class="docutils literal"&gt;mysql.cnf&lt;/code&gt; に書けるやつを探すときに使った&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://pypi.org/project/mysql-connector-python/"&gt;PyPI の mysql-connector-python のページ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;MySQL の driver。これが Oracle 純正のものらしい。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://dev.mysql.com/doc/connector-python/en/"&gt;MySQL Connector/Python Developer Guide&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;mysql-connector-python のガイドページ。使い方や見本がいろいろ載っている。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://pypi.org/project/mysqlclient/"&gt;PyPI の mysqlclient のページ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.1/ref/databases/#mysql-notes"&gt;Django で MySQL を使うときは見てねページ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Django のほうの説明を読んだら、 &lt;code class="docutils literal"&gt;mysqlclient&lt;/code&gt; がおすすめ、かつ、 &lt;cite&gt;Django requires mysqlclient 1.3.7 or later.&lt;/cite&gt; と書いてある。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;とりあえず &lt;code class="docutils literal"&gt;mysqlclient&lt;/code&gt; と &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;mysql-connector-python&lt;/span&gt;&lt;/code&gt; を両方入れてみる。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id12"&gt;環境構築&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id13"&gt;最初の1回だけ実行&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p&gt;web・db の docker image をビルド -&amp;gt; web で startproject する。&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_82cbe30139684f0c8233e48e5df4bb58-1"&gt;&lt;/a&gt;$ docker-compose --pull&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt; run web django-admin.py startproject fu .
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;--pull=true&lt;/span&gt;&lt;/code&gt; : FROM に指定したベースイメージがローカルにすでに存在していても、改めて Docker Hub に取得しにいく&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;↑今やったら使えなかった。最新イメージを再取得するには、どうすればいいんだろう。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;settings に MySQL の設定を書き足す&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_a545b0ca8bfb48a894512e9c752c45db-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;DATABASES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_a545b0ca8bfb48a894512e9c752c45db-2"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'default'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_a545b0ca8bfb48a894512e9c752c45db-3"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'ENGINE'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'django.db.backends.mysql'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_a545b0ca8bfb48a894512e9c752c45db-4"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'NAME'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'fu'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_a545b0ca8bfb48a894512e9c752c45db-5"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'USER'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'fu'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_a545b0ca8bfb48a894512e9c752c45db-6"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'PASSWORD'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'fu'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_a545b0ca8bfb48a894512e9c752c45db-7"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'HOST'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'db'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_a545b0ca8bfb48a894512e9c752c45db-8"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'PORT'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3306&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_a545b0ca8bfb48a894512e9c752c45db-9"&gt;&lt;/a&gt;    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_a545b0ca8bfb48a894512e9c752c45db-10"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;docker-compose up して、 web・db コンテナを起動する&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_ae31ee8880ff4dd8924c268e727ba0b8-1"&gt;&lt;/a&gt;$ docker-compose up
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id14"&gt;2回目以降&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p&gt;docker-compose up して mysql・web コンテナを起動する。&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_f3815b17590548b4a57031aa49c90b66-1"&gt;&lt;/a&gt;$ docker-compose up
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;安全にシャットダウン。コンテナの停止と削除。&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_9b953cf25cb8417fafac49e1300d9676-1"&gt;&lt;/a&gt;$ docker-compose down
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;span id="config-files"&gt;&lt;/span&gt;&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id15"&gt;ディレクトリ構成&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-1"&gt;&lt;/a&gt;$ tree fu
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-3"&gt;&lt;/a&gt;fu
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-4"&gt;&lt;/a&gt;├── Dockerfile-mysql
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-5"&gt;&lt;/a&gt;├── Dockerfile-web
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-6"&gt;&lt;/a&gt;├── docker-compose.yml
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-7"&gt;&lt;/a&gt;├── fu
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-8"&gt;&lt;/a&gt;│   ├── __init__.py
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-9"&gt;&lt;/a&gt;│   ├── urls.py
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-10"&gt;&lt;/a&gt;│   └── wsgi.py
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-11"&gt;&lt;/a&gt;├── manage.py
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-12"&gt;&lt;/a&gt;├── mysql
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-13"&gt;&lt;/a&gt;│   └── conf.d
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-14"&gt;&lt;/a&gt;│       └── mysql.cnf
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-15"&gt;&lt;/a&gt;├── requirements.txt
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-16"&gt;&lt;/a&gt;└── settings
&lt;a name="rest_code_cf96e0ae9abf4ffcbe8df65723b9bf21-17"&gt;&lt;/a&gt;    └── _.py
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id16"&gt;設定ファイル&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;fu/docker-compose.yml&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;docker-compose.yml&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;version&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;'3'&lt;/span&gt;

&lt;span class="nt"&gt;services&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;db&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;container_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fu_db&lt;/span&gt;
    &lt;span class="nt"&gt;build&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.&lt;/span&gt;
      &lt;span class="nt"&gt;dockerfile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Dockerfile-mysql&lt;/span&gt;
    &lt;span class="nt"&gt;restart&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;always&lt;/span&gt;
    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"db-data:/var/lib/mysql"&lt;/span&gt;
      &lt;span class="c1"&gt;# mysql のカスタム設定ファイルもホスト &amp;lt;-&amp;gt; コンテナ間で同期しておく (編集するのに便利だから)&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"./mysql/conf.d:/etc/mysql/conf.d"&lt;/span&gt;
    &lt;span class="nt"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fu&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_DATABASE&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fu&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_USER&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fu&lt;/span&gt;
      &lt;span class="nt"&gt;MYSQL_PASSWORD&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fu&lt;/span&gt;

  &lt;span class="nt"&gt;web&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;container_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;fu_web&lt;/span&gt;
    &lt;span class="nt"&gt;build&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.&lt;/span&gt;
      &lt;span class="nt"&gt;dockerfile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Dockerfile-web&lt;/span&gt;
    &lt;span class="nt"&gt;command&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;python3 manage.py runserver 0.0.0.0:8000 --settings=settings._&lt;/span&gt;
    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.:/code&lt;/span&gt;
    &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"6560:8000"&lt;/span&gt;
    &lt;span class="nt"&gt;depends_on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;db&lt;/span&gt;

&lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;db-data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;fu/Dockerfile-web&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;Dockerfile-web&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; python:3&lt;/span&gt;
&lt;span class="k"&gt;ENV&lt;/span&gt; PYTHONUNBUFFERED &lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; mkdir /code
&lt;span class="k"&gt;WORKDIR&lt;/span&gt;&lt;span class="s"&gt; /code&lt;/span&gt;
&lt;span class="k"&gt;ADD&lt;/span&gt; requirements.txt /code/
&lt;span class="k"&gt;RUN&lt;/span&gt; pip install -r requirements.txt
&lt;span class="k"&gt;ADD&lt;/span&gt; . /code/
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;fu/Dockerfile-mysql&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;Dockerfile-mysql&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; mysql:latest&lt;/span&gt;
&lt;span class="c"&gt;# locales をインストールする&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; apt-get clean &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install -y locales locales-all
&lt;span class="c"&gt;# locale 定義ファイルをコンパイルする&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; locale-gen ja_JP.UTF-8
&lt;span class="c"&gt;# 日本語を設定する TODO: もしかして LANG だけでいいのかも...?&lt;/span&gt;
&lt;span class="k"&gt;ENV&lt;/span&gt; LANG ja_JP.UTF-8
&lt;span class="k"&gt;ENV&lt;/span&gt; LANGUAGE ja_JP:en
&lt;span class="k"&gt;ENV&lt;/span&gt; LC_ALL ja_JP.UTF-8
&lt;span class="c"&gt;# タイムゾーンに日本を設定する&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; ln -sf /usr/share/zoneinfo/Japan /etc/localtime
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;fu/requirements.txt&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;requirements.txt&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Django&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.11&lt;/span&gt;
&lt;span class="n"&gt;mysqlclient&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;
&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;connector&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;fu/mysql/conf.d/mysql.cnf&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;mysql.cnf&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Copyright (c) 2015, 2016, Oracle and/or its affiliates. All rights reserved.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# This program is free software; you can redistribute it and/or modify&lt;/span&gt;
&lt;span class="c1"&gt;# it under the terms of the GNU General Public License, version 2.0,&lt;/span&gt;
&lt;span class="c1"&gt;# as published by the Free Software Foundation.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# This program is also distributed with certain software (including&lt;/span&gt;
&lt;span class="c1"&gt;# but not limited to OpenSSL) that is licensed under separate terms,&lt;/span&gt;
&lt;span class="c1"&gt;# as designated in a particular file or component or in included license&lt;/span&gt;
&lt;span class="c1"&gt;# documentation.  The authors of MySQL hereby grant you an additional&lt;/span&gt;
&lt;span class="c1"&gt;# permission to link the program and your derivative works with the&lt;/span&gt;
&lt;span class="c1"&gt;# separately licensed software that they have included with MySQL.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# This program is distributed in the hope that it will be useful,&lt;/span&gt;
&lt;span class="c1"&gt;# but WITHOUT ANY WARRANTY; without even the implied warranty of&lt;/span&gt;
&lt;span class="c1"&gt;# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&lt;/span&gt;
&lt;span class="c1"&gt;# GNU General Public License, version 2.0, for more details.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# You should have received a copy of the GNU General Public License&lt;/span&gt;
&lt;span class="c1"&gt;# along with this program; if not, write to the Free Software&lt;/span&gt;
&lt;span class="c1"&gt;# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301  USA&lt;/span&gt;

&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# The MySQL  Client configuration file.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# For explanations see&lt;/span&gt;
&lt;span class="c1"&gt;# http://dev.mysql.com/doc/mysql/en/server-system-variables.html&lt;/span&gt;


&lt;span class="na"&gt;[mysqld]  # mysqlサーバーの設定&lt;/span&gt;
&lt;span class="na"&gt;default-authentication-plugin&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;mysql_native_password&lt;/span&gt;
&lt;span class="c1"&gt;# Collation (文字照合順) の設定: https://mysqlserverteam.com/mysql-8-0-kana-sensitive-collation-for-japanese-ja_jp/&lt;/span&gt;
&lt;span class="na"&gt;collation-server&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;utf8mb4_ja_0900_as_cs_ks&lt;/span&gt;
&lt;span class="c1"&gt;# サーバー側の文字コードの設定: "Default Value (&amp;gt;= 8.0.1)	utf8mb4" だけれどもなんとなく念のため指定&lt;/span&gt;
&lt;span class="na"&gt;character-set-server&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;utf8mb4&lt;/span&gt;
&lt;span class="c1"&gt;# time_zone の設定: https://dev.mysql.com/doc/refman/8.0/en/server-options.html#option_mysqld_default-time-zone&lt;/span&gt;
&lt;span class="na"&gt;default-time-zone&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;'Asia/Tokyo'&lt;/span&gt;

&lt;span class="na"&gt;[client]  # mysqlクライアントの設定&lt;/span&gt;
&lt;span class="c1"&gt;# クライアント側の文字コードの設定&lt;/span&gt;
&lt;span class="c1"&gt;# utf8mb4: A UTF-8 encoding of the Unicode character set using one to four bytes per character.&lt;/span&gt;
&lt;span class="na"&gt;default-character-set&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;utf8mb4&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;MySQL デフォルトの設定ファイルは &lt;code class="docutils literal"&gt;/etc/mysql/my.cnf&lt;/code&gt; の模様。 MySQL 公式イメージからコンテナを作成すると、初期状態で &lt;code class="docutils literal"&gt;/etc/mysql/my.cnf&lt;/code&gt; 中に&lt;/p&gt;
&lt;pre class="code cfg"&gt;&lt;a name="rest_code_6a520a00618f4485a2b6eb4c47c38fe8-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Custom config should go here&lt;/span&gt;
&lt;a name="rest_code_6a520a00618f4485a2b6eb4c47c38fe8-2"&gt;&lt;/a&gt;&lt;span class="na"&gt;!includedir /etc/mysql/conf.d/&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;と書いてあるので、言に従い自分用設定は &lt;code class="docutils literal"&gt;/etc/mysql/conf.d/&lt;/code&gt; に記述した。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id17"&gt;使い方メモ&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id18"&gt;イメージビルドからやり直したい&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;こんなときは...&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;requirements.txt にライブラリを書き足したとき&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Dockerfile を更新したとき&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_bdfa0dcff97c4246acaa8a0675001347-1"&gt;&lt;/a&gt;$ docker-compose build
&lt;a name="rest_code_bdfa0dcff97c4246acaa8a0675001347-2"&gt;&lt;/a&gt;$ docker-compose up
&lt;/pre&gt;&lt;p&gt;もしくは、&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_cc7efac6b8da4f079088cf3f8a2e9d43-1"&gt;&lt;/a&gt;$ docker-compose up --build
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="volume"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id19"&gt;volume は消さない限り再利用される&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code yaml"&gt;&lt;a name="rest_code_9dd67eab80b647f583bcb72ad4a8b2d0-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# fu/docker-compose.yml&lt;/span&gt;
&lt;a name="rest_code_9dd67eab80b647f583bcb72ad4a8b2d0-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_9dd67eab80b647f583bcb72ad4a8b2d0-3"&gt;&lt;/a&gt;&lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_9dd67eab80b647f583bcb72ad4a8b2d0-4"&gt;&lt;/a&gt;  &lt;span class="nt"&gt;db-data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="code bash"&gt;&lt;a name="rest_code_7ec2ef4b52eb41e4b721c5576a7f7ab3-1"&gt;&lt;/a&gt;$ docker volume ls
&lt;a name="rest_code_7ec2ef4b52eb41e4b721c5576a7f7ab3-2"&gt;&lt;/a&gt;DRIVER              VOLUME NAME
&lt;a name="rest_code_7ec2ef4b52eb41e4b721c5576a7f7ab3-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;local&lt;/span&gt;               fu_db-data  &lt;span class="c1"&gt;# こういう名前がついている&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="web"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id20"&gt;web のほうのコンテナだけ再起動したいとき&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_d8a534824cc64e6494d34b94bee94fdf-1"&gt;&lt;/a&gt;$ docker container restart fu_web
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id21"&gt;web のほうのコンテナに入る&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;VM の中に入るのと同じような気持ち。&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-1"&gt;&lt;/a&gt;$ docker container &lt;span class="nb"&gt;exec&lt;/span&gt; -it fu_web bash
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-2"&gt;&lt;/a&gt;root@eb1ab9a6dbdb:/code#
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-4"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 現在のロケール設定を確認する&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-5"&gt;&lt;/a&gt;root@eb1ab9a6dbdb:/code# locale
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-6"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LANG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;C.UTF-8
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-7"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LANGUAGE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-8"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_CTYPE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"C.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-9"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_NUMERIC&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"C.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-10"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_TIME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"C.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-11"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_COLLATE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"C.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-12"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_MONETARY&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"C.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-13"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_MESSAGES&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"C.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-14"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_PAPER&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"C.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-15"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_NAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"C.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-16"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_ADDRESS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"C.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-17"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_TELEPHONE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"C.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-18"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_MEASUREMENT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"C.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-19"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_IDENTIFICATION&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"C.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_4b1d334858f64a6c806a0ad72c130c2c-20"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_ALL&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="mysql"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id22"&gt;mysql のほうのコンテナに入る&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# mysql のコンテナに入る&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-2"&gt;&lt;/a&gt;$ docker container &lt;span class="nb"&gt;exec&lt;/span&gt; -it fu_db bash
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-4"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 現在のロケール設定を確認する&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-5"&gt;&lt;/a&gt;root@dcc8b4d2cd21:/# locale
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-6"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LANG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;ja_JP.UTF-8
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-7"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LANGUAGE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;ja_JP:en
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-8"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_CTYPE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ja_JP.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-9"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_NUMERIC&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ja_JP.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-10"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_TIME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ja_JP.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-11"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_COLLATE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ja_JP.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-12"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_MONETARY&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ja_JP.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-13"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_MESSAGES&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ja_JP.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-14"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_PAPER&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ja_JP.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-15"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_NAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ja_JP.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-16"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_ADDRESS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ja_JP.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-17"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_TELEPHONE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ja_JP.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-18"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_MEASUREMENT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ja_JP.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-19"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_IDENTIFICATION&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ja_JP.UTF-8"&lt;/span&gt;
&lt;a name="rest_code_d79622c0ff62439d98a9a9d5a96b6247-20"&gt;&lt;/a&gt;&lt;span class="nv"&gt;LC_ALL&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;ja_JP.UTF-8
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id23"&gt;mysql に入る&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# mysql のコンテナに入る&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-2"&gt;&lt;/a&gt;$ docker container &lt;span class="nb"&gt;exec&lt;/span&gt; -it fu_db bash
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-3"&gt;&lt;/a&gt;root@6ba1661872de:/#
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-5"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# mysql にログインする&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-6"&gt;&lt;/a&gt;$ mysql -h localhost -u fu -p fu
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-8"&gt;&lt;/a&gt;Enter password: &lt;span class="o"&gt;(&lt;/span&gt;compose ファイルに定義したパスワード&lt;span class="o"&gt;)&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-9"&gt;&lt;/a&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-10"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 現在の Character Sets 設定を表示する&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-11"&gt;&lt;/a&gt;mysql&amp;gt; SHOW VARIABLES LIKE &lt;span class="s2"&gt;"char%"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-12"&gt;&lt;/a&gt;+--------------------------+--------------------------------+
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-13"&gt;&lt;/a&gt;&lt;span class="p"&gt;|&lt;/span&gt; Variable_name            &lt;span class="p"&gt;|&lt;/span&gt; Value                          &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-14"&gt;&lt;/a&gt;+--------------------------+--------------------------------+
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-15"&gt;&lt;/a&gt;&lt;span class="p"&gt;|&lt;/span&gt; character_set_client     &lt;span class="p"&gt;|&lt;/span&gt; utf8mb4                        &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-16"&gt;&lt;/a&gt;&lt;span class="p"&gt;|&lt;/span&gt; character_set_connection &lt;span class="p"&gt;|&lt;/span&gt; utf8mb4                        &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-17"&gt;&lt;/a&gt;&lt;span class="p"&gt;|&lt;/span&gt; character_set_database   &lt;span class="p"&gt;|&lt;/span&gt; utf8mb4                        &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-18"&gt;&lt;/a&gt;&lt;span class="p"&gt;|&lt;/span&gt; character_set_filesystem &lt;span class="p"&gt;|&lt;/span&gt; binary                         &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-19"&gt;&lt;/a&gt;&lt;span class="p"&gt;|&lt;/span&gt; character_set_results    &lt;span class="p"&gt;|&lt;/span&gt; utf8mb4                        &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-20"&gt;&lt;/a&gt;&lt;span class="p"&gt;|&lt;/span&gt; character_set_server     &lt;span class="p"&gt;|&lt;/span&gt; utf8mb4                        &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-21"&gt;&lt;/a&gt;&lt;span class="p"&gt;|&lt;/span&gt; character_set_system     &lt;span class="p"&gt;|&lt;/span&gt; utf8                           &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-22"&gt;&lt;/a&gt;&lt;span class="p"&gt;|&lt;/span&gt; character_sets_dir       &lt;span class="p"&gt;|&lt;/span&gt; /usr/share/mysql-8.0/charsets/ &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-23"&gt;&lt;/a&gt;+--------------------------+--------------------------------+
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-24"&gt;&lt;/a&gt;&lt;span class="m"&gt;8&lt;/span&gt; rows in &lt;span class="nb"&gt;set&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.01 sec&lt;span class="o"&gt;)&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-25"&gt;&lt;/a&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-26"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 現在のタイムゾーン設定を表示する&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-27"&gt;&lt;/a&gt;mysql&amp;gt; SHOW VARIABLES LIKE &lt;span class="s1"&gt;'%time_zone%'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-28"&gt;&lt;/a&gt;+------------------+------------+
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-29"&gt;&lt;/a&gt;&lt;span class="p"&gt;|&lt;/span&gt; Variable_name    &lt;span class="p"&gt;|&lt;/span&gt; Value      &lt;span class="p"&gt;|&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-30"&gt;&lt;/a&gt;+------------------+------------+
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-31"&gt;&lt;/a&gt;&lt;span class="p"&gt;|&lt;/span&gt; system_time_zone &lt;span class="p"&gt;|&lt;/span&gt; JST        &lt;span class="p"&gt;|&lt;/span&gt;  &lt;span class="c1"&gt;# MySQL が動いているコンテナ (Debian) のシステムタイムゾーン、Dockerfile-mysql で設定した&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-32"&gt;&lt;/a&gt;&lt;span class="p"&gt;|&lt;/span&gt; time_zone        &lt;span class="p"&gt;|&lt;/span&gt; Asia/Tokyo &lt;span class="p"&gt;|&lt;/span&gt;  &lt;span class="c1"&gt;# mysql.cnf で設定した MySQL サーバー側のタイムゾーン&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-33"&gt;&lt;/a&gt;+------------------+------------+
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-34"&gt;&lt;/a&gt;&lt;span class="m"&gt;2&lt;/span&gt; rows in &lt;span class="nb"&gt;set&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.01 sec&lt;span class="o"&gt;)&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-35"&gt;&lt;/a&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-36"&gt;&lt;/a&gt;mysql&amp;gt; status
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-37"&gt;&lt;/a&gt;--------------
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-38"&gt;&lt;/a&gt;mysql  Ver &lt;span class="m"&gt;8&lt;/span&gt;.0.13 &lt;span class="k"&gt;for&lt;/span&gt; Linux on x86_64 &lt;span class="o"&gt;(&lt;/span&gt;MySQL Community Server - GPL&lt;span class="o"&gt;)&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-39"&gt;&lt;/a&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-40"&gt;&lt;/a&gt;Connection id:                &lt;span class="m"&gt;11&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-41"&gt;&lt;/a&gt;Current database:     fu
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-42"&gt;&lt;/a&gt;Current user:         fu@localhost
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-43"&gt;&lt;/a&gt;SSL:                  Not in use
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-44"&gt;&lt;/a&gt;Current pager:                stdout
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-45"&gt;&lt;/a&gt;Using outfile:                &lt;span class="s1"&gt;''&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-46"&gt;&lt;/a&gt;Using delimiter:      &lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-47"&gt;&lt;/a&gt;Server version:               &lt;span class="m"&gt;8&lt;/span&gt;.0.13 MySQL Community Server - GPL
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-48"&gt;&lt;/a&gt;Protocol version:     &lt;span class="m"&gt;10&lt;/span&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-49"&gt;&lt;/a&gt;Connection:           Localhost via UNIX socket
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-50"&gt;&lt;/a&gt;Server characterset:  utf8mb4
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-51"&gt;&lt;/a&gt;Db     characterset:  utf8mb4
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-52"&gt;&lt;/a&gt;Client characterset:  utf8mb4
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-53"&gt;&lt;/a&gt;Conn.  characterset:  utf8mb4
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-54"&gt;&lt;/a&gt;UNIX socket:          /var/run/mysqld/mysqld.sock
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-55"&gt;&lt;/a&gt;Uptime:                       &lt;span class="m"&gt;2&lt;/span&gt; hours &lt;span class="m"&gt;9&lt;/span&gt; min &lt;span class="m"&gt;49&lt;/span&gt; sec
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-56"&gt;&lt;/a&gt;
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-57"&gt;&lt;/a&gt;Threads: &lt;span class="m"&gt;3&lt;/span&gt;  Questions: &lt;span class="m"&gt;40&lt;/span&gt;  Slow queries: &lt;span class="m"&gt;0&lt;/span&gt;  Opens: &lt;span class="m"&gt;189&lt;/span&gt;  Flush tables: &lt;span class="m"&gt;2&lt;/span&gt;  Open tables: &lt;span class="m"&gt;163&lt;/span&gt;  Queries per second avg: &lt;span class="m"&gt;0&lt;/span&gt;.005
&lt;a name="rest_code_d4e136f9d5284255b9cc0c75bdba08f2-58"&gt;&lt;/a&gt;--------------
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="todo"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/#id24"&gt;TODO&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;web コンテナのほうの locale と タイムゾーンは db コンテナと合わせなくて大丈夫なんだろうか...&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>docker</category><guid>https://32imuf.com/docker/create-django-env-with-docker-compose-mysql/</guid><pubDate>Fri, 04 Jan 2019 15:00:00 GMT</pubDate></item><item><title>Docker Compose で Volumes をつかう</title><link>https://32imuf.com/docker/use-volumes-with-docker-compose/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#id1" id="id3"&gt;リファレンス&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#id2" id="id4"&gt;手順&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#volume" id="id5"&gt;1. volume を作成する&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#docker-compose-yml-volume" id="id6"&gt;2. &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;docker-compose.yml&lt;/span&gt;&lt;/code&gt; に作成した volume を指定する&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#settings-py-database" id="id7"&gt;3. &lt;code class="docutils literal"&gt;settings.py&lt;/code&gt; に DATABASE を定義する&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#docker" id="id8"&gt;4. Docker コンテナを実行する&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#db" id="id9"&gt;5. DB コンテナのなかに入って、テーブルを作成 &amp;amp; データを挿入する&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#shutdown" id="id10"&gt;6. 安全に shutdown する&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#docker-compose-up" id="id11"&gt;7. 再度 &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;docker-compose&lt;/span&gt; up&lt;/code&gt; して、先ほど登録したテーブル &amp;amp; データを見てみる&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#id3"&gt;リファレンス&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/storage/volumes/"&gt;Use volumes&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/storage/volumes/#create-and-manage-volumes"&gt;Create and manage volumes&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/compose/compose-file/#external"&gt;https://docs.docker.com/compose/compose-file/#external&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/compose/compose-file/#environment"&gt;https://docs.docker.com/compose/compose-file/#environment&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="http://www.postgresqltutorial.com/psql-commands/"&gt;http://www.postgresqltutorial.com/psql-commands/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#id4"&gt;手順&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;web&lt;/code&gt; のイメージをビルド...するところは、
&lt;a class="reference external" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql"&gt;Docker Compose で Django/PostgreSQL 環境をつくる&lt;/a&gt;
を参照のこと。&lt;/p&gt;
&lt;div class="section" id="volume"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#id5"&gt;1. volume を作成する&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;db-data&lt;/span&gt;&lt;/code&gt; という名前の volume を作成する。&lt;/p&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_b5e44fb3c1414a3fbb2149b27a195cd1-1"&gt;&lt;/a&gt;$ docker volume create db-data
&lt;a name="rest_code_b5e44fb3c1414a3fbb2149b27a195cd1-2"&gt;&lt;/a&gt;db-data
&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;volumes を一覧表示する。&lt;/p&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_313f13256dc84dbe8f80ddfaacbc0bcd-1"&gt;&lt;/a&gt;$ docker volume ls
&lt;a name="rest_code_313f13256dc84dbe8f80ddfaacbc0bcd-2"&gt;&lt;/a&gt;DRIVER              VOLUME NAME
&lt;a name="rest_code_313f13256dc84dbe8f80ddfaacbc0bcd-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;local&lt;/span&gt;               db-data
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;volume を調べる。&lt;/p&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_938ec61988e147dab3fcea2165ac74e9-1"&gt;&lt;/a&gt;$ docker volume inspect db-data
&lt;a name="rest_code_938ec61988e147dab3fcea2165ac74e9-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;[&lt;/span&gt;
&lt;a name="rest_code_938ec61988e147dab3fcea2165ac74e9-3"&gt;&lt;/a&gt;    &lt;span class="o"&gt;{&lt;/span&gt;
&lt;a name="rest_code_938ec61988e147dab3fcea2165ac74e9-4"&gt;&lt;/a&gt;        &lt;span class="s2"&gt;"CreatedAt"&lt;/span&gt;: &lt;span class="s2"&gt;"2018-12-02T13:09:48Z"&lt;/span&gt;,
&lt;a name="rest_code_938ec61988e147dab3fcea2165ac74e9-5"&gt;&lt;/a&gt;        &lt;span class="s2"&gt;"Driver"&lt;/span&gt;: &lt;span class="s2"&gt;"local"&lt;/span&gt;,
&lt;a name="rest_code_938ec61988e147dab3fcea2165ac74e9-6"&gt;&lt;/a&gt;        &lt;span class="s2"&gt;"Labels"&lt;/span&gt;: &lt;span class="o"&gt;{}&lt;/span&gt;,
&lt;a name="rest_code_938ec61988e147dab3fcea2165ac74e9-7"&gt;&lt;/a&gt;        &lt;span class="s2"&gt;"Mountpoint"&lt;/span&gt;: &lt;span class="s2"&gt;"/var/lib/docker/volumes/db-data/_data"&lt;/span&gt;,
&lt;a name="rest_code_938ec61988e147dab3fcea2165ac74e9-8"&gt;&lt;/a&gt;        &lt;span class="s2"&gt;"Name"&lt;/span&gt;: &lt;span class="s2"&gt;"db-data"&lt;/span&gt;,
&lt;a name="rest_code_938ec61988e147dab3fcea2165ac74e9-9"&gt;&lt;/a&gt;        &lt;span class="s2"&gt;"Options"&lt;/span&gt;: &lt;span class="o"&gt;{}&lt;/span&gt;,
&lt;a name="rest_code_938ec61988e147dab3fcea2165ac74e9-10"&gt;&lt;/a&gt;        &lt;span class="s2"&gt;"Scope"&lt;/span&gt;: &lt;span class="s2"&gt;"local"&lt;/span&gt;
&lt;a name="rest_code_938ec61988e147dab3fcea2165ac74e9-11"&gt;&lt;/a&gt;    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;a name="rest_code_938ec61988e147dab3fcea2165ac74e9-12"&gt;&lt;/a&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;今作った &lt;code class="docutils literal"&gt;volume&lt;/code&gt; はこの絵↓の真ん中のものである。&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="figure"&gt;
&lt;img alt="/images/docker/use-volumes-with-docker-compose/use-volumes.png" src="https://32imuf.com/images/docker/use-volumes-with-docker-compose/use-volumes.png"&gt;
&lt;/div&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/storage/volumes/"&gt;https://docs.docker.com/storage/volumes/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="docker-compose-yml-volume"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#id6"&gt;2. &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;docker-compose.yml&lt;/span&gt;&lt;/code&gt; に作成した volume を指定する&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;docker-compose.yml&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;version&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;'3'&lt;/span&gt;

&lt;span class="nt"&gt;services&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;db&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;postgres:latest&lt;/span&gt;
    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="c1"&gt;# コンテナの `/var/lib/postgresql/data` を、volume `db-data` にマウントする。&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"db-data:/var/lib/postgresql/data"&lt;/span&gt;
    &lt;span class="c1"&gt;# 環境変数を追加する&lt;/span&gt;
    &lt;span class="nt"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="c1"&gt;# postgres のパスワードを設定する&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;POSTGRES_PASSWORD=postgres&lt;/span&gt;
  &lt;span class="nt"&gt;web&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;build&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="nt"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.&lt;/span&gt;
      &lt;span class="nt"&gt;dockerfile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Dockerfile-web&lt;/span&gt;
    &lt;span class="nt"&gt;command&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;python3 manage.py runserver 0.0.0.0:8000&lt;/span&gt;
    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.:/code&lt;/span&gt;
    &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"3236:8000"&lt;/span&gt;
    &lt;span class="nt"&gt;depends_on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;db&lt;/span&gt;

&lt;span class="c1"&gt;# volumes を定義する&lt;/span&gt;
&lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="c1"&gt;# volume の名前を指定&lt;/span&gt;
  &lt;span class="nt"&gt;db-data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# Compose の外ですでに作成済みの volume を指定する場合は ture を設定する。&lt;/span&gt;
    &lt;span class="c1"&gt;# そうすると、 docker-compose up 時に Compose は volume を作成しようとしません。&lt;/span&gt;
    &lt;span class="c1"&gt;# かつ、指定した volume が存在しないとエラーを raise します。&lt;/span&gt;
    &lt;span class="nt"&gt;external&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;external: true&lt;/code&gt; を書かないと、 &lt;code class="docutils literal"&gt;$ &lt;span class="pre"&gt;docker-compose&lt;/span&gt; up&lt;/code&gt; 時に 1. で作った &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;db-data&lt;/span&gt;&lt;/code&gt; とは別に
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;{プロジェクト名}_db-data&lt;/span&gt;&lt;/code&gt; という感じの名前の volume が作られて、そちらが使われる。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;それでもまあかまわないけれど。今のところは。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="settings-py-database"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#id7"&gt;3. &lt;code class="docutils literal"&gt;settings.py&lt;/code&gt; に DATABASE を定義する&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_50014119e38b4fccaa7bacc6b37ee2e1-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;DATABASES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_50014119e38b4fccaa7bacc6b37ee2e1-2"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'default'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_50014119e38b4fccaa7bacc6b37ee2e1-3"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'ENGINE'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'django.db.backends.postgresql'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_50014119e38b4fccaa7bacc6b37ee2e1-4"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'NAME'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'postgres'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_50014119e38b4fccaa7bacc6b37ee2e1-5"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'USER'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'postgres'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_50014119e38b4fccaa7bacc6b37ee2e1-6"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'PASSWORD'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'postgres'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# パスワードを追加した&lt;/span&gt;
&lt;a name="rest_code_50014119e38b4fccaa7bacc6b37ee2e1-7"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'HOST'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'db'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_50014119e38b4fccaa7bacc6b37ee2e1-8"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'PORT'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;5432&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_50014119e38b4fccaa7bacc6b37ee2e1-9"&gt;&lt;/a&gt;    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_50014119e38b4fccaa7bacc6b37ee2e1-10"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="docker"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#id8"&gt;4. Docker コンテナを実行する&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_89dbc759155c4f17a8045f1602ed0f50-1"&gt;&lt;/a&gt;$ docker-compose up
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="db"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#id9"&gt;5. DB コンテナのなかに入って、テーブルを作成 &amp;amp; データを挿入する&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;1). &lt;code class="docutils literal"&gt;db&lt;/code&gt; コンテナのなかに入る&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_8d51fe22195f48ea8d2ab0b9ef2a5ac1-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# コンテナをシェル経由で操作する&lt;/span&gt;
&lt;a name="rest_code_8d51fe22195f48ea8d2ab0b9ef2a5ac1-2"&gt;&lt;/a&gt;$ docker container &lt;span class="nb"&gt;exec&lt;/span&gt; -it fffff_db_1 sh
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;p&gt;2). postgres に接続する&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code postgres"&gt;&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;-- postgres に接続するその１&lt;/span&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;#&lt;/span&gt; &lt;span class="n"&gt;psql&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;U&lt;/span&gt; &lt;span class="n"&gt;postgres&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt; &lt;span class="mf"&gt;127.0.0.1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="mf"&gt;5432&lt;/span&gt; &lt;span class="n"&gt;postgres&lt;/span&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;psql&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;11.1&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Debian&lt;/span&gt; &lt;span class="mf"&gt;11.1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.&lt;/span&gt;&lt;span class="n"&gt;pgdg90&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;Type&lt;/span&gt; &lt;span class="s s-Name"&gt;"help"&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="mf"&gt;.&lt;/span&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;postgres&lt;/span&gt;&lt;span class="o"&gt;=#&lt;/span&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-8"&gt;&lt;/a&gt;&lt;span class="c1"&gt;-- postgres に接続するその２&lt;/span&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-9"&gt;&lt;/a&gt;&lt;span class="o"&gt;#&lt;/span&gt; &lt;span class="n"&gt;psql&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="n"&gt;postgres&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;U&lt;/span&gt;  &lt;span class="n"&gt;postgres&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;W&lt;/span&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-10"&gt;&lt;/a&gt;&lt;span class="k"&gt;Password&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;psql&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;11.1&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Debian&lt;/span&gt; &lt;span class="mf"&gt;11.1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.&lt;/span&gt;&lt;span class="n"&gt;pgdg90&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-12"&gt;&lt;/a&gt;&lt;span class="k"&gt;Type&lt;/span&gt; &lt;span class="s s-Name"&gt;"help"&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="mf"&gt;.&lt;/span&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_1550e41f17254cbeba769f9ed5594db4-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;postgres&lt;/span&gt;&lt;span class="o"&gt;=#&lt;/span&gt;
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;p&gt;3). テーブルを作成し、データを挿入する&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code postgres"&gt;&lt;a name="rest_code_e9ca4434817d4e17ae79b18bab8df696-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;fruits&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_e9ca4434817d4e17ae79b18bab8df696-2"&gt;&lt;/a&gt;   &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="nb"&gt;SERIAL&lt;/span&gt; &lt;span class="k"&gt;PRIMARY&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_e9ca4434817d4e17ae79b18bab8df696-3"&gt;&lt;/a&gt;   &lt;span class="k"&gt;name&lt;/span&gt; &lt;span class="nb"&gt;VARCHAR&lt;/span&gt; &lt;span class="k"&gt;NOT&lt;/span&gt; &lt;span class="k"&gt;NULL&lt;/span&gt;
&lt;a name="rest_code_e9ca4434817d4e17ae79b18bab8df696-4"&gt;&lt;/a&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_e9ca4434817d4e17ae79b18bab8df696-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;INSERT&lt;/span&gt; &lt;span class="k"&gt;INTO&lt;/span&gt; &lt;span class="n"&gt;fruits&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;VALUES&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'orange'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_e9ca4434817d4e17ae79b18bab8df696-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;INSERT&lt;/span&gt; &lt;span class="k"&gt;INTO&lt;/span&gt; &lt;span class="n"&gt;fruits&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="k"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;VALUES&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;DEFAULT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'apple'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_e9ca4434817d4e17ae79b18bab8df696-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_e9ca4434817d4e17ae79b18bab8df696-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;postgres&lt;/span&gt;&lt;span class="o"&gt;=#&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class="section" id="shutdown"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#id10"&gt;6. 安全に shutdown する&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;コンテナは停止・削除される。&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_c29950afd6764f80a73ea1ea61958a88-1"&gt;&lt;/a&gt;$ docker-compose down
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="docker-compose-up"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/use-volumes-with-docker-compose/#id11"&gt;7. 再度 &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;docker-compose&lt;/span&gt; up&lt;/code&gt; して、先ほど登録したテーブル &amp;amp; データを見てみる&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;先ほど作成したテーブルとデータがありました。&lt;/p&gt;
&lt;pre class="code console"&gt;&lt;a name="rest_code_5fe183589beb44afbd76b98c84fb0c9c-1"&gt;&lt;/a&gt;&lt;span class="gp"&gt;$&lt;/span&gt; docker-compose up
&lt;a name="rest_code_5fe183589beb44afbd76b98c84fb0c9c-2"&gt;&lt;/a&gt;&lt;span class="gp"&gt;$&lt;/span&gt; docker container &lt;span class="nb"&gt;exec&lt;/span&gt; -it fffff_db_1 sh
&lt;/pre&gt;&lt;pre class="code postgres"&gt;&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;#&lt;/span&gt; &lt;span class="n"&gt;psql&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;U&lt;/span&gt; &lt;span class="n"&gt;postgres&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt; &lt;span class="mf"&gt;127.0.0.1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="mf"&gt;5432&lt;/span&gt; &lt;span class="n"&gt;postgres&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;psql&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;11.1&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Debian&lt;/span&gt; &lt;span class="mf"&gt;11.1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.&lt;/span&gt;&lt;span class="n"&gt;pgdg90&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;Type&lt;/span&gt; &lt;span class="s s-Name"&gt;"help"&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="mf"&gt;.&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;postgres&lt;/span&gt;&lt;span class="o"&gt;=#&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-6"&gt;&lt;/a&gt;         &lt;span class="n"&gt;List&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="n"&gt;relations&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-7"&gt;&lt;/a&gt; &lt;span class="k"&gt;Schema&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="k"&gt;Name&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="k"&gt;Type&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="k"&gt;Owner&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-8"&gt;&lt;/a&gt;&lt;span class="c1"&gt;--------+--------+-------+----------&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-9"&gt;&lt;/a&gt; &lt;span class="n"&gt;public&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;fruits&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="k"&gt;table&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;postgres&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-10"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt; &lt;span class="k"&gt;row&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;postgres&lt;/span&gt;&lt;span class="o"&gt;=#&lt;/span&gt; &lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;fruits&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-13"&gt;&lt;/a&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="k"&gt;name&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-14"&gt;&lt;/a&gt;&lt;span class="c1"&gt;----+--------&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-15"&gt;&lt;/a&gt;  &lt;span class="mf"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;orange&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-16"&gt;&lt;/a&gt;  &lt;span class="mf"&gt;2&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;apple&lt;/span&gt;
&lt;a name="rest_code_71c1734003334f8e98dcc7275b5773eb-17"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2&lt;/span&gt; &lt;span class="k"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>docker</category><guid>https://32imuf.com/docker/use-volumes-with-docker-compose/</guid><pubDate>Sat, 01 Dec 2018 15:00:00 GMT</pubDate></item><item><title>Docker Compose で Django/PostgreSQL 環境をつくる</title><link>https://32imuf.com/docker/create-django-env-with-docker-compose-psql/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql/#id1" id="id5"&gt;ガイド&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql/#id2" id="id6"&gt;リファレンス&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql/#id3" id="id7"&gt;インストール&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql/#id4" id="id8"&gt;つくりかた&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql/#id5"&gt;ガイド&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/compose/django/"&gt;Quickstart: Compose and Django&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql/#id6"&gt;リファレンス&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/engine/reference/builder/"&gt;Dockerfile reference&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/compose/compose-file/"&gt;Compose file version 3 reference&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/compose/reference/run/"&gt;https://docs.docker.com/compose/reference/run/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql/#id7"&gt;インストール&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.docker.com/docker-for-mac/install/"&gt;Install Docker Desktop for Mac&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/docker/create-django-env-with-docker-compose-psql/#id8"&gt;つくりかた&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;Dockerfile&lt;/code&gt; を準備する。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;Dockerfile&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;# ベースイメージ&lt;/span&gt;
&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="s"&gt; python:3&lt;/span&gt;
&lt;span class="c"&gt;# Docker コンテナ内で使える環境変数を指定&lt;/span&gt;
&lt;span class="k"&gt;ENV&lt;/span&gt; PYTHONUNBUFFERED &lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="c"&gt;# イメージビルド時に mkdir /code する&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; mkdir /code
&lt;span class="c"&gt;# この後の指令は /code で実行する&lt;/span&gt;
&lt;span class="k"&gt;WORKDIR&lt;/span&gt;&lt;span class="s"&gt; /code&lt;/span&gt;
&lt;span class="c"&gt;# requirements.txt をイメージ内の /code/ ディレクトリにコピーする&lt;/span&gt;
&lt;span class="k"&gt;ADD&lt;/span&gt; requirements.txt /code/
&lt;span class="c"&gt;# イメージビルド時に requirements.txt から pip install する&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt; pip install -r requirements.txt
&lt;span class="c"&gt;# カレントディレクトリ配下を /code 配下にコピーする&lt;/span&gt;
&lt;span class="k"&gt;ADD&lt;/span&gt; . /code/
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;requirements.txt&lt;/code&gt; を準備する。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;requirements.txt&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Django&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;
&lt;span class="n"&gt;psycopg2&lt;/span&gt;
&lt;span class="c1"&gt;# psycopg2: Python-PostgreSQL Database Adapter https://pypi.org/project/psycopg2/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;docker-compose.yml&lt;/span&gt;&lt;/code&gt; を準備する。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="code-block-label"&gt;docker-compose.yml&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;version&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;'3'&lt;/span&gt;

&lt;span class="nt"&gt;services&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;db&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;postgres&lt;/span&gt;
  &lt;span class="nt"&gt;web&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# Dockerfile が存在するディレクトリの相対パスを指定する&lt;/span&gt;
    &lt;span class="nt"&gt;build&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.&lt;/span&gt;
    &lt;span class="c1"&gt;# コンテナ実行時に実行するコマンド&lt;/span&gt;
    &lt;span class="nt"&gt;command&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;python3 manage.py runserver 0.0.0.0:8000&lt;/span&gt;
    &lt;span class="c1"&gt;# コンテナの /code を、ホストのカレントディレクトリにマウントする&lt;/span&gt;
    &lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;.:/code&lt;/span&gt;
    &lt;span class="c1"&gt;# ポートフォワーディング&lt;/span&gt;
    &lt;span class="nt"&gt;ports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="c1"&gt;# ホストのポート:コンテナのポート&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="s"&gt;"3236:8000"&lt;/span&gt;
    &lt;span class="c1"&gt;# 依存するものをここに書く。docker-compose up 時に、 web の前に db をスタートしてくれる。&lt;/span&gt;
    &lt;span class="nt"&gt;depends_on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;db&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;startproject する (Docker イメージビルドもされる)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# docker-compose.yml に指定したとおり、カレントディレクトリの Dockerfile から `web` のイメージをビルド&lt;/span&gt;
&lt;span class="c1"&gt;# `web` の中で django-admin.py startproject fff を実行する&lt;/span&gt;
$ sudo docker-compose run web django-admin.py startproject fff .
&lt;span class="c1"&gt;# mac のパスワードを入力する&lt;/span&gt;
Password:
Creating network &lt;span class="s2"&gt;"fff_default"&lt;/span&gt; with the default driver
Pulling db &lt;span class="o"&gt;(&lt;/span&gt;postgres:&lt;span class="o"&gt;)&lt;/span&gt;...
latest: Pulling from library/postgres
a5a6f2f73cd8: Already exists
e50fbea8af5a: Pulling fs layer
73b4855ad326: Pulling fs layer
39616673f22b: Pulling fs layer
94e1b79f69ee: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
c91e4af2ff8e: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
16ba314c612f: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
89011a174cee: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
d82b02de73e7: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
e3026dc5acbe: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
225d0988f8bb: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
89efa60266d6: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
64e6167259ce: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
8f44f8f48bbe: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
Digest: sha256:40b48cf04185e69c5a9183a986fcbbfd105e5991a70b1980e9a641b53ba5ead7
Status: Downloaded newer image &lt;span class="k"&gt;for&lt;/span&gt; postgres:latest
Creating fff_db_1 ... &lt;span class="k"&gt;done&lt;/span&gt;
Building web
Step &lt;span class="m"&gt;1&lt;/span&gt;/7 : FROM python:3
&lt;span class="m"&gt;3&lt;/span&gt;: Pulling from library/python
54f7e8ac135a: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
d6341e30912f: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
087a57faf949: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
5d71636fb824: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
0c1db9598990: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
bfb904e99f24: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
78a3d3a96a32: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
885a0ed92c89: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
dd7cc9ace242: Pull &lt;span class="nb"&gt;complete&lt;/span&gt;
Digest: sha256:3870d35b962a943df72d948580fc66ceaaee1c4fbd205930f32e0f0760eb1077
Status: Downloaded newer image &lt;span class="k"&gt;for&lt;/span&gt; python:3
 ---&amp;gt; 1e80caffd59e
Step &lt;span class="m"&gt;2&lt;/span&gt;/7 : ENV PYTHONUNBUFFERED &lt;span class="m"&gt;1&lt;/span&gt;
 ---&amp;gt; Running in 8b36b0f52978
Removing intermediate container 8b36b0f52978
 ---&amp;gt; d8c31fcb6021
Step &lt;span class="m"&gt;3&lt;/span&gt;/7 : RUN mkdir /code
 ---&amp;gt; Running in 4f2b5e392870
Removing intermediate container 4f2b5e392870
 ---&amp;gt; 9c8ee756f336
Step &lt;span class="m"&gt;4&lt;/span&gt;/7 : WORKDIR /code
 ---&amp;gt; Running in de4383433c19
Removing intermediate container de4383433c19
 ---&amp;gt; 3641af229774
Step &lt;span class="m"&gt;5&lt;/span&gt;/7 : ADD requirements.txt /code/
 ---&amp;gt; ef8667808ce1
Step &lt;span class="m"&gt;6&lt;/span&gt;/7 : RUN pip install -r requirements.txt
 ---&amp;gt; Running in 1da62dd84073
Collecting Django&amp;lt;&lt;span class="m"&gt;2&lt;/span&gt;.1,&amp;gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.8 &lt;span class="o"&gt;(&lt;/span&gt;from -r requirements.txt &lt;span class="o"&gt;(&lt;/span&gt;line &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
  Downloading https://files.pythonhosted.org/packages/6c/9d/c0feec696b815708354a2fd06ae0f51330a15043822a29bc8be2f185d9fe/Django-2.0.9-py3-none-any.whl &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;7&lt;/span&gt;.1MB&lt;span class="o"&gt;)&lt;/span&gt;
Collecting psycopg2 &lt;span class="o"&gt;(&lt;/span&gt;from -r requirements.txt &lt;span class="o"&gt;(&lt;/span&gt;line &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
  Downloading https://files.pythonhosted.org/packages/90/aa/b033c170c9bd505c7e4d1560f5dbb35ca2a7e928ac03c384f93d0cdaf6a7/psycopg2-2.7.6.1-cp37-cp37m-manylinux1_x86_64.whl &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.7MB&lt;span class="o"&gt;)&lt;/span&gt;
Collecting pytz &lt;span class="o"&gt;(&lt;/span&gt;from Django&amp;lt;&lt;span class="m"&gt;2&lt;/span&gt;.1,&amp;gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.8-&amp;gt;-r requirements.txt &lt;span class="o"&gt;(&lt;/span&gt;line &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
  Downloading https://files.pythonhosted.org/packages/f8/0e/2365ddc010afb3d79147f1dd544e5ee24bf4ece58ab99b16fbb465ce6dc0/pytz-2018.7-py2.py3-none-any.whl &lt;span class="o"&gt;(&lt;/span&gt;506kB&lt;span class="o"&gt;)&lt;/span&gt;
Installing collected packages: pytz, Django, psycopg2
Successfully installed Django-2.0.9 psycopg2-2.7.6.1 pytz-2018.7
Removing intermediate container 1da62dd84073
 ---&amp;gt; d0afed5e3cf7
Step &lt;span class="m"&gt;7&lt;/span&gt;/7 : ADD . /code/
 ---&amp;gt; 5a39d311c84c
Successfully built 5a39d311c84c
Successfully tagged fff_web:latest
WARNING: Image &lt;span class="k"&gt;for&lt;/span&gt; service web was built because it did not already exist. To rebuild this image you must use &lt;span class="sb"&gt;`&lt;/span&gt;docker-compose build&lt;span class="sb"&gt;`&lt;/span&gt; or &lt;span class="sb"&gt;`&lt;/span&gt;docker-compose up --build&lt;span class="sb"&gt;`&lt;/span&gt;.
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;settings.py&lt;/code&gt; に DATABASE を定義する。&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_ba0669a6427844ab96100133bace4bdb-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;DATABASES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_ba0669a6427844ab96100133bace4bdb-2"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'default'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_ba0669a6427844ab96100133bace4bdb-3"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'ENGINE'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'django.db.backends.postgresql'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_ba0669a6427844ab96100133bace4bdb-4"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'NAME'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'postgres'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_ba0669a6427844ab96100133bace4bdb-5"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'USER'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'postgres'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_ba0669a6427844ab96100133bace4bdb-6"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'HOST'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'db'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_ba0669a6427844ab96100133bace4bdb-7"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'PORT'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;5432&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_ba0669a6427844ab96100133bace4bdb-8"&gt;&lt;/a&gt;    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_ba0669a6427844ab96100133bace4bdb-9"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Docker コンテナ (db と web) を実行する&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="code-block "&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ docker-compose up
fff_db_1 is up-to-date
Creating fff_web_1 ... &lt;span class="k"&gt;done&lt;/span&gt;
Attaching to fff_db_1, fff_web_1
db_1   &lt;span class="p"&gt;|&lt;/span&gt; The files belonging to this database system will be owned by user &lt;span class="s2"&gt;"postgres"&lt;/span&gt;.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; This user must also own the server process.
db_1   &lt;span class="p"&gt;|&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; The database cluster will be initialized with locale &lt;span class="s2"&gt;"en_US.utf8"&lt;/span&gt;.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; The default database encoding has accordingly been &lt;span class="nb"&gt;set&lt;/span&gt; to &lt;span class="s2"&gt;"UTF8"&lt;/span&gt;.
db_1   &lt;span class="p"&gt;|&lt;/span&gt; The default text search configuration will be &lt;span class="nb"&gt;set&lt;/span&gt; to &lt;span class="s2"&gt;"english"&lt;/span&gt;.
db_1   &lt;span class="p"&gt;|&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; Data page checksums are disabled.
db_1   &lt;span class="p"&gt;|&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; fixing permissions on existing directory /var/lib/postgresql/data ... ok
db_1   &lt;span class="p"&gt;|&lt;/span&gt; creating subdirectories ... ok
db_1   &lt;span class="p"&gt;|&lt;/span&gt; selecting default max_connections ... &lt;span class="m"&gt;100&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; selecting default shared_buffers ... 128MB
db_1   &lt;span class="p"&gt;|&lt;/span&gt; selecting dynamic shared memory implementation ... posix
db_1   &lt;span class="p"&gt;|&lt;/span&gt; creating configuration files ... ok
db_1   &lt;span class="p"&gt;|&lt;/span&gt; running bootstrap script ... ok
db_1   &lt;span class="p"&gt;|&lt;/span&gt; performing post-bootstrap initialization ... ok
db_1   &lt;span class="p"&gt;|&lt;/span&gt; syncing data to disk ... ok
db_1   &lt;span class="p"&gt;|&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; Success. You can now start the database server using:
db_1   &lt;span class="p"&gt;|&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; WARNING: enabling &lt;span class="s2"&gt;"trust"&lt;/span&gt; authentication &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;local&lt;/span&gt; connections
db_1   &lt;span class="p"&gt;|&lt;/span&gt; You can change this by editing pg_hba.conf or using the option -A, or
db_1   &lt;span class="p"&gt;|&lt;/span&gt; --auth-local and --auth-host, the next &lt;span class="nb"&gt;time&lt;/span&gt; you run initdb.
db_1   &lt;span class="p"&gt;|&lt;/span&gt;     pg_ctl -D /var/lib/postgresql/data -l logfile start
db_1   &lt;span class="p"&gt;|&lt;/span&gt;
db_1   &lt;span class="p"&gt;|&lt;/span&gt; ****************************************************
db_1   &lt;span class="p"&gt;|&lt;/span&gt; WARNING: No password has been &lt;span class="nb"&gt;set&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; the database.
db_1   &lt;span class="p"&gt;|&lt;/span&gt;          This will allow anyone with access to the
db_1   &lt;span class="p"&gt;|&lt;/span&gt;          Postgres port to access your database. In
db_1   &lt;span class="p"&gt;|&lt;/span&gt;          Docker&lt;span class="s1"&gt;'s default configuration, this is&lt;/span&gt;
&lt;span class="s1"&gt;db_1   |          effectively any other container on the same&lt;/span&gt;
&lt;span class="s1"&gt;db_1   |          system.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   |&lt;/span&gt;
&lt;span class="s1"&gt;db_1   |          Use "-e POSTGRES_PASSWORD=password" to set&lt;/span&gt;
&lt;span class="s1"&gt;db_1   |          it in "docker run".&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | ****************************************************&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | waiting for server to start....2018-11-26 14:35:32.757 UTC [45] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2018-11-26 14:35:32.772 UTC [46] LOG:  database system was shut down at 2018-11-26 14:35:32 UTC&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2018-11-26 14:35:32.777 UTC [45] LOG:  database system is ready to accept connections&lt;/span&gt;
&lt;span class="s1"&gt;db_1   |  done&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | server started&lt;/span&gt;
&lt;span class="s1"&gt;db_1   |&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | /usr/local/bin/docker-entrypoint.sh: ignoring /docker-entrypoint-initdb.d/*&lt;/span&gt;
&lt;span class="s1"&gt;db_1   |&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | waiting for server to shut down....2018-11-26 14:35:32.851 UTC [45] LOG:  received fast shutdown request&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2018-11-26 14:35:32.855 UTC [45] LOG:  aborting any active transactions&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2018-11-26 14:35:32.858 UTC [45] LOG:  background worker "logical replication launcher" (PID 52) exited with exit code 1&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2018-11-26 14:35:32.860 UTC [47] LOG:  shutting down&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2018-11-26 14:35:32.882 UTC [45] LOG:  database system is shut down&lt;/span&gt;
&lt;span class="s1"&gt;db_1   |  done&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | server stopped&lt;/span&gt;
&lt;span class="s1"&gt;db_1   |&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | PostgreSQL init process complete; ready for start up.&lt;/span&gt;
&lt;span class="s1"&gt;db_1   |&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2018-11-26 14:35:32.970 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2018-11-26 14:35:32.972 UTC [1] LOG:  listening on IPv6 address "::", port 5432&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2018-11-26 14:35:32.977 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2018-11-26 14:35:32.994 UTC [54] LOG:  database system was shut down at 2018-11-26 14:35:32 UTC&lt;/span&gt;
&lt;span class="s1"&gt;db_1   | 2018-11-26 14:35:33.002 UTC [1] LOG:  database system is ready to accept connections&lt;/span&gt;
&lt;span class="s1"&gt;web_1  | /usr/local/lib/python3.7/site-packages/psycopg2/__init__.py:144: UserWarning: The psycopg2 wheel package will be renamed from release 2.8; in order to keep installing from binary please use "pip install psycopg2-binary" instead. For details see: &amp;lt;http://initd.org/psycopg/docs/install.html#binary-install-from-pypi&amp;gt;.&lt;/span&gt;
&lt;span class="s1"&gt;web_1  |   """)&lt;/span&gt;
&lt;span class="s1"&gt;web_1  | /usr/local/lib/python3.7/site-packages/psycopg2/__init__.py:144: UserWarning: The psycopg2 wheel package will be renamed from release 2.8; in order to keep installing from binary please use "pip install psycopg2-binary" instead. For details see: &amp;lt;http://initd.org/psycopg/docs/install.html#binary-install-from-pypi&amp;gt;.&lt;/span&gt;
&lt;span class="s1"&gt;web_1  |   """)&lt;/span&gt;
&lt;span class="s1"&gt;web_1  | Performing system checks...&lt;/span&gt;
&lt;span class="s1"&gt;web_1  |&lt;/span&gt;
&lt;span class="s1"&gt;web_1  | System check identified no issues (0 silenced).&lt;/span&gt;
&lt;span class="s1"&gt;web_1  |&lt;/span&gt;
&lt;span class="s1"&gt;web_1  | You have 14 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions.&lt;/span&gt;
&lt;span class="s1"&gt;web_1  | Run '&lt;/span&gt;python manage.py migrate&lt;span class="s1"&gt;' to apply them.&lt;/span&gt;
&lt;span class="s1"&gt;web_1  | November 26, 2018 - 14:44:40&lt;/span&gt;
&lt;span class="s1"&gt;web_1  | Django version 2.0.9, using settings '&lt;/span&gt;fff.settings&lt;span class="err"&gt;'&lt;/span&gt;
web_1  &lt;span class="p"&gt;|&lt;/span&gt; Starting development server at http://0.0.0.0:8000/
web_1  &lt;span class="p"&gt;|&lt;/span&gt; Quit the server with CONTROL-C.
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;アクセスする。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a class="reference external" href="http://localhost:3236/"&gt;http://localhost:3236/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="figure"&gt;
&lt;img alt="/images/docker/create-django-env-with-docker-compose-psql/hello-django.png" src="https://32imuf.com/images/docker/create-django-env-with-docker-compose-psql/hello-django.png"&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;実行中の コンテナを list する。&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_dafcfe347573438eb30777f0104abebd-1"&gt;&lt;/a&gt;$ docker ps
&lt;a name="rest_code_dafcfe347573438eb30777f0104abebd-2"&gt;&lt;/a&gt;CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES
&lt;a name="rest_code_dafcfe347573438eb30777f0104abebd-3"&gt;&lt;/a&gt;e95174b2be87        fff_web             &lt;span class="s2"&gt;"python3 manage.py r…"&lt;/span&gt;   &lt;span class="m"&gt;32&lt;/span&gt; minutes ago      Up &lt;span class="m"&gt;32&lt;/span&gt; minutes       &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:3236-&amp;gt;8000/tcp   fff_web_1
&lt;a name="rest_code_dafcfe347573438eb30777f0104abebd-4"&gt;&lt;/a&gt;2994f0092cd4        postgres            &lt;span class="s2"&gt;"docker-entrypoint.s…"&lt;/span&gt;   &lt;span class="m"&gt;41&lt;/span&gt; minutes ago      Up &lt;span class="m"&gt;41&lt;/span&gt; minutes       &lt;span class="m"&gt;5432&lt;/span&gt;/tcp                 fff_db_1
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;安全に shutdown する。&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_48587f01517e458e83f7e9b7a35c4b5b-1"&gt;&lt;/a&gt;$ docker-compose down
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>docker</category><guid>https://32imuf.com/docker/create-django-env-with-docker-compose-psql/</guid><pubDate>Sun, 25 Nov 2018 15:00:00 GMT</pubDate></item></channel></rss>