<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ふみのて (djangoについての文書)</title><link>https://32imuf.com/</link><description></description><atom:link href="https://32imuf.com/tags/django.xml" rel="self" type="application/rss+xml"></atom:link><language>ja</language><copyright>Contents © 2019 &lt;a href="mailto:fumi232323fumi2016@gmail.com"&gt;fumi23&lt;/a&gt; </copyright><lastBuildDate>Sun, 10 Nov 2019 14:52:22 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Django: Middleware</title><link>https://32imuf.com/django/middleware/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="id1"&gt;
&lt;p class="topic-title first"&gt;目次&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/middleware/#id2" id="id8"&gt;書籍/リファレンス&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/middleware/#id3" id="id9"&gt;概要&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/middleware/#id4" id="id10"&gt;主なミドルウェア&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/middleware/#securitymiddleware" id="id11"&gt;SecurityMiddleware&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/middleware/#sessionmiddleware" id="id12"&gt;SessionMiddleware&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/middleware/#commonmiddleware" id="id13"&gt;CommonMiddleware&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/middleware/#csrfviewmiddleware" id="id14"&gt;CsrfViewMiddleware&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/middleware/#authenticationmiddleware" id="id15"&gt;AuthenticationMiddleware&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/middleware/#messagemiddleware" id="id16"&gt;MessageMiddleware&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/middleware/#xframeoptionsmiddleware" id="id17"&gt;XFrameOptionsMiddleware&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/middleware/#id6" id="id18"&gt;ミドルウェアの書き方&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/middleware/#id8"&gt;書籍/リファレンス&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/topics/http/middleware/"&gt;https://docs.djangoproject.com/ja/2.2/topics/http/middleware/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://booth.pm/ja/items/1059917"&gt;現場で使える Django の教科書&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/middleware/#id9"&gt;概要&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Django の主要な機能 (モデル・テンプレート・ビュー) と Web サーバー/アプリケーションの中間に位置&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ビューを出入りするすべてのリクエストとレスポンスをフックできる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;さまざまなミドルウェアが組み込みで用意されている&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;自作して追加することも可能&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;必要なものを settings に加えると利用できる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;サイト全体にリクエストやレスポンスを使用して一律に何らかの機能を加えたい場合などに利用する&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;settings の &lt;code class="docutils literal"&gt;MIDDLEWARE&lt;/code&gt; にリスト形式で列挙&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;書いた順番に実行される。順番大事。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;書いたミドルウェアはリクエストの度に全部実行されるので、あまり重い処理は書かないようにすること。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;できるかぎりデータベースアクセスしない&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;必要なら &lt;code class="docutils literal"&gt;django.utils.functional.SimpleLazyObject&lt;/code&gt; を使うようにする&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/middleware/#id10"&gt;主なミドルウェア&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;以下は、 Django プロジェクト作成時にデフォルトで設定される&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;デフォルトで設定されるミドルウェアはとりあえずそのまま使うのが吉とのこと&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="securitymiddleware"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/middleware/#id11"&gt;SecurityMiddleware&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;リクエスト/レスポンスのセキュリティ強化&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;HTTP =&amp;gt; HTTPS リダイレクト (デフォルトはOFF)&lt;/p&gt;
&lt;pre class="code Python"&gt;&lt;a name="rest_code_1a2ef5bebaa3437cad3741de60a5e727-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;SECURE_SSL_REDIRECT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;入れておいて損はないので何も考えずに入れておくとよい&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="sessionmiddleware"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/middleware/#id12"&gt;SessionMiddleware&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;セッションを有効にする&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有効にする場合は、 &lt;code class="docutils literal"&gt;INSTALLED_APPS&lt;/code&gt; に &lt;code class="docutils literal"&gt;django.contrib.sessions&lt;/code&gt; を入れるのを忘れずに&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;使い方はここを見よ: &lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/topics/http/sessions/"&gt;https://docs.djangoproject.com/ja/2.2/topics/http/sessions/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;迷ったら有効化しておく&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="commonmiddleware"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/middleware/#id13"&gt;CommonMiddleware&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;ユーザーエージェントによるアクセス制限&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;URL リライティング&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;公式でも使用を強くお勧め&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;必須では&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;APPEND_SLASH&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;PREPEND_WWW&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="csrfviewmiddleware"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/middleware/#id14"&gt;CsrfViewMiddleware&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;CSRF トークン検証&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="authenticationmiddleware"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/middleware/#id15"&gt;AuthenticationMiddleware&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;リクエストの度に、リクエストオブジェクトの &lt;code class="docutils literal"&gt;user&lt;/code&gt; 属性にユーザー情報をセットしてくれる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ログイン済みの場合: セッション.Userインスタンス&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;未ログインの場合: AnonymousUser (匿名ユーザー)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;セッションが必要なので、 SessionMiddleware より後ろに書く&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="messagemiddleware"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/middleware/#id16"&gt;MessageMiddleware&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;フラッシュメッセージ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;メッセージフレームワーク&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://booth.pm/ja/items/1059917"&gt;現場で使える Django の教科書&lt;/a&gt; P.103&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="xframeoptionsmiddleware"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/middleware/#id17"&gt;XFrameOptionsMiddleware&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;クリックジャッキング対策&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;X-Frame-Options&lt;/span&gt;&lt;/code&gt; ヘッダーを全てのレスポンスに設定&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/middleware/#id18"&gt;ミドルウェアの書き方&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ここを見よ&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/topics/http/middleware/#writing-your-own-middleware"&gt;https://docs.djangoproject.com/ja/2.2/topics/http/middleware/#writing-your-own-middleware&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://booth.pm/ja/items/1059917"&gt;現場で使える Django の教科書&lt;/a&gt; P.101&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>django</category><guid>https://32imuf.com/django/middleware/</guid><pubDate>Sun, 13 Oct 2019 15:00:00 GMT</pubDate></item><item><title>Django: django-admin.py, manage.py</title><link>https://32imuf.com/django/manage/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="id1"&gt;
&lt;p class="topic-title first"&gt;目次&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#id2" id="id11"&gt;書籍/リファレンス&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#django-admin-manage-py" id="id12"&gt;django-admin と manage.py の違い&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#django-admin-py-django-admin" id="id13"&gt;django-admin.py, django-admin&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#manage-py" id="id14"&gt;manage.py&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#id3" id="id15"&gt;よく使う Django 管理コマンド&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#id4" id="id16"&gt;プロジェクト作成&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#id5" id="id17"&gt;アプリケーション作成&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#id6" id="id18"&gt;マイグレーション&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#id7" id="id19"&gt;くろのて&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#id8" id="id20"&gt;スーバーユーザー作成&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#runserver" id="id21"&gt;runserver&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#id9" id="id22"&gt;インタラクティブモードで実行する&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#id10" id="id23"&gt;使用例&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#django-dbdb" id="id24"&gt;Django の DBシェルでローカルDBにつなぐ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#system-check-framework-django" id="id25"&gt;System check framework を使って、Django プロジェクトの一般的な問題を検査する&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/manage/#python2" id="id26"&gt;使用例 (python2)&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id11"&gt;書籍/リファレンス&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/django-admin/"&gt;Django documentation &amp;gt; django-admin と manage.py&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://www.amazon.co.jp/dp/B07GK7BWB7/"&gt;現場で使える Django の教科書&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="django-admin-manage-py"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id12"&gt;django-admin と manage.py の違い&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;通常、単体の Django プロジェクトを用いる場合、 &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;django-admin&lt;/span&gt;&lt;/code&gt; よりも &lt;code class="docutils literal"&gt;manage.py&lt;/code&gt; の方が簡単に利用できる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;django-admin&lt;/span&gt;&lt;/code&gt;, &lt;code class="docutils literal"&gt;manage.py&lt;/code&gt;, &lt;code class="docutils literal"&gt;python &lt;span class="pre"&gt;-m&lt;/span&gt; django&lt;/code&gt; はすべて同じことができる ( &lt;code class="docutils literal"&gt;startproject&lt;/code&gt; 後は)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="django-admin-py-django-admin"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id13"&gt;django-admin.py, django-admin&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;インストールすると使えるようになる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;基本的にどこからでも利用できる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Django を &lt;code class="docutils literal"&gt;setup.py&lt;/code&gt; ユーティリティを通じてインストールした場合は &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;django-admin&lt;/span&gt;&lt;/code&gt; スクリプトはシステムのパスが通っている場所に配置されます。もしパスが通った箇所に存在しなければ、Python インストール先の &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;site-packages/django/bin&lt;/span&gt;&lt;/code&gt; 内で見つける事ができます。そのスクリプトに対して、 &lt;code class="docutils literal"&gt;/usr/local/bin&lt;/code&gt; 等のパスが通っている場所からシンボリックリンクを張ることを検討してください。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;新しく Django プロジェクトを作成するときに利用する&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Django プロジェクトを作成してしまったら &lt;code class="docutils literal"&gt;manage.py&lt;/code&gt; が使えるようになるので出番がなくなる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="manage-py"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id14"&gt;manage.py&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;startproject&lt;/code&gt; でプロジェクトを作成すると自動で作成される&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Django が提供する便利な管理コマンドが使えるほか...&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id15"&gt;よく使う Django 管理コマンド&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id16"&gt;プロジェクト作成&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_da737fc0232b4faea2b59a894a8fbd38-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# プロジェクトのディレクトリに移動する&lt;/span&gt;
&lt;a name="rest_code_da737fc0232b4faea2b59a894a8fbd38-2"&gt;&lt;/a&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; project_dir
&lt;a name="rest_code_da737fc0232b4faea2b59a894a8fbd38-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# django-admin.py startproject &amp;lt;設定ディレクトリ名&amp;gt; &amp;lt;つくる場所&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_da737fc0232b4faea2b59a894a8fbd38-4"&gt;&lt;/a&gt;$ django-admin.py startproject config .
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id17"&gt;アプリケーション作成&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_4cc80fd2865a4c4ba2d2e7be206a917c-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# プロジェクトのディレクトリに移動する&lt;/span&gt;
&lt;a name="rest_code_4cc80fd2865a4c4ba2d2e7be206a917c-2"&gt;&lt;/a&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; project_dir
&lt;a name="rest_code_4cc80fd2865a4c4ba2d2e7be206a917c-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# python manage.py startapp &amp;lt;アプリケーション名&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_4cc80fd2865a4c4ba2d2e7be206a917c-4"&gt;&lt;/a&gt;$ python manage.py startapp account
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;作成後、 settings.py &amp;gt; &lt;code class="docutils literal"&gt;INSTALLED_APPS&lt;/code&gt; に手動でアプリケーションを追加する&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id18"&gt;マイグレーション&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# マイグレーションファイルを作成する&lt;/span&gt;
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# python manage.py makemigrations [&amp;lt;アプリケーション名&amp;gt;]&lt;/span&gt;
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-3"&gt;&lt;/a&gt;$ python manage.py makemigrations account
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-5"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 作成される予定のマイグレーションを表示する。実際のマイグレーションファイルは作成されない。&lt;/span&gt;
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-6"&gt;&lt;/a&gt;$ python manage.py makemigrations --dry-run
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-8"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# マイグレーションを実行する&lt;/span&gt;
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-9"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# python manage.py migrate [&amp;lt;アプリケーション名&amp;gt;]&lt;/span&gt;
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-10"&gt;&lt;/a&gt;$ python manage.py migrate account
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-12"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# マイグレートするデータベースを指定する。デフォルトは default 。&lt;/span&gt;
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-13"&gt;&lt;/a&gt;$ python manage.py migrate --database &amp;lt;DATABASE&amp;gt;
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-14"&gt;&lt;/a&gt;$ python manage.py migrate --database hey
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-15"&gt;&lt;/a&gt;
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-16"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 適用済みとして django_migrations にレコードは INSERT されるけれど、データベーススキーマを変更するために実際にSQLを実行することはありません。&lt;/span&gt;
&lt;a name="rest_code_e59f6b258f7042ad965817ec237d1d89-17"&gt;&lt;/a&gt;$ python manage.py migrate --fake
&lt;/pre&gt;&lt;div class="section" id="id7"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id19"&gt;くろのて&lt;/a&gt;&lt;/h4&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://note.crohaco.net/2018/django-migration/"&gt;https://note.crohaco.net/2018/django-migration/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://note.crohaco.net/2018/django-migration-case-study/"&gt;https://note.crohaco.net/2018/django-migration-case-study/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id20"&gt;スーバーユーザー作成&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_9e2d46c02ef04e4a96851a2609accfab-1"&gt;&lt;/a&gt;$ python manage.py createsuperuser
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="runserver"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id21"&gt;runserver&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_eeed5d210df4490bbc68cc5f1f667d0b-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 開発用の Web サーバーを起動する&lt;/span&gt;
&lt;a name="rest_code_eeed5d210df4490bbc68cc5f1f667d0b-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# python manage.py runserver [&amp;lt;IPアドレス&amp;gt;:&amp;lt;ポート番号&amp;gt;]&lt;/span&gt;
&lt;a name="rest_code_eeed5d210df4490bbc68cc5f1f667d0b-3"&gt;&lt;/a&gt;$ python manage.py runserver &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:8000
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;IPアドレスとポート番号を省略すると &lt;code class="docutils literal"&gt;127.0.0.1:8000&lt;/code&gt; で起動する&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Docker 上で runserver =&amp;gt; ホストOSのブラウザから &lt;code class="docutils literal"&gt;127.0.0.1:8000&lt;/code&gt; に接続できないときは、 &lt;code class="docutils literal"&gt;0.0.0.0:8000&lt;/code&gt; で起動してみる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id22"&gt;インタラクティブモードで実行する&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_0c5262605c9b49cf9658186aaf2974ee-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# こうとか&lt;/span&gt;
&lt;a name="rest_code_0c5262605c9b49cf9658186aaf2974ee-2"&gt;&lt;/a&gt;$ python manage.py shell
&lt;a name="rest_code_0c5262605c9b49cf9658186aaf2974ee-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# こうとか&lt;/span&gt;
&lt;a name="rest_code_0c5262605c9b49cf9658186aaf2974ee-4"&gt;&lt;/a&gt;$ &lt;span class="nv"&gt;DJANGO_SETTINGS_MODULE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;settings._ python manage.py shell
&lt;a name="rest_code_0c5262605c9b49cf9658186aaf2974ee-5"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# こう&lt;/span&gt;
&lt;a name="rest_code_0c5262605c9b49cf9658186aaf2974ee-6"&gt;&lt;/a&gt;$ python manage.py shell --settings&lt;span class="o"&gt;=&lt;/span&gt;settings._
&lt;/pre&gt;&lt;div class="section" id="id10"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id23"&gt;使用例&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_4ae3e8e58ac446e6aef3ba4b95c12a46-1"&gt;&lt;/a&gt;&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="n"&gt;manage&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt; &lt;span class="n"&gt;shell&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;
&lt;a name="rest_code_4ae3e8e58ac446e6aef3ba4b95c12a46-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;Python&lt;/span&gt; &lt;span class="mf"&gt;2.7&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Dec&lt;/span&gt; &lt;span class="mi"&gt;11&lt;/span&gt; &lt;span class="mi"&gt;2017&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4ae3e8e58ac446e6aef3ba4b95c12a46-3"&gt;&lt;/a&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;GCC&lt;/span&gt; &lt;span class="mf"&gt;4.4&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="mi"&gt;20120313&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Red&lt;/span&gt; &lt;span class="n"&gt;Hat&lt;/span&gt; &lt;span class="mf"&gt;4.4&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;linux2&lt;/span&gt;
&lt;a name="rest_code_4ae3e8e58ac446e6aef3ba4b95c12a46-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;Type&lt;/span&gt; &lt;span class="s2"&gt;"help"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"copyright"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"credits"&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="s2"&gt;"license"&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;more&lt;/span&gt; &lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;a name="rest_code_4ae3e8e58ac446e6aef3ba4b95c12a46-5"&gt;&lt;/a&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;InteractiveConsole&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4ae3e8e58ac446e6aef3ba4b95c12a46-6"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;myapp.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Entry&lt;/span&gt;
&lt;a name="rest_code_4ae3e8e58ac446e6aef3ba4b95c12a46-7"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Q&lt;/span&gt;
&lt;a name="rest_code_4ae3e8e58ac446e6aef3ba4b95c12a46-8"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;target_entry_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;
&lt;a name="rest_code_4ae3e8e58ac446e6aef3ba4b95c12a46-9"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Entry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_4ae3e8e58ac446e6aef3ba4b95c12a46-10"&gt;&lt;/a&gt;&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;Q&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;expiration_year_month__gte&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;target_entry_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;a name="rest_code_4ae3e8e58ac446e6aef3ba4b95c12a46-11"&gt;&lt;/a&gt;&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;Q&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;expiration_year_month__isnull&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4ae3e8e58ac446e6aef3ba4b95c12a46-12"&gt;&lt;/a&gt;&lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="django-dbdb"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id24"&gt;Django の DBシェルでローカルDBにつなぐ&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code console"&gt;&lt;a name="rest_code_0df78f674ef8404caab325ea55de8533-1"&gt;&lt;/a&gt;&lt;span class="gp"&gt;$&lt;/span&gt; python manage.py dbshell --settings&lt;span class="o"&gt;=&lt;/span&gt;settings.local
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="system-check-framework-django"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id25"&gt;System check framework を使って、Django プロジェクトの一般的な問題を検査する&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/django-admin/#check"&gt;Django documentation &amp;gt; django-admin と manage.py &amp;gt; Available commands &amp;gt; check&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/checks/#system-check-framework"&gt;Django documentation &amp;gt; System check framework&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="python2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/manage/#id26"&gt;使用例 (python2)&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_68f5fea1210c4f2686a46938e82e4005-1"&gt;&lt;/a&gt;$ &lt;span class="nv"&gt;DJANGO_SETTINGS_MODULE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;settings.local python -Wd manage.py check
&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.python.org/ja/2.7/using/cmdline.html#cmdoption-w"&gt;https://docs.python.org/ja/2.7/using/cmdline.html#cmdoption-w&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;Python 2.7 から、 DeprecationWarning とその子クラスはデフォルトで無視されます。 -Wd オプションを指定して有効にすることができます。&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>django</category><guid>https://32imuf.com/django/manage/</guid><pubDate>Fri, 04 Oct 2019 15:00:00 GMT</pubDate></item><item><title>Django: Form</title><link>https://32imuf.com/django/form/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="id1"&gt;
&lt;p class="topic-title first"&gt;目次&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#id2" id="id12"&gt;書籍/リファレンス&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#id3" id="id13"&gt;役割&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#id4" id="id14"&gt;入力フィールド&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#id5" id="id15"&gt;バリデーション&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#id6" id="id16"&gt;実行される順番&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#clean" id="id17"&gt;clean_&amp;lt;フィールド名&amp;gt;()&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#id7" id="id18"&gt;clean()&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#view" id="id19"&gt;View からの利用&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#template" id="id20"&gt;Template からの利用&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#csrf" id="id21"&gt;CSRF&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#modelform" id="id22"&gt;ModelForm&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#id8" id="id23"&gt;こんなときに利用価値が高い&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#modelform-field" id="id24"&gt;ModelForm の Field&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#modelform-p-94" id="id25"&gt;ModelForm のバリデーションが実行される順番 (P.94 の絵がとてもよい)&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#id9" id="id26"&gt;View からの利用&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#id10" id="id27"&gt;こんなのある&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/form/#id11" id="id28"&gt;インラインフォームセット&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id12"&gt;書籍/リファレンス&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/forms/api/"&gt;Django documentation &amp;gt; フォーム API&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://booth.pm/ja/items/1059917"&gt;現場で使える Django の教科書&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id13"&gt;役割&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;入力データの保持&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;バリデーション&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;OK の場合: &lt;code class="docutils literal"&gt;cleaned_data&lt;/code&gt; (辞書) に入る&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ユーザー入力データを Python 型へ変換してくれる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;NG の場合: エラーメッセージ (list)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id14"&gt;入力フィールド&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_106c28f6883e4de3900b0e975bcbaafd-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;
&lt;a name="rest_code_106c28f6883e4de3900b0e975bcbaafd-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_106c28f6883e4de3900b0e975bcbaafd-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;LoginForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_106c28f6883e4de3900b0e975bcbaafd-4"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# この変数名が画面の入力フィールドの name 属性になる&lt;/span&gt;
&lt;a name="rest_code_106c28f6883e4de3900b0e975bcbaafd-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;  &lt;span class="c1"&gt;# django.forms.fields.Field クラスのサブクラスを指定&lt;/span&gt;
&lt;a name="rest_code_106c28f6883e4de3900b0e975bcbaafd-6"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# widget でどんな部品で画面に表示するか指定できる。 Field ごとにデフォルトもある。&lt;/span&gt;
&lt;a name="rest_code_106c28f6883e4de3900b0e975bcbaafd-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;widget&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PasswordInput&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;render_value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a name="rest_code_106c28f6883e4de3900b0e975bcbaafd-8"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# そのほかにも、いろいろ指定できる。指定できるものは Field により異なる。&lt;/span&gt;
&lt;a name="rest_code_106c28f6883e4de3900b0e975bcbaafd-9"&gt;&lt;/a&gt;        &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'パスワード'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_106c28f6883e4de3900b0e975bcbaafd-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_106c28f6883e4de3900b0e975bcbaafd-11"&gt;&lt;/a&gt;    &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id15"&gt;バリデーション&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id16"&gt;実行される順番&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;Form.is_valid()&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;Form.フィールド&lt;/code&gt; に定義されたバリデーション&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;文字種チェックなど&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;フォームクラスに定義した順に実行される&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;Form.clean_&amp;lt;フィールド名&amp;gt;()&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;単項目。フィールド単体のバリデーション。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;妥当性チェック&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;フォームクラスに定義した順に実行される&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;Form.clean()&lt;/code&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;複数項目&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;相関チェック&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;データベースとの整合性チェック&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;バリデーション OK の場合、 &lt;code class="docutils literal"&gt;Form.cleaned_data&lt;/code&gt; に検証済みデータがセットされる&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;is_valid()&lt;/code&gt; 未実行の場合は &lt;code class="docutils literal"&gt;cleaned_data&lt;/code&gt; 属性自体が存在しない&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="clean"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id17"&gt;clean_&amp;lt;フィールド名&amp;gt;()&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;LoginForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;UsernameField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'ユーザー名'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-6"&gt;&lt;/a&gt;        &lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-7"&gt;&lt;/a&gt;    &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-8"&gt;&lt;/a&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-9"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# ``clean_&amp;lt;フィールド名&amp;gt;`` というメソッド名にする&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-10"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clean_username&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-11"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# 入力値は cleaned_data から取得する&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-12"&gt;&lt;/a&gt;        &lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'username'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-13"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-14"&gt;&lt;/a&gt;            &lt;span class="c1"&gt;# バリデーション NG の場合&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-15"&gt;&lt;/a&gt;            &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ValidationError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-16"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;# ValidationError を raise すると Form 内部の変数にエラーメッセージを追加できる&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-17"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;# ValidationError には↓のように、メッセージを設定できる&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-18"&gt;&lt;/a&gt;                &lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="si"&gt;%(min_length)s&lt;/span&gt;&lt;span class="s1"&gt; 文字以上で入力してください'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'min_length'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-19"&gt;&lt;/a&gt;            &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-20"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# バリデーションOK の場合は、 検証済み値を return することで cleaned_data に値を再セットできる&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-21"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# ``return 値`` しないと cleaned_data から値が消えてしまう!!&lt;/span&gt;
&lt;a name="rest_code_506a920b20024e1abfbe232c17bb5d22-22"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id18"&gt;clean()&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-2"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# 入力値は cleaned_data から取得する&lt;/span&gt;
&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'username'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'password'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;ObjectDoesNotExist&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-9"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# バリデーション NG の場合 `ValidationError` を raise することで&lt;/span&gt;
&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-10"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# エラーメッセージを Form 内部の変数に追加できる&lt;/span&gt;
&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-11"&gt;&lt;/a&gt;        &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ValidationError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"正しいユーザー名を入力してください"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_34b9cee16fef4d57812b228a71b38853-13"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# バリデーションOK の場合、 検証済み値を return する必要はない&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="view"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id19"&gt;View からの利用&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;リクエストオブジェクトから入力データを取得して型変換&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;入力データをバリデーション&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_877a152f8a864c1da4f11eea855319f7-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Form に request.POST をあげる&lt;/span&gt;
&lt;a name="rest_code_877a152f8a864c1da4f11eea855319f7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LoginForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;POST&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_877a152f8a864c1da4f11eea855319f7-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# request から入力データを取り出して =&amp;gt; 型変換して =&amp;gt; バリデーションをする&lt;/span&gt;
&lt;a name="rest_code_877a152f8a864c1da4f11eea855319f7-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;is_valid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_valid&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_877a152f8a864c1da4f11eea855319f7-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_877a152f8a864c1da4f11eea855319f7-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;is_valid&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_877a152f8a864c1da4f11eea855319f7-7"&gt;&lt;/a&gt;  &lt;span class="c1"&gt;# ヴァリデーションNGの場合、遷移元画面のテンプレートにフォームオブジェクトを 'form' という名前で渡している&lt;/span&gt;
&lt;a name="rest_code_877a152f8a864c1da4f11eea855319f7-8"&gt;&lt;/a&gt;  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'account/login.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'form'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="template"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id20"&gt;Template からの利用&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;テンプレート内でフォームの入力データやエラーメッセージを表示する&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_fed96d46f7434a73abe9096eb9df2164-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# これだけで入力データがセットされた入力フィールドを全て出力できる&lt;/span&gt;
&lt;a name="rest_code_fed96d46f7434a73abe9096eb9df2164-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# * フィールドの出力順は、フォームクラスにフィールドを定義した順&lt;/span&gt;
&lt;a name="rest_code_fed96d46f7434a73abe9096eb9df2164-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# * 順番を変更したい =&amp;gt; Form に `field_order`&lt;/span&gt;
&lt;a name="rest_code_fed96d46f7434a73abe9096eb9df2164-4"&gt;&lt;/a&gt;&lt;span class="p"&gt;{{&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;}}&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="code python"&gt;&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-1"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="c1"&gt;# form オブジェクトをイテレートすると form に定義した fields が順番に取り出せるよ! #}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-2"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-3"&gt;&lt;/a&gt;  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;div&lt;/span&gt; &lt;span class="n"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"field"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-4"&gt;&lt;/a&gt;    &lt;span class="p"&gt;{{&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt; &lt;span class="p"&gt;}}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-5"&gt;&lt;/a&gt;  &lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-6"&gt;&lt;/a&gt;  &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;errors&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-7"&gt;&lt;/a&gt;    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="c1"&gt;# field に関連する error messages は errors 属性にリスト形式で入っている #}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-8"&gt;&lt;/a&gt;    &lt;span class="p"&gt;{{&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;errors&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;}}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-9"&gt;&lt;/a&gt;  &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;endif&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-10"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;endfor&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-12"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="c1"&gt;# 全体エラーメッセージ #}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-13"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="c1"&gt;# Form.clean() で追加したエラーメッセージは、 form オブジェクトの non_field_errors 属性にリストで入っている #}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-14"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;non_field_errors&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-15"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;div&lt;/span&gt; &lt;span class="n"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ui red message"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-16"&gt;&lt;/a&gt;  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ul&lt;/span&gt; &lt;span class="n"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"list"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-17"&gt;&lt;/a&gt;    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;non_field_error&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;non_field_errors&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-18"&gt;&lt;/a&gt;      &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;li&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{{&lt;/span&gt; &lt;span class="n"&gt;non_field_error&lt;/span&gt; &lt;span class="p"&gt;}}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;li&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-19"&gt;&lt;/a&gt;    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;endfor&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-20"&gt;&lt;/a&gt;  &lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;ul&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-21"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_152dc8f20a39423e9c735046b66383a3-22"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;endif&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="csrf"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id21"&gt;CSRF&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;シーサーフ、クロスサイトリクエストフォージェリーと呼ばれるセキュリティ攻撃の一種&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;POST リクエストに CSRF 対策のトークン &lt;code class="docutils literal"&gt;csrfmiddlewaretoken&lt;/code&gt; を加えられる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_3a22cf91fce841868dda6da643aadf10-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# template の form 内にこれを書くよ&lt;/span&gt;
&lt;a name="rest_code_3a22cf91fce841868dda6da643aadf10-2"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;csrf_token&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="modelform"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id22"&gt;ModelForm&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id23"&gt;こんなときに利用価値が高い&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;モデルに定義したフィールドのうちのいくつかが画面の入力フィールドと合致する&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;モデルの登録や変更を伴う&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_efcfb40d00184737a5167b6cf2d3f706-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;
&lt;a name="rest_code_efcfb40d00184737a5167b6cf2d3f706-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib.auth.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;
&lt;a name="rest_code_efcfb40d00184737a5167b6cf2d3f706-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_efcfb40d00184737a5167b6cf2d3f706-4"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# django.forms.models.ModelForm を継承する&lt;/span&gt;
&lt;a name="rest_code_efcfb40d00184737a5167b6cf2d3f706-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RegisterForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ModelForm&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_efcfb40d00184737a5167b6cf2d3f706-6"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""ユーザー登録画面用のフォーム"""&lt;/span&gt;
&lt;a name="rest_code_efcfb40d00184737a5167b6cf2d3f706-7"&gt;&lt;/a&gt;    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_efcfb40d00184737a5167b6cf2d3f706-8"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# 利用するモデルクラスを指定&lt;/span&gt;
&lt;a name="rest_code_efcfb40d00184737a5167b6cf2d3f706-9"&gt;&lt;/a&gt;        &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;
&lt;a name="rest_code_efcfb40d00184737a5167b6cf2d3f706-10"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# 利用するモデルのフィールドを指定&lt;/span&gt;
&lt;a name="rest_code_efcfb40d00184737a5167b6cf2d3f706-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'username'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'email'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'password'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="modelform-field"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id24"&gt;ModelForm の Field&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ModelForm は、モデルの django.db.models.fields.Field のサブクラスを自動判別してそれに対応するフォームの django.forms.fields.Field のサブクラスに変換してくれる&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;対応表は P.92&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;変換されたフォームの Field をそのまま使えない場合は、いろいろカスタマイズできる。&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RegisterForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ModelForm&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-2"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""ユーザー登録画面用のフォーム"""&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-5"&gt;&lt;/a&gt;        &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-6"&gt;&lt;/a&gt;        &lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'username'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'email'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'password'&lt;/span&gt;&lt;span class="p"&gt;,)&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-7"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# widget を TextInput から PasswordInput に変更&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-8"&gt;&lt;/a&gt;        &lt;span class="n"&gt;widgets&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-9"&gt;&lt;/a&gt;            &lt;span class="s1"&gt;'password'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PasswordInput&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'placeholder'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'パスワード'&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-10"&gt;&lt;/a&gt;        &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-12"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# User モデルにはない「確認用パスワード」フィールドを追加&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;password2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'確認用パスワード'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-15"&gt;&lt;/a&gt;        &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-16"&gt;&lt;/a&gt;        &lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;widgets&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PasswordInput&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'placeholder'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'確認用パスワード'&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-18"&gt;&lt;/a&gt;    &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-19"&gt;&lt;/a&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-20"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-21"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RegisterForm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-22"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# プレースホルダーをつける&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-23"&gt;&lt;/a&gt;        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'username'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;widget&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attrs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'placeholder'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'ユーザー名'&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-24"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# email に必須を設定&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-25"&gt;&lt;/a&gt;        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'email'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;required&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-26"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# プレースホルダーをつける&lt;/span&gt;
&lt;a name="rest_code_b7e991e36e814b0884f55c638af1e2f0-27"&gt;&lt;/a&gt;        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'email'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;widget&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attrs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'placeholder'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'メールアドレス'&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="modelform-p-94"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id25"&gt;ModelForm のバリデーションが実行される順番 (P.94 の絵がとてもよい)&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p&gt;フィールドのバリデーション&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;文字種などの形式チェック&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;フォームのバリデーション&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;値の妥当性チェック&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;clean_&amp;lt;フィールド名&amp;gt;()&lt;/span&gt;&lt;/code&gt; =&amp;gt; &lt;code class="docutils literal"&gt;clean()&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;モデルのバリデーション&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ユニーク制約などのデータベースとの整合性チェック&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;モデルの各フィールドに定義された &lt;code class="docutils literal"&gt;unique=True&lt;/code&gt; の制約にしたがって、レコードがユニークになっているか否かチェックしてくれる! ので、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;モデルの登録変更を伴うフォームでは、親クラスの &lt;code class="docutils literal"&gt;clean()&lt;/code&gt; を明示的に呼び出すとよい&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_ff01832ab8aa45b49b8be59766e29362-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_ff01832ab8aa45b49b8be59766e29362-2"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# 明示的に親クラスの clean() を呼び出すことで、&lt;/span&gt;
&lt;a name="rest_code_ff01832ab8aa45b49b8be59766e29362-3"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# Form を `_validate_unique = True` に更新する&lt;/span&gt;
&lt;a name="rest_code_ff01832ab8aa45b49b8be59766e29362-4"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# そうすると、 validate_unique() が実行されるようになる&lt;/span&gt;
&lt;a name="rest_code_ff01832ab8aa45b49b8be59766e29362-5"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RegisterForm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clean&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_ff01832ab8aa45b49b8be59766e29362-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;changed_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'password'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_ff01832ab8aa45b49b8be59766e29362-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;password2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;changed_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'password2'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_ff01832ab8aa45b49b8be59766e29362-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;password2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_ff01832ab8aa45b49b8be59766e29362-9"&gt;&lt;/a&gt;        &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ValidationError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"パスワードと確認用パスワードが合致しません"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id26"&gt;View からの利用&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;登録の場合&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_d99a278b06ef4774aca66423218a4e81-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# GET や POST オブジェクトをあげる&lt;/span&gt;
&lt;a name="rest_code_d99a278b06ef4774aca66423218a4e81-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RegisterForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;POST&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_d99a278b06ef4774aca66423218a4e81-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 対象のモデルをデータベースに保存&lt;/span&gt;
&lt;a name="rest_code_d99a278b06ef4774aca66423218a4e81-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;request からもらったものだけでは足りない場合&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_25c6a2d37d45413da14ffbabacbfedca-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# モデルにセットするけれど、データベースには登録していない&lt;/span&gt;
&lt;a name="rest_code_25c6a2d37d45413da14ffbabacbfedca-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_25c6a2d37d45413da14ffbabacbfedca-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 補完してあげる&lt;/span&gt;
&lt;a name="rest_code_25c6a2d37d45413da14ffbabacbfedca-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_password&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'password'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_25c6a2d37d45413da14ffbabacbfedca-5"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# データベースに登録する&lt;/span&gt;
&lt;a name="rest_code_25c6a2d37d45413da14ffbabacbfedca-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;更新の場合&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_d2efe6db1085465eb78ab3732d97a23f-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 更新したい model オブジェクトを DB から取得&lt;/span&gt;
&lt;a name="rest_code_d2efe6db1085465eb78ab3732d97a23f-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pk&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_d2efe6db1085465eb78ab3732d97a23f-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# `instance` キーワード引数にあげる&lt;/span&gt;
&lt;a name="rest_code_d2efe6db1085465eb78ab3732d97a23f-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ProfileForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;POST&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_d2efe6db1085465eb78ab3732d97a23f-5"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 更新前のデータをベースにして request で上書きしてくれる&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id27"&gt;こんなのある&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id11"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/form/#id28"&gt;インラインフォームセット&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;使い方はよくわかっていない&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/topics/forms/modelforms/#inline-formsets"&gt;https://docs.djangoproject.com/ja/2.2/topics/forms/modelforms/#inline-formsets&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/forms/models/#inlineformset-factory"&gt;https://docs.djangoproject.com/ja/2.2/ref/forms/models/#inlineformset-factory&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>django</category><guid>https://32imuf.com/django/form/</guid><pubDate>Sat, 13 Jul 2019 15:00:00 GMT</pubDate></item><item><title>Django なんでもメモ</title><link>https://32imuf.com/django/note/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="id1"&gt;
&lt;p class="topic-title first"&gt;目次&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#time-zones" id="id11"&gt;Time zones&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#id2" id="id12"&gt;リファレンス&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#id3" id="id13"&gt;タイムゾーンサポート&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#naive-aware" id="id14"&gt;naive と aware&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#django" id="id15"&gt;タイムゾーンサポートが有効なときの Django の日時の取り扱い方&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#id4" id="id16"&gt;現在日時の取得&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#id5" id="id17"&gt;デフォルトタイムゾーンとカレントタイムゾーン&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#naive-django" id="id18"&gt;naive な日時をデータベースに保存しようとすると、Django は警告を出す&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#s3" id="id19"&gt;S3 アップロード&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#id6" id="id20"&gt;マイグレーションを間違えたときのリカバリ方法&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#id7" id="id21"&gt;こんなのある&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#multivaluedict" id="id22"&gt;MultiValueDict&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#querydict" id="id23"&gt;QueryDict オブジェクト&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#id9" id="id24"&gt;便利さん&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/note/#id10" id="id25"&gt;django に便利コマンド追加してくれるさん&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="time-zones"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id11"&gt;Time zones&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id12"&gt;リファレンス&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/topics/i18n/timezones/"&gt;https://docs.djangoproject.com/ja/2.2/topics/i18n/timezones/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/utils/#module-django.utils.timezone"&gt;https://docs.djangoproject.com/ja/2.2/ref/utils/#module-django.utils.timezone&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id13"&gt;タイムゾーンサポート&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;settings.py&lt;/code&gt; で設定する&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;USE_TZ = True&lt;/code&gt;: タイムゾーンサポートが有効&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;USE_TZ = False&lt;/code&gt;: タイムゾーンサポートが無効 (default)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;django-admin&lt;/span&gt; startproject&lt;/code&gt; によって生成されるデフォルトの &lt;code class="docutils literal"&gt;settings.py&lt;/code&gt; ファイル は、 &lt;code class="docutils literal"&gt;USE_TZ = True&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;タイムゾーンのサポートは &lt;code class="docutils literal"&gt;pytz&lt;/code&gt; を使用する。Django をインストールしたときに一緒にインストールされている。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="naive-aware"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id14"&gt;naive と aware&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;aware: タイムゾーンあり&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Python の &lt;code class="docutils literal"&gt;datetime.datetime&lt;/code&gt; のオブジェクトには、タイムゾーン情報を保持するために使える tzinfo 属性があり、これは &lt;code class="docutils literal"&gt;datetime.tzinfo&lt;/code&gt; のサブクラスのインスタンスで表されます。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;この属性がセットされオフセットを示すとき、datetime オブジェクトは aware となります。それ以外の場合は naive となります。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;naive: タイムゾーンなし&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="django"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id15"&gt;タイムゾーンサポートが有効なときの Django の日時の取り扱い方&lt;/a&gt;&lt;/h3&gt;
&lt;dl class="field-list simple"&gt;
&lt;dt&gt;データベース&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;内部的に aware なタイムゾーンオブジェクトを使用して、 UTC で保持&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;フォーム&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;入力された日時をカレントタイムゾーンで変換し、 cleaned_data 内で aware な datetime オブジェクトを返す&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;テンプレート&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;レンダリングする際に aware な datetime オブジェクトをカレントタイムゾーンに変換する&lt;/p&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id16"&gt;現在日時の取得&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;タイムゾーンサポートが有効&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# USE_TZ = True&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# TIME_ZONE = 'Asia/Tokyo'&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-4"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.utils&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;timezone&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-5"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-6"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pytz&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-8"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;timezone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2019&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;903697&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tzinfo&lt;/span&gt;&lt;span class="o"&gt;=&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;UTC&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-10"&gt;&lt;/a&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-11"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2019&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;41&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;152275&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-14"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;timezone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;make_aware&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2019&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;56&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;39144&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tzinfo&lt;/span&gt;&lt;span class="o"&gt;=&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;DstTzInfo&lt;/span&gt; &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt; &lt;span class="n"&gt;JST&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt; &lt;span class="n"&gt;STD&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-16"&gt;&lt;/a&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-17"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;timezone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;localtime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;timezone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2019&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;24&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;36991&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tzinfo&lt;/span&gt;&lt;span class="o"&gt;=&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;DstTzInfo&lt;/span&gt; &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt; &lt;span class="n"&gt;JST&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt; &lt;span class="n"&gt;STD&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-19"&gt;&lt;/a&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-20"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tz&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pytz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timezone&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_4675274a05fd4abdb00280f8dd903f2b-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2019&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;24&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;258210&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tzinfo&lt;/span&gt;&lt;span class="o"&gt;=&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;DstTzInfo&lt;/span&gt; &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt; &lt;span class="n"&gt;JST&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt; &lt;span class="n"&gt;STD&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;タイムゾーンサポートが無効&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# USE_TZ = False&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-3"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.utils&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;timezone&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-4"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-5"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-7"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;timezone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2019&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;28&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;147660&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-9"&gt;&lt;/a&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-10"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2019&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;28&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;41&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;569008&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-13"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;timezone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;make_aware&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2019&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;28&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;973598&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tzinfo&lt;/span&gt;&lt;span class="o"&gt;=&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;DstTzInfo&lt;/span&gt; &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt; &lt;span class="n"&gt;JST&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt; &lt;span class="n"&gt;STD&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-15"&gt;&lt;/a&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-16"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;timezone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;localtime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;timezone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;Traceback&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;most&lt;/span&gt; &lt;span class="n"&gt;recent&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt; &lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-18"&gt;&lt;/a&gt;  &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="s2"&gt;"&amp;lt;console&amp;gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;module&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-19"&gt;&lt;/a&gt;  &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="s2"&gt;"/var/www/usonar/.tox/py37/lib/python3.7/site-packages/django/utils/timezone.py"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;207&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;localtime&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-20"&gt;&lt;/a&gt;    &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"localtime() cannot be applied to a naive datetime"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-21"&gt;&lt;/a&gt;&lt;span class="ne"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;localtime&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="n"&gt;cannot&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;applied&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;naive&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-22"&gt;&lt;/a&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-23"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tz&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pytz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timezone&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_f266f67c0d764788bb36ccaec886685d-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2019&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;29&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;566142&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tzinfo&lt;/span&gt;&lt;span class="o"&gt;=&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;DstTzInfo&lt;/span&gt; &lt;span class="s1"&gt;'Asia/Tokyo'&lt;/span&gt; &lt;span class="n"&gt;JST&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt; &lt;span class="n"&gt;STD&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id17"&gt;デフォルトタイムゾーンとカレントタイムゾーン&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;デフォルトタイムゾーン: &lt;code class="docutils literal"&gt;settings.TIME_ZONE&lt;/code&gt; に定義されたタイムゾーン&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;カレントタイムゾーン: レンダリングに使われるタイムゾーン&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="naive-django"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id18"&gt;naive な日時をデータベースに保存しようとすると、Django は警告を出す&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_82c64cfcbcfd409d9ceae02a4080ac65-1"&gt;&lt;/a&gt;&lt;span class="ne"&gt;RuntimeWarning&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;DateTimeField&lt;/span&gt; &lt;span class="n"&gt;ModelName&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt; &lt;span class="n"&gt;received&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;naive&lt;/span&gt;
&lt;a name="rest_code_82c64cfcbcfd409d9ceae02a4080ac65-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;datetime&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2012&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mo"&gt;01&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mo"&gt;01&lt;/span&gt; &lt;span class="mo"&gt;00&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mo"&gt;00&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt; &lt;span class="n"&gt;zone&lt;/span&gt; &lt;span class="n"&gt;support&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="n"&gt;active&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="s3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id19"&gt;S3 アップロード&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;体感だけど、パターン1 のほうが速いような感じがした&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_3951311449c442e2bb6337edc87bd94c-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# settings.py&lt;/span&gt;
&lt;a name="rest_code_3951311449c442e2bb6337edc87bd94c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;DEFAULT_FILE_STORAGE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'storages.backends.s3boto3.S3Boto3Storage'&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="code python"&gt;&lt;a name="rest_code_0181dde83fdb4812a964336832386f0d-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# upload.py&lt;/span&gt;
&lt;a name="rest_code_0181dde83fdb4812a964336832386f0d-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.core.files.base&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ContentFile&lt;/span&gt;
&lt;a name="rest_code_0181dde83fdb4812a964336832386f0d-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.core.files.storage&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;default_storage&lt;/span&gt;
&lt;a name="rest_code_0181dde83fdb4812a964336832386f0d-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_0181dde83fdb4812a964336832386f0d-5"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# パターン1&lt;/span&gt;
&lt;a name="rest_code_0181dde83fdb4812a964336832386f0d-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;file_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;default_storage&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ContentFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_data&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_0181dde83fdb4812a964336832386f0d-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_0181dde83fdb4812a964336832386f0d-8"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# パターン2&lt;/span&gt;
&lt;a name="rest_code_0181dde83fdb4812a964336832386f0d-9"&gt;&lt;/a&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;default_storage&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'w'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_0181dde83fdb4812a964336832386f0d-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;file_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://django-storages.readthedocs.io/en/latest/backends/amazon-S3.html"&gt;https://django-storages.readthedocs.io/en/latest/backends/amazon-S3.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/en/2.2/ref/files/storage/#the-storage-class"&gt;https://docs.djangoproject.com/en/2.2/ref/files/storage/#the-storage-class&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/en/2.2/topics/files/#storage-objects"&gt;https://docs.djangoproject.com/en/2.2/topics/files/#storage-objects&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id20"&gt;マイグレーションを間違えたときのリカバリ方法&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p&gt;DjangoのDBシェルでローカルDBにつなぐ&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code console"&gt;&lt;a name="rest_code_943afed9fff24ccda2fecf3698a659b6-1"&gt;&lt;/a&gt;&lt;span class="gp"&gt;$&lt;/span&gt; python manage.py dbshell --settings&lt;span class="o"&gt;=&lt;/span&gt;settings.local
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;django_migrations テーブルから該当アプリのレコードを削除する&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code sql"&gt;&lt;a name="rest_code_7653f013206049f3b82560d56d429895-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;django_migrations&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="k"&gt;like&lt;/span&gt; &lt;span class="s1"&gt;'%{application_name}%'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_7653f013206049f3b82560d56d429895-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;DELETE&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;django_migrations&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;{該当の&lt;/span&gt;&lt;span class="n"&gt;ID&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;該当テーブルやカラムも DROP する&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code sql"&gt;&lt;a name="rest_code_80c4bdf5f5cc4791be38f227334a52fc-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;DROP&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="k"&gt;table_name&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_80c4bdf5f5cc4791be38f227334a52fc-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;ALTER&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="k"&gt;table_name&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt; &lt;span class="k"&gt;DROP&lt;/span&gt; &lt;span class="k"&gt;COLUMN&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="k"&gt;column_name&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;該当のマイグレーションファイルも削除しておく&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;もう一回最初からマイグレーションする&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code console"&gt;&lt;a name="rest_code_af39cfee122344749cd8e93dc4fbeed3-1"&gt;&lt;/a&gt;&lt;span class="gp"&gt;$&lt;/span&gt; python manage.py makemigrations &lt;span class="o"&gt;{&lt;/span&gt;application_name&lt;span class="o"&gt;}&lt;/span&gt; --settings&lt;span class="o"&gt;=&lt;/span&gt;settings.local
&lt;a name="rest_code_af39cfee122344749cd8e93dc4fbeed3-2"&gt;&lt;/a&gt;&lt;span class="gp"&gt;$&lt;/span&gt; python manage.py migrate &lt;span class="o"&gt;{&lt;/span&gt;application_name&lt;span class="o"&gt;}&lt;/span&gt; --settings&lt;span class="o"&gt;=&lt;/span&gt;settings.local
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id21"&gt;こんなのある&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="multivaluedict"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id22"&gt;MultiValueDict&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;なにがうれしいのかさっぱりわからない =&amp;gt; &lt;cite&gt;MultiValueDict を継承してる QueryDict とか見るとユースケースはなんとなく想像つくと思います&lt;/cite&gt; と教えて頂いた。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.1/_modules/django/utils/datastructures/"&gt;https://docs.djangoproject.com/ja/2.1/_modules/django/utils/datastructures/&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;A subclass of dictionary customized to handle multiple values for the same key.&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;よく見たら、こういうところが便利だと思った ↓&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_35d155f9c59d42e8a65d8cc2df3def55-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.utils.datastructures&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MultiValueDict&lt;/span&gt;
&lt;a name="rest_code_35d155f9c59d42e8a65d8cc2df3def55-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MultiValueDict&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;'name'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Adrian'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'Simon'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;'position'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Developer'&lt;/span&gt;&lt;span class="p"&gt;]})&lt;/span&gt;
&lt;a name="rest_code_35d155f9c59d42e8a65d8cc2df3def55-3"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;'name'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'Momo'&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;a name="rest_code_35d155f9c59d42e8a65d8cc2df3def55-4"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;
&lt;a name="rest_code_35d155f9c59d42e8a65d8cc2df3def55-5"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;MultiValueDict&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'position'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Developer'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;'name'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Adrian'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'Simon'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'Momo'&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_35d155f9c59d42e8a65d8cc2df3def55-6"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;dd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'name'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Adrian'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'Simon'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;'position'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Developer'&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt;
&lt;a name="rest_code_35d155f9c59d42e8a65d8cc2df3def55-7"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;dd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;'name'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'Momo'&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;a name="rest_code_35d155f9c59d42e8a65d8cc2df3def55-8"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;dd&lt;/span&gt;
&lt;a name="rest_code_35d155f9c59d42e8a65d8cc2df3def55-9"&gt;&lt;/a&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'position'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Developer'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;'name'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'Momo'&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="querydict"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id23"&gt;QueryDict オブジェクト&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;cite&gt;In an HttpRequest object, the GET and POST attributes are instances of django.http.QueryDict&lt;/cite&gt; だそうです。&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.1/ref/request-response/#querydict-objects"&gt;QueryDict オブジェクト&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;In an HttpRequest object, the GET and POST attributes are instances of django.http.QueryDict, a dictionary-like class customized to deal with multiple values for the same key. This is necessary because some HTML form elements, notably &amp;lt;select multiple&amp;gt;, pass multiple values for the same key.&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id24"&gt;便利さん&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id10"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/note/#id25"&gt;django に便利コマンド追加してくれるさん&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://django-extensions.readthedocs.io/en/latest/"&gt;django-extensions&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>django</category><guid>https://32imuf.com/django/note/</guid><pubDate>Mon, 17 Jun 2019 15:00:00 GMT</pubDate></item><item><title>Django: Test</title><link>https://32imuf.com/django/test/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="id1"&gt;
&lt;p class="topic-title first"&gt;目次&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/test/#requestfactory" id="id2"&gt;RequestFactory&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="requestfactory"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/test/#id2"&gt;RequestFactory&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/en/2.2/topics/testing/advanced/#django.test.RequestFactory"&gt;Django documentation &amp;gt; Advanced testing topics &amp;gt; RequestFactory&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>django</category><guid>https://32imuf.com/django/test/</guid><pubDate>Mon, 20 May 2019 15:00:00 GMT</pubDate></item><item><title>Django: Template</title><link>https://32imuf.com/django/template/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="id1"&gt;
&lt;p class="topic-title first"&gt;目次&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id2" id="id22"&gt;リファレンス/書籍&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id4" id="id23"&gt;なるほどめも&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id5" id="id24"&gt;変数表示&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id6" id="id25"&gt;フィルタ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id7" id="id26"&gt;デフォルト表示&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id8" id="id27"&gt;文字列長を表示&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id9" id="id28"&gt;エスケープの無効化&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id10" id="id29"&gt;日時フォーマット&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id11" id="id30"&gt;改行タグの変換&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id12" id="id31"&gt;リンク変換&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id13" id="id32"&gt;文字の切り詰め&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id14" id="id33"&gt;テンプレートタグ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#if" id="id34"&gt;if&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#for" id="id35"&gt;for&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id15" id="id36"&gt;テンプレートの継承&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id16" id="id37"&gt;外部テンプレートの読み込み&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#url" id="id38"&gt;静的ファイルの配信 URL 取得&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id17" id="id39"&gt;url&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id18" id="id40"&gt;自動エスケープ制御&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id19" id="id41"&gt;ベーステンプレートを用意しよう&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/template/#id20" id="id42"&gt;独自のテンプレートタグとフィルタ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id22"&gt;リファレンス/書籍&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/topics/templates/"&gt;Django documentation &amp;gt; テンプレート&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/templates/builtins/"&gt;Django documentation &amp;gt; 組み込みタグとフィルタ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://www.amazon.co.jp/dp/B07GK7BWB7/"&gt;現場で使える Django の教科書&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id23"&gt;なるほどめも&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;変数定義できない&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Python モジュールを直接 import して使うことはできない&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;独自の関数を使うにはテンプレートタグやフィルタを自作する&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;フィルター: 変数の内容を表示する際の表示形式を変更する&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id24"&gt;変数表示&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_39fbfa0ba0c9476a90c9afcfe24d0968-1"&gt;&lt;/a&gt;&lt;span class="c"&gt;{# __str__() の結果を表示してくれる #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_39fbfa0ba0c9476a90c9afcfe24d0968-2"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;user&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_39fbfa0ba0c9476a90c9afcfe24d0968-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_39fbfa0ba0c9476a90c9afcfe24d0968-4"&gt;&lt;/a&gt;&lt;span class="c"&gt;{# このように書くと #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_39fbfa0ba0c9476a90c9afcfe24d0968-5"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;user.username&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_39fbfa0ba0c9476a90c9afcfe24d0968-6"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;comment&lt;/span&gt; &lt;span class="s2"&gt;"以下の順番に値を取得しようとして、一番先に取得できた値を表示してくれる"&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_39fbfa0ba0c9476a90c9afcfe24d0968-7"&gt;&lt;/a&gt;&lt;span class="x"&gt;  user['username']  # 1. 辞書としての照合&lt;/span&gt;
&lt;a name="rest_code_39fbfa0ba0c9476a90c9afcfe24d0968-8"&gt;&lt;/a&gt;&lt;span class="x"&gt;  user.username     # 2. 属性値の照合&lt;/span&gt;
&lt;a name="rest_code_39fbfa0ba0c9476a90c9afcfe24d0968-9"&gt;&lt;/a&gt;&lt;span class="x"&gt;  user.username()   # 3. メソッド呼び出し&lt;/span&gt;
&lt;a name="rest_code_39fbfa0ba0c9476a90c9afcfe24d0968-10"&gt;&lt;/a&gt;&lt;span class="x"&gt;  user[username]    # 4. リストやタプルの添字指定&lt;/span&gt;
&lt;a name="rest_code_39fbfa0ba0c9476a90c9afcfe24d0968-11"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endcomment&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;テンプレートには「コンテキスト」と呼ばれる変数と値がマッピングされたオブジェクトが渡される&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;コンテキストに含まれるもの&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ビューから渡された変数&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;settings.py&lt;/code&gt; の &lt;code class="docutils literal"&gt;TEMPLATES.OPTIONS.context_processors&lt;/code&gt; に定義された関数でセットされた変数&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;request&lt;/code&gt;: リクエストオブジェクト&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;user&lt;/code&gt;: ユーザー&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;perms&lt;/code&gt;: ユーザーのパーミッション&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;messages&lt;/code&gt;: フラッシュメッセージ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;e.t.c...&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;何もしなくも XSS 対策として &lt;code class="docutils literal"&gt;&amp;lt;&lt;/code&gt;, &lt;code class="docutils literal"&gt;&amp;gt;&lt;/code&gt;, &lt;code class="docutils literal"&gt;'&lt;/code&gt;, &lt;code class="docutils literal"&gt;"&lt;/code&gt;, &lt;code class="docutils literal"&gt;&amp;amp;&lt;/code&gt; を自動でエスケープしてくれる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id25"&gt;フィルタ&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_0bc1013084124fdcbb5226b16ef578ba-1"&gt;&lt;/a&gt;&lt;span class="c"&gt;{# 変数名の直後に ``|`` (パイプ) を使って繋げる #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_0bc1013084124fdcbb5226b16ef578ba-2"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;変数名&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="err"&gt;|&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;フィルタ名&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_0bc1013084124fdcbb5226b16ef578ba-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_0bc1013084124fdcbb5226b16ef578ba-4"&gt;&lt;/a&gt;&lt;span class="c"&gt;{# フィルタによっては引数もとれる、 ``:`` で繋げる #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_0bc1013084124fdcbb5226b16ef578ba-5"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;変数名&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="err"&gt;|&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;フィルタ名&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="s2"&gt;:"&amp;lt;引数&amp;gt;"&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_0bc1013084124fdcbb5226b16ef578ba-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_0bc1013084124fdcbb5226b16ef578ba-7"&gt;&lt;/a&gt;&lt;span class="c"&gt;{# フィルタは ``|`` で連結できる #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_0bc1013084124fdcbb5226b16ef578ba-8"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;変数名&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="err"&gt;|&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;フィルタ名&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="s2"&gt;:"&amp;lt;引数&amp;gt;"&lt;/span&gt;&lt;span class="err"&gt;|&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;フィルタ名&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="s2"&gt;:"&amp;lt;引数&amp;gt;"&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id26"&gt;デフォルト表示&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_bdc3ff47bb5245e5927ffaddb69e0450-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;user.first_name&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nf"&gt;default&lt;/span&gt;&lt;span class="s2"&gt;:""&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;user.first_name&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nf"&gt;default&lt;/span&gt;&lt;span class="s2"&gt;:""&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;変数が存在しない場合、あるいは変数の値が &lt;code class="docutils literal"&gt;None&lt;/code&gt;, &lt;code class="docutils literal"&gt;''&lt;/code&gt;, &lt;code class="docutils literal"&gt;0&lt;/code&gt;, &lt;code class="docutils literal"&gt;False&lt;/code&gt;, &lt;code class="docutils literal"&gt;[]&lt;/code&gt; などの場合に指定した文字列を表示する&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id27"&gt;文字列長を表示&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_671429afea7b426ba6b43192d735c044-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;user.username&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nf"&gt;length&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id28"&gt;エスケープの無効化&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_18207cfae3e0498b9b71689b50dc176a-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.description&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nf"&gt;safe&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;XSS 対策として自動でエスケープしてくれる &lt;code class="docutils literal"&gt;&amp;lt;&lt;/code&gt;, &lt;code class="docutils literal"&gt;&amp;gt;&lt;/code&gt;, &lt;code class="docutils literal"&gt;'&lt;/code&gt;, &lt;code class="docutils literal"&gt;"&lt;/code&gt;, &lt;code class="docutils literal"&gt;&amp;amp;&lt;/code&gt; をエスケープしない&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;変数の内容が安全だとわかっている場合のみ利用すること&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id29"&gt;日時フォーマット&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_2965b57e41d94daba7e14e11fb65a8f5-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;user.last_login&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nf"&gt;date&lt;/span&gt;&lt;span class="s2"&gt;:"Y-m-d H:i:s"&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id30"&gt;改行タグの変換&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_ea3a7ef61a2d49368487981f339abab6-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.description&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nf"&gt;linebreaksbr&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;\n&lt;/code&gt; を &lt;code class="docutils literal"&gt;&amp;lt;br&amp;gt;&lt;/code&gt; に変換してくれる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;便利だな...&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id31"&gt;リンク変換&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_0863d13ab5f94da38c8768133a359ae6-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.description&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nf"&gt;urlize&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;URL と メールアドレスの部分だけをアンカータグで囲んでクリック可能なリンクに変換してくれる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;しゅごいな...&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id13"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id32"&gt;文字の切り詰め&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_c633c226703243f0b4840f29ff8de20b-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.description&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nf"&gt;truncatechars_html&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;指定した文字数まで切り詰めて &lt;code class="docutils literal"&gt;...&lt;/code&gt; をくっつけてくれる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;HTML タグを考慮して省略後の文字にきちんと閉じタグをつけてくれる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;うええ...&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id14"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id33"&gt;テンプレートタグ&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="if"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id34"&gt;if&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_367307b6e2ce4d7097359bb669c77ac9-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;user.is_superuser&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_367307b6e2ce4d7097359bb669c77ac9-2"&gt;&lt;/a&gt;&lt;span class="x"&gt;  システム管理者です。&lt;/span&gt;
&lt;a name="rest_code_367307b6e2ce4d7097359bb669c77ac9-3"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="nv"&gt;user.is_staff&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_367307b6e2ce4d7097359bb669c77ac9-4"&gt;&lt;/a&gt;&lt;span class="x"&gt;  スタッフです。&lt;/span&gt;
&lt;a name="rest_code_367307b6e2ce4d7097359bb669c77ac9-5"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_367307b6e2ce4d7097359bb669c77ac9-6"&gt;&lt;/a&gt;&lt;span class="x"&gt;  一般ユーザーだよ。&lt;/span&gt;
&lt;a name="rest_code_367307b6e2ce4d7097359bb669c77ac9-7"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="code django"&gt;&lt;a name="rest_code_3923b74a918f4c2792bc281656975db4-1"&gt;&lt;/a&gt;&lt;span class="c"&gt;{# フィルタと組み合わせることもできる #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_3923b74a918f4c2792bc281656975db4-2"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;user.username&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nf"&gt;length&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_3923b74a918f4c2792bc281656975db4-3"&gt;&lt;/a&gt;&lt;span class="x"&gt;  ユーザー名が短かすぎます。&lt;/span&gt;
&lt;a name="rest_code_3923b74a918f4c2792bc281656975db4-4"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt;  &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="for"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id35"&gt;for&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;book&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;book_list&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-2"&gt;&lt;/a&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.title&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-4"&gt;&lt;/a&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="c"&gt;{# for ループ内で使える変数 #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-5"&gt;&lt;/a&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nb"&gt;forloop&lt;/span&gt;&lt;span class="nv"&gt;.counter&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;     &lt;/span&gt;&lt;span class="c"&gt;{# 現在のループカウンタ番号 ( 1 から順にカウント ) #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-6"&gt;&lt;/a&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nb"&gt;forloop&lt;/span&gt;&lt;span class="nv"&gt;.counter0&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;    &lt;/span&gt;&lt;span class="c"&gt;{# 現在のループカウンタ番号 ( 0 から順にカウント ) #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-7"&gt;&lt;/a&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nb"&gt;forloop&lt;/span&gt;&lt;span class="nv"&gt;.revcounter&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="c"&gt;{# 現在のループカウンタ値 ( 1 から順に、末尾からカウント) #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-8"&gt;&lt;/a&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nb"&gt;forloop&lt;/span&gt;&lt;span class="nv"&gt;.revcounter0&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="c"&gt;{# 現在のループカウンタ値 ( 0 から順に、末尾からカウント) #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-9"&gt;&lt;/a&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nb"&gt;forloop&lt;/span&gt;&lt;span class="nv"&gt;.first&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;       &lt;/span&gt;&lt;span class="c"&gt;{# 最初のループであれば True #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-10"&gt;&lt;/a&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nb"&gt;forloop&lt;/span&gt;&lt;span class="nv"&gt;.last&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;        &lt;/span&gt;&lt;span class="c"&gt;{# 最後のループであれば True #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-11"&gt;&lt;/a&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nb"&gt;forloop&lt;/span&gt;&lt;span class="nv"&gt;.parentloop&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="c"&gt;{# 入れ子のループであるとき、現在のループを囲んでいる 1 つ上のループを表します。 #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-13"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt;  &lt;span class="k"&gt;empty&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-14"&gt;&lt;/a&gt;&lt;span class="x"&gt;  本ない&lt;/span&gt;
&lt;a name="rest_code_a145bd1eecb5482a9a7e9d280d5e2ade-15"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt;  &lt;span class="k"&gt;endfor&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id15"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id36"&gt;テンプレートの継承&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;親テンプレート &lt;code class="docutils literal"&gt;parent.html&lt;/code&gt;&lt;/p&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_84521827514c4474b37d424a5c1d0ebe-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;block&lt;/span&gt; &lt;span class="nv"&gt;sample&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;Hello &lt;/span&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endblock&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;子テンプレート &lt;code class="docutils literal"&gt;child.html&lt;/code&gt;&lt;/p&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_013f1a02d50649e68f9d0c11b45ad9fe-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;extends&lt;/span&gt; &lt;span class="s2"&gt;"parent.html"&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_013f1a02d50649e68f9d0c11b45ad9fe-2"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;block&lt;/span&gt; &lt;span class="nv"&gt;sample&lt;/span&gt; &lt;span class="cp"&gt;%}{{&lt;/span&gt; &lt;span class="nb"&gt;block&lt;/span&gt;&lt;span class="nv"&gt;.super&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="nv"&gt;World&lt;/span&gt;&lt;span class="err"&gt;!&lt;/span&gt; &lt;span class="o"&gt;{%&lt;/span&gt; &lt;span class="nv"&gt;endblock&lt;/span&gt; &lt;span class="o"&gt;%}&lt;/span&gt;
&lt;a name="rest_code_013f1a02d50649e68f9d0c11b45ad9fe-3"&gt;&lt;/a&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;block&lt;/span&gt;&lt;span class="nv"&gt;.super&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;親テンプレートのブロック内部の値をそのまま保持した変数&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id16"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id37"&gt;外部テンプレートの読み込み&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_7866cbe0bbf94590bf8fec9d359fc992-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;include&lt;/span&gt; &lt;span class="s2"&gt;"_message.html"&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;ヘッダーフッターなど部品化したテンプレートを別のテンプレートから読み込む場合など&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="url"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id38"&gt;静的ファイルの配信 URL 取得&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_79932e639b2b46eb9108f289d5cd76d3-1"&gt;&lt;/a&gt;&lt;span class="c"&gt;{# 利用する前に機能をロードしておく #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_79932e639b2b46eb9108f289d5cd76d3-2"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;load&lt;/span&gt; &lt;span class="nv"&gt;static&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_79932e639b2b46eb9108f289d5cd76d3-3"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="s2"&gt;"images/logo.png"&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_79932e639b2b46eb9108f289d5cd76d3-4"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="s2"&gt;"shop/images/no-image.png"&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;静的ファイルの配信 URL を取得するためのタグ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Django デフォルトで使える組み込みタグではないのでロードが必要&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;extends&lt;/code&gt; している場合、継承元で &lt;code class="docutils literal"&gt;load&lt;/code&gt; していても自身のテンプレートでは有効にならないので、
つど &lt;code class="docutils literal"&gt;load&lt;/code&gt; する必要がある&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id17"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id39"&gt;url&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_59e8c3f76e4e4b5dbf5da350e7fe6a7a-1"&gt;&lt;/a&gt;&lt;span class="c"&gt;{# URL 逆引き #}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_59e8c3f76e4e4b5dbf5da350e7fe6a7a-2"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;url&lt;/span&gt; &lt;span class="s2"&gt;"index"&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_59e8c3f76e4e4b5dbf5da350e7fe6a7a-3"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;url&lt;/span&gt; &lt;span class="s2"&gt;"accounts:login"&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_59e8c3f76e4e4b5dbf5da350e7fe6a7a-4"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;url&lt;/span&gt; &lt;span class="s2"&gt;"shop:detail"&lt;/span&gt; &lt;span class="nv"&gt;book.id&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_59e8c3f76e4e4b5dbf5da350e7fe6a7a-5"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;url&lt;/span&gt; &lt;span class="s2"&gt;"shop:detail"&lt;/span&gt; &lt;span class="nv"&gt;book_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;book.id&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id18"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id40"&gt;自動エスケープ制御&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code django"&gt;&lt;a name="rest_code_cfd73b5928d64779b78d101386df8938-1"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;autoescape&lt;/span&gt; &lt;span class="nv"&gt;off&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;a name="rest_code_cfd73b5928d64779b78d101386df8938-2"&gt;&lt;/a&gt;&lt;span class="x"&gt;  自動エスケープがオフになる範囲&lt;/span&gt;
&lt;a name="rest_code_cfd73b5928d64779b78d101386df8938-3"&gt;&lt;/a&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endautoescape&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id19"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id41"&gt;ベーステンプレートを用意しよう&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;現場で使える Django の教科書《基礎編》 P.79 参照のこと&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;どのテンプレートにも書くような共通の内容は base.html テンプレートする&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id20"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/template/#id42"&gt;独自のテンプレートタグとフィルタ&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;カスタムタグやカスタムフィルタをつくることができる。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/howto/custom-template-tags/"&gt;Django documentation &amp;gt; 独自のテンプレートタグとフィルタ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>django</category><guid>https://32imuf.com/django/template/</guid><pubDate>Sun, 05 May 2019 15:00:00 GMT</pubDate></item><item><title>Django: Model, Django ORM</title><link>https://32imuf.com/django/model/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="id1"&gt;
&lt;p class="topic-title first"&gt;目次&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#id2" id="id14"&gt;リファレンス&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#model" id="id15"&gt;Model&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#id3" id="id16"&gt;リレーションまとめ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#id4" id="id17"&gt;Model の実装例&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#on-delete" id="id18"&gt;on_delete&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#usermanager" id="id19"&gt;UserManager&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#django-orm" id="id20"&gt;Django ORM&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#id5" id="id21"&gt;1件だけ取得する&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#id6" id="id22"&gt;全件取得する&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#id7" id="id23"&gt;検索条件をつけて取得する&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#filter" id="id24"&gt;filter をつなげる例&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#and" id="id25"&gt;AND 条件&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#or" id="id26"&gt;OR 条件&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#id8" id="id27"&gt;&amp;gt;, &amp;lt;, &amp;gt;=, &amp;lt;=&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#in" id="id28"&gt;IN&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#like" id="id29"&gt;LIKE&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#exists" id="id30"&gt;EXISTS&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#order-by" id="id31"&gt;ORDER BY&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#q-object" id="id32"&gt;Q Object&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#id9" id="id33"&gt;リレーション先のモデルを使った条件検索&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#set" id="id34"&gt;モデルクラス名を全部小文字にしたのに &lt;code class="docutils literal"&gt;_set&lt;/code&gt; がつく&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#values-values-list" id="id35"&gt;values() と values_list()&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#values" id="id36"&gt;values()&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#values-list" id="id37"&gt;values_list()&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#aggregate-annotate" id="id38"&gt;aggregate と annotate&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#left-outer-join" id="id39"&gt;LEFT OUTER JOIN&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#select-related-prefetch-related" id="id40"&gt;select_related, prefetch_related&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#id11" id="id41"&gt;遅延評価&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#id12" id="id42"&gt;トランザクション&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#select-for-update" id="id43"&gt;select_for_update()&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#user" id="id44"&gt;User モデルを拡張したい&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/model/#id13" id="id45"&gt;発行されるクエリを見たい&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id14"&gt;リファレンス&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/models/fields/"&gt;Django documentation &amp;gt; モデルフィールドリファレンス&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/models/querysets/"&gt;Django documentation &amp;gt; QuerySet API reference&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://www.amazon.co.jp/dp/B07GK7BWB7/"&gt;現場で使える Django の教科書&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="model"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id15"&gt;Model&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;複合キーは主キーにできない&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id16"&gt;リレーションまとめ&lt;/a&gt;&lt;/h3&gt;
&lt;table class="colwidths-auto"&gt;
&lt;thead&gt;
&lt;tr&gt;&lt;th class="head stub"&gt;&lt;p&gt;リレーション&lt;/p&gt;&lt;/th&gt;
&lt;th class="head"&gt;&lt;p&gt;使うフィールド&lt;/p&gt;&lt;/th&gt;
&lt;th class="head"&gt;&lt;p&gt;使い方&lt;/p&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;th class="stub"&gt;&lt;p&gt;一対一&lt;/p&gt;&lt;/th&gt;
&lt;td&gt;&lt;p&gt;OneToOneField&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;どちらか一方のモデルに OneToOneField をくっつける&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;th class="stub"&gt;&lt;p&gt;多対一&lt;/p&gt;&lt;/th&gt;
&lt;td&gt;&lt;p&gt;ForeignKey&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;多側に ForeignKey をくっつける&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;th class="stub"&gt;&lt;p&gt;多対多&lt;/p&gt;&lt;/th&gt;
&lt;td&gt;&lt;p&gt;ManyToManyField&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;どちらか一方のモデルに ManyToManyField をくっつける&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id17"&gt;Model の実装例&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Publisher&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-5"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""出版社モデル"""&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;db_table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'publisher'&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-8"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;verbose_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'出版社名'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-10"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__str__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-14"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Author&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-16"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""著者モデル"""&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-17"&gt;&lt;/a&gt;    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-18"&gt;&lt;/a&gt;        &lt;span class="n"&gt;db_table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'author'&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-19"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-20"&gt;&lt;/a&gt;    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;verbose_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'著者名'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-21"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-22"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__str__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-23"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-24"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-25"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-26"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Book&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-27"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""本モデル"""&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-28"&gt;&lt;/a&gt;    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-29"&gt;&lt;/a&gt;        &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-30"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        対応するテーブルや、複数カラムに対するインデックスやユニーク制約などの&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-31"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        モデル全体に対する付加情報を記述する&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-32"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        """&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-33"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# テーブル名を定義&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-34"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# 定義しないと、 `アプリケーション名_モデルのクラス名をスネークケースにした文字列` がテーブル名になる&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-35"&gt;&lt;/a&gt;        &lt;span class="n"&gt;db_table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'book'&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-36"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-37"&gt;&lt;/a&gt;    &lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-38"&gt;&lt;/a&gt;        &lt;span class="n"&gt;verbose_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'タイトル'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# フィールド名&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-39"&gt;&lt;/a&gt;        &lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# 文字列の最大文字数&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-40"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# choices: フォーム利用時にセレクトボックスに表示する選択肢&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-41"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# validators: 文字種チェックなどのバリデーションを指定&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-42"&gt;&lt;/a&gt;        &lt;span class="n"&gt;error_messages&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'invalid'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'title ちがうよー'&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;  &lt;span class="c1"&gt;# バリデーションNGの場合のエラーメッセージ&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-43"&gt;&lt;/a&gt;    &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-44"&gt;&lt;/a&gt;    &lt;span class="n"&gt;publisher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ForeignKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-45"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# 多対一のリレーション: 多側に ForeignKey をくっつける&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-46"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Publisher&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;verbose_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'出版社'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-47"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# ForeignKey と OneToOneField には on_delete をつける癖をつけよう&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-48"&gt;&lt;/a&gt;        &lt;span class="n"&gt;on_delete&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PROTECT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# 自身のレコードは削除されない&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-49"&gt;&lt;/a&gt;    &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-50"&gt;&lt;/a&gt;    &lt;span class="n"&gt;authors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ManyToManyField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-51"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# 多対多のリレーション: 一方のモデルに ManyToManyField をくっつける&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-52"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#   * マイグレーション実行すると Django が自動的に中間テーブルを作成してくれる&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-53"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Author&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;verbose_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'著者'&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-54"&gt;&lt;/a&gt;    &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-55"&gt;&lt;/a&gt;    &lt;span class="n"&gt;price&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;IntegerField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-56"&gt;&lt;/a&gt;        &lt;span class="n"&gt;verbose_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'価格'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-57"&gt;&lt;/a&gt;        &lt;span class="n"&gt;null&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;       &lt;span class="c1"&gt;# NULL制約&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-58"&gt;&lt;/a&gt;        &lt;span class="n"&gt;unique&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;    &lt;span class="c1"&gt;# ユニーク制約&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-59"&gt;&lt;/a&gt;        &lt;span class="n"&gt;blank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;      &lt;span class="c1"&gt;# フォーム利用時に入力必須にするかどうか&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-60"&gt;&lt;/a&gt;        &lt;span class="n"&gt;db_index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# DB のインデックスを設定するかどうか&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-61"&gt;&lt;/a&gt;        &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;       &lt;span class="c1"&gt;# レコード登録時に値が指定されなかったときのデフォルト値&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-62"&gt;&lt;/a&gt;    &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-63"&gt;&lt;/a&gt;    &lt;span class="n"&gt;description&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TextField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;verbose_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'概要'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;null&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-64"&gt;&lt;/a&gt;    &lt;span class="n"&gt;publisher_date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;verbose_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'出版日'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-65"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-66"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__str__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-67"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# 管理サイトに表示されるよ&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-68"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-69"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-70"&gt;&lt;/a&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-71"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BookStock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-72"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""本の在庫モデル"""&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-73"&gt;&lt;/a&gt;    &lt;span class="n"&gt;book&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;OneToOneField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-74"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# 一対一のリレーション: どちらか一方のテーブルに OneToOneField をくっつける&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-75"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;verbose_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'本'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-76"&gt;&lt;/a&gt;        &lt;span class="n"&gt;on_delete&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CASCADE&lt;/span&gt;  &lt;span class="c1"&gt;# 自身のレコードも削除される&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-77"&gt;&lt;/a&gt;    &lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_fb261896723a481ab69c43039f08f61a-78"&gt;&lt;/a&gt;    &lt;span class="n"&gt;quantity&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;IntegerField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;verbose_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'在庫数'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="on-delete"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id18"&gt;on_delete&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/models/fields/#django.db.models.ForeignKey.on_delete"&gt;ForeignKey.on_delete&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;6種類くらいあって、用途に応じて選べる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Django 2.0 から、必須の引数となる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;それ以前のバージョンでは、デフォルトで &lt;code class="docutils literal"&gt;CASCADE&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="usermanager"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id19"&gt;UserManager&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/contrib/auth/#manager-methods"&gt;Django documentation &amp;gt; django.contrib.auth &amp;gt; マネージャメソッド&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/topics/auth/customizing/#a-full-example"&gt;Django documentation &amp;gt; Django の認証方法のカスタマイズ &amp;gt; 完全な具体例&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://github.com/django/django/blob/master/django/contrib/auth/models.py#L131"&gt;https://github.com/django/django/blob/master/django/contrib/auth/models.py#L131&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;こうすると登録できる&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_b25b8742eba3452e8692a0d0190a9637-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;objects&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MyUserManager&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;TODO: これは Model のところじゃなくて、認証のところかもしれない。いったんここに置いておく。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="django-orm"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id20"&gt;Django ORM&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;単体のオブジェクトを保存・更新するような行レベルのクエリ操作: モデルオブジェクトのメソッドを利用する&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;データベースのテーブルレベルのクエリ操作: モデルの「モデルマネージャー」 ( &lt;code class="docutils literal"&gt;objects&lt;/code&gt; ) を経由してクエリセットAPI のメソッドを利用する&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;モデルマネージャーは通常、モデルクラスに &lt;code class="docutils literal"&gt;objects&lt;/code&gt; という名前で保存されている&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id21"&gt;1件だけ取得する&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_5a5a4c3e95824b54878b0a42ff19068c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  &lt;span class="c1"&gt;# この `objects` がモデルマネージャー&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;モデルが返る&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;1件も見つからないと &lt;code class="docutils literal"&gt;DoesNotExist&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;2件以上見つかると &lt;code class="docutils literal"&gt;MultipleObjectsReturn&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id22"&gt;全件取得する&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_8e6af0248ad84e609d1c4d7e199bc1c2-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;即座にデータベースにはアクセスせず、クエリセットオブジェクトを返す&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;しかるべきタイミングでデータベースアクセスする = 遅延評価&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;1件も見つからなくても例外発生しない、空のリストを返す&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id23"&gt;検索条件をつけて取得する&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_d2b3e5e02b32402398c8eeabfda9eca1-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;is_active&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;即座にデータベースにはアクセスせず、クエリセットオブジェクトを返す&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;filter()&lt;/code&gt; を何度も繋げて書ける&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="filter"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id24"&gt;filter をつなげる例&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_0b2203f25f874297987f4d8743083b03-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;keyword&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'keyword'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_0b2203f25f874297987f4d8743083b03-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;queryset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_0b2203f25f874297987f4d8743083b03-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;keyword&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_0b2203f25f874297987f4d8743083b03-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;queryset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;queryset&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;keyword&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_0b2203f25f874297987f4d8743083b03-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_0b2203f25f874297987f4d8743083b03-6"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# ここでクエリが発行される (print すると発行される)&lt;/span&gt;
&lt;a name="rest_code_0b2203f25f874297987f4d8743083b03-7"&gt;&lt;/a&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;queryset&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;この例の場合、発行されるクエリの総数は1本&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="and"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id25"&gt;AND 条件&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_871f88f45cdb4d4887592b2768529ae7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'Django Book'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;検索条件を列挙すれば AND 条件&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="or"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id26"&gt;OR 条件&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_d15e38eb5f904816ad7d0f05c71ada3e-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Q&lt;/span&gt;
&lt;a name="rest_code_d15e38eb5f904816ad7d0f05c71ada3e-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Q&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'Django Book'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Q&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;Q&lt;/code&gt; と &lt;code class="docutils literal"&gt;|&lt;/code&gt; (パイプ) を使う&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id27"&gt;&amp;gt;, &amp;lt;, &amp;gt;=, &amp;lt;=&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_def4289b80dd44458a48ae2d1ea8bdb9-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;price__gt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# &amp;gt;1000&lt;/span&gt;
&lt;a name="rest_code_def4289b80dd44458a48ae2d1ea8bdb9-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;price__lt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# &amp;lt;1000&lt;/span&gt;
&lt;a name="rest_code_def4289b80dd44458a48ae2d1ea8bdb9-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;price__gte&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# &amp;gt;=1000&lt;/span&gt;
&lt;a name="rest_code_def4289b80dd44458a48ae2d1ea8bdb9-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;price__lte&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# &amp;lt;=1000&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;__&lt;/code&gt; (アンダーバー2つ) でフィールド名とキーワード (&lt;code class="docutils literal"&gt;gt&lt;/code&gt;, &lt;code class="docutils literal"&gt;lt&lt;/code&gt;, &lt;code class="docutils literal"&gt;gte&lt;/code&gt;, &lt;code class="docutils literal"&gt;lte&lt;/code&gt;) をつなぐ&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="in"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id28"&gt;IN&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_15fe308598534f0d80d654c8e838f170-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;price__in&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;900&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;  &lt;span class="c1"&gt;# IN(900, 1000)&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;__&lt;/code&gt; (アンダーバー2つ) でフィールド名とキーワード (&lt;code class="docutils literal"&gt;in&lt;/code&gt;) をつなぐ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;IN 句の中身はリストで書く&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="like"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id29"&gt;LIKE&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_475790c5e8ae45ea9d296ff1dadfe92b-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;title__icontains&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'Django'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# ILIKE '%Django%'&lt;/span&gt;
&lt;a name="rest_code_475790c5e8ae45ea9d296ff1dadfe92b-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;title__contains&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'Django'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# LIKE '%Django%'&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;__&lt;/code&gt; (アンダーバー2つ) でフィールド名とキーワード (&lt;code class="docutils literal"&gt;icontains&lt;/code&gt;, &lt;code class="docutils literal"&gt;contains&lt;/code&gt;) をつなぐ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;大文字と小文字を区別しない: &lt;code class="docutils literal"&gt;icontains&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;大文字と小文字を区別する: &lt;code class="docutils literal"&gt;contains&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="exists"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id30"&gt;EXISTS&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;exists: レコードが存在するか否か True/False で返す&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_1272342051c7461b8b58576a1a1adff0-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_1272342051c7461b8b58576a1a1adff0-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;title__icontains&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'Django'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="order-by"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id31"&gt;ORDER BY&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;order_by:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_29c5f1fd7e82484ebe9f56826a7f08be-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 降順はフィールド名の前に ``-`` つける&lt;/span&gt;
&lt;a name="rest_code_29c5f1fd7e82484ebe9f56826a7f08be-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;order_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'-price'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_29c5f1fd7e82484ebe9f56826a7f08be-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_29c5f1fd7e82484ebe9f56826a7f08be-4"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 複数フィールドでソートするときはカンマ区切り&lt;/span&gt;
&lt;a name="rest_code_29c5f1fd7e82484ebe9f56826a7f08be-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;order_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'price'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'publish_date'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="q-object"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id32"&gt;Q Object&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/topics/db/queries/#complex-lookups-with-q"&gt;Q オブジェクトを用いた複雑な検索&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id33"&gt;リレーション先のモデルを使った条件検索&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_968d12f04dca40a1bb7fb5c6bcb06793-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;publisher__name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'自費出版社'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;OneToOneField&lt;/code&gt;, &lt;code class="docutils literal"&gt;ForeignKey&lt;/code&gt;, &lt;code class="docutils literal"&gt;ManyToManyField&lt;/code&gt; でリレーションしていると、
&lt;code class="docutils literal"&gt;リレーションつけたフィールド名__リレーション先モデルのフィールド名&lt;/code&gt; で JOIN できる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="set"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id34"&gt;モデルクラス名を全部小文字にしたのに &lt;code class="docutils literal"&gt;_set&lt;/code&gt; がつく&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/1.11/ref/models/relations/"&gt;Related objects reference&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;_set&lt;/code&gt; というのは子テーブルのデータを参照する django の機能&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;モデルクラス名を全部小文字にしたのに &lt;code class="docutils literal"&gt;_set&lt;/code&gt; がつく&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="values-values-list"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id35"&gt;values() と values_list()&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="values"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id36"&gt;values()&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;辞書のクエリセットで取得できる。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.1/ref/models/querysets/#values"&gt;https://docs.djangoproject.com/ja/2.1/ref/models/querysets/#values&lt;/a&gt;&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_6a02f89d74934fc793f0abcd862eadcb-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Blog&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name__startswith&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'Beatles'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_6a02f89d74934fc793f0abcd862eadcb-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;QuerySet&lt;/span&gt; &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="s1"&gt;'id'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'name'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'Beatles Blog'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'tagline'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'All the latest Beatles news.'&lt;/span&gt;&lt;span class="p"&gt;}]&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="values-list"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id37"&gt;values_list()&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;タプルのリストのクエリセットで取得できる。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.1/ref/models/querysets/#values-list"&gt;https://docs.djangoproject.com/ja/2.1/ref/models/querysets/#values-list&lt;/a&gt;&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_326263edfb214c798d4e7e6d9bbdf596-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Entry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values_list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'id'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'headline'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_326263edfb214c798d4e7e6d9bbdf596-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;QuerySet&lt;/span&gt; &lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'First entry'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;1カラムしか取得しない場合は、 &lt;code class="docutils literal"&gt;flat=True&lt;/code&gt; をつけると、リストのクエリセットで取得できる。&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_3b6f3f2978424aaba9e45561ef204ac1-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Entry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values_list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'id'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;flat&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;order_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'id'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_3b6f3f2978424aaba9e45561ef204ac1-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;QuerySet&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="aggregate-annotate"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id38"&gt;aggregate と annotate&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;aggregate&lt;/code&gt; と &lt;code class="docutils literal"&gt;annotate&lt;/code&gt; の違いがわかりやすい&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="http://note.crohaco.net/2014/django-aggregate/"&gt;Djangoの集計について&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="left-outer-join"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id39"&gt;LEFT OUTER JOIN&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Django のクエリセットは LEFT OUTER JOIN を表現できない&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;SQLAlchemy でやろう&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="select-related-prefetch-related"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id40"&gt;select_related, prefetch_related&lt;/a&gt;&lt;/h3&gt;
&lt;table class="colwidths-given"&gt;
&lt;colgroup&gt;
&lt;col style="width: 50%"&gt;
&lt;col style="width: 50%"&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr&gt;&lt;th class="head"&gt;&lt;p&gt;select_related&lt;/p&gt;&lt;/th&gt;
&lt;th class="head"&gt;&lt;p&gt;prefetch_related&lt;/p&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;一&lt;/code&gt; や &lt;code class="docutils literal"&gt;多&lt;/code&gt; 側から &lt;code class="docutils literal"&gt;一&lt;/code&gt; のリレーションのモデルオブジェクトをJOINで取得&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;一&lt;/code&gt; や &lt;code class="docutils literal"&gt;多&lt;/code&gt; 側から &lt;code class="docutils literal"&gt;多&lt;/code&gt; のリレーションのモデルオブジェクトを取得してキャッシュに保持&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;リレーション先のオブジェクトを取得するために JOIN を使ったクエリを発行できる&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;取得したオブジェクト群をオブジェクト内部のキャッシュに保持し、それを使い回すことで同じクエリが何度も発行されないようにする&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;pre class="code python"&gt;&lt;a name="rest_code_473a7fc035a6404b8b135b576e6ed05a-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;select_related&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'publisher'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td&gt;&lt;pre class="code python"&gt;&lt;a name="rest_code_cb0d12d657d349a48ef5b7e3aa276c89-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;prefetch_related&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'authors'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;クエリの本数を減らそう!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;N+1問題&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;特にリレーションを持ったモデルの検索結果 (クエリセットオブジェクト) をループ処理する場合に起こりがち&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;後続の処理で何度もアクセスされそうなオブジェクトに対して前もって処理を施しておくことでクエリの本数を減らそう&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;その他参考: &lt;a class="reference external" href="http://tokibito.hatenablog.com/entry/20140718/1405691738"&gt;偏った言語信者の垂れ流し &amp;gt; Djangoでprefetch_relatedを使ってクエリ数を減らす&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id41"&gt;遅延評価&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;クエリセットを返す &lt;code class="docutils literal"&gt;all()&lt;/code&gt; や &lt;code class="docutils literal"&gt;filter()&lt;/code&gt; がクエリを発行するタイミング (データベースアクセスするタイミング) はこれら&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;for&lt;/code&gt; ループなどイテレーションが開始されたタイミング&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;[]&lt;/code&gt; を使ってスライスしたタイミング&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;[0:5]&lt;/code&gt; のように範囲指定するとクエリは即時発行されない&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;オブジェクトを直列化したタイミング&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;オブジェクトを &lt;code class="docutils literal"&gt;REPL&lt;/code&gt; や &lt;code class="docutils literal"&gt;print()&lt;/code&gt; で表示したタイミング&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;len()&lt;/code&gt; でサイズを取得したタイミング&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;list()&lt;/code&gt; で強制的にリストに変換したタイミング&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;bool()&lt;/code&gt; で強制的に &lt;code class="docutils literal"&gt;Boolean&lt;/code&gt; に変換したタイミング&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id42"&gt;トランザクション&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;デフォルト設定では、オブジェクトの保存・更新・削除は即時反映 (実行した時点でデータベースに反映される)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;トランザクションの範囲指定する場合は、&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_d3f22088b49e45efb3620ab55cd9ca62-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;transaction&lt;/span&gt;
&lt;a name="rest_code_d3f22088b49e45efb3620ab55cd9ca62-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;transaction&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;atomic&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_d3f22088b49e45efb3620ab55cd9ca62-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'fumi23'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_d3f22088b49e45efb3620ab55cd9ca62-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'fumi23'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;トランザクションのデフォルト設定を変更できる&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;settings.py&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_23e4db531c0e431d87bb1692482880ca-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;DATABASES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
&lt;a name="rest_code_23e4db531c0e431d87bb1692482880ca-2"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'default'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_23e4db531c0e431d87bb1692482880ca-3"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# リクエストの開始から終了までに設定&lt;/span&gt;
&lt;a name="rest_code_23e4db531c0e431d87bb1692482880ca-4"&gt;&lt;/a&gt;        &lt;span class="s1"&gt;'ATOMIC_REQUESTS'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_23e4db531c0e431d87bb1692482880ca-5"&gt;&lt;/a&gt;    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_23e4db531c0e431d87bb1692482880ca-6"&gt;&lt;/a&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="select-for-update"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id43"&gt;select_for_update()&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/models/querysets/#django.db.models.query.QuerySet.select_for_update"&gt;https://docs.djangoproject.com/ja/2.2/ref/models/querysets/#django.db.models.query.QuerySet.select_for_update&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;select_for_update&lt;/code&gt; は &lt;code class="docutils literal"&gt;transaction.atomic&lt;/code&gt; ブロック内で使いましょう&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;自動コミットモードでクエリセットを評価すると、行ロックされないため &lt;code class="docutils literal"&gt;TransactionManagementError&lt;/code&gt; が発生します&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;select_for_update&lt;/code&gt; のタイムアウトエラー (他のトランザクションにロックがとられていて待ち時間内にロックが取得できなかった) は &lt;code class="docutils literal"&gt;OperationalError&lt;/code&gt; が発生しますが、キャッチするのはその親の &lt;code class="docutils literal"&gt;DatabaseError&lt;/code&gt; にしましょう&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MySQL の場合、 &lt;code class="docutils literal"&gt;nowait&lt;/code&gt; および &lt;code class="docutils literal"&gt;skip_locked&lt;/code&gt; 引数は MySQL 8.0.1+ でのみサポートされています。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="user"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id44"&gt;User モデルを拡張したい&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;現場で使える Django の教科書《基礎編》 P.63 参照のこと&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id13"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/model/#id45"&gt;発行されるクエリを見たい&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Django シェル&lt;/p&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_7a11fd16a8f4402db07369312f9b650a-1"&gt;&lt;/a&gt;$ python manage.py shell --settings&lt;span class="o"&gt;=&lt;/span&gt;settings._
&lt;a name="rest_code_7a11fd16a8f4402db07369312f9b650a-2"&gt;&lt;/a&gt;&amp;gt;&amp;gt;&amp;gt; print&lt;span class="o"&gt;(&lt;/span&gt;Book.objects.filter&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;title__icontains&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'Django'&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;.query&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ロギング&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;django-debug-toolbar&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>django</category><guid>https://32imuf.com/django/model/</guid><pubDate>Sat, 04 May 2019 15:00:00 GMT</pubDate></item><item><title>Django: URL ディスパッチャ, URLconf</title><link>https://32imuf.com/django/urlconf/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="id1"&gt;
&lt;p class="topic-title first"&gt;目次&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/urlconf/#id2" id="id4"&gt;書籍/リファレンス&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/urlconf/#url" id="id5"&gt;URL ディスパッチャ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/urlconf/#urlconf" id="id6"&gt;URLconf&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/urlconf/#id3" id="id7"&gt;書き方&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/urlconf/#id4"&gt;書籍/リファレンス&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://www.amazon.co.jp/dp/B07GK7BWB7/"&gt;現場で使える Django の教科書&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/en/2.2/topics/http/urls/"&gt;Django documentation &amp;gt; URL ディスパッチャ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="url"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/urlconf/#id5"&gt;URL ディスパッチャ&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;例外のハンドリングもしてくれる&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;マッチするURLが見つからなかった場合は &lt;code class="docutils literal"&gt;handler404&lt;/code&gt; -&amp;gt; &lt;code class="docutils literal"&gt;404.html&lt;/code&gt; を返してくれたりする&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="urlconf"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/urlconf/#id6"&gt;URLconf&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;urlpatterns&lt;/code&gt; にリストで書く&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/urlconf/#id7"&gt;書き方&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;config/urls.py&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_985de5af764a49b9bef26feb075aface-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
&lt;a name="rest_code_985de5af764a49b9bef26feb075aface-2"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# Django2.0 から path になった&lt;/span&gt;
&lt;a name="rest_code_985de5af764a49b9bef26feb075aface-3"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# 後ろには / つける、前にはつけないのが慣習&lt;/span&gt;
&lt;a name="rest_code_985de5af764a49b9bef26feb075aface-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'admin/'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;admin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;site&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urls&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a name="rest_code_985de5af764a49b9bef26feb075aface-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;''&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'index'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a name="rest_code_985de5af764a49b9bef26feb075aface-6"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# アプリケーションディレクトリごとに１つずつ urls.py を配置するのがベストプラクティス&lt;/span&gt;
&lt;a name="rest_code_985de5af764a49b9bef26feb075aface-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'accounts/'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'accounts.urls'&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;  &lt;span class="c1"&gt;# /accounts/ で始まるURLパターンは accounts.urls 見てね&lt;/span&gt;
&lt;a name="rest_code_985de5af764a49b9bef26feb075aface-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'shop/'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'shop.urls'&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;          &lt;span class="c1"&gt;# /shop/ で始まるURLパターンは shop.urls 見てね&lt;/span&gt;
&lt;a name="rest_code_985de5af764a49b9bef26feb075aface-9"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# GenericView: 短いので、URLconf に直接書くこともある&lt;/span&gt;
&lt;a name="rest_code_985de5af764a49b9bef26feb075aface-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;'^$'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TemplateView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;template_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'index.html'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'index'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;  &lt;span class="c1"&gt;# TemplateView&lt;/span&gt;
&lt;a name="rest_code_985de5af764a49b9bef26feb075aface-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;'^$'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;RedirectView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;template_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'index.html'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'index'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;  &lt;span class="c1"&gt;# RedirectView&lt;/span&gt;
&lt;a name="rest_code_985de5af764a49b9bef26feb075aface-12"&gt;&lt;/a&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;shop/urls.py&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_c13e9ca4e95e47e6b2e6ae66ab03ee85-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# app_name:&lt;/span&gt;
&lt;a name="rest_code_c13e9ca4e95e47e6b2e6ae66ab03ee85-2"&gt;&lt;/a&gt;  &lt;span class="c1"&gt;# * 必ず設定する、アプリケーション名と同じにする&lt;/span&gt;
&lt;a name="rest_code_c13e9ca4e95e47e6b2e6ae66ab03ee85-3"&gt;&lt;/a&gt;  &lt;span class="c1"&gt;# * reverse メソッドや url タグから `名前空間名.名前空間内の name&amp;gt;` で逆引きできるようにするため&lt;/span&gt;
&lt;a name="rest_code_c13e9ca4e95e47e6b2e6ae66ab03ee85-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;app_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'shop'&lt;/span&gt;
&lt;a name="rest_code_c13e9ca4e95e47e6b2e6ae66ab03ee85-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
&lt;a name="rest_code_c13e9ca4e95e47e6b2e6ae66ab03ee85-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;''&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'index'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a name="rest_code_c13e9ca4e95e47e6b2e6ae66ab03ee85-7"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# パスコンバーター:&lt;/span&gt;
&lt;a name="rest_code_c13e9ca4e95e47e6b2e6ae66ab03ee85-8"&gt;&lt;/a&gt;      &lt;span class="c1"&gt;# * ビュー関数を呼び出すときのキーワード引数として使われる&lt;/span&gt;
&lt;a name="rest_code_c13e9ca4e95e47e6b2e6ae66ab03ee85-9"&gt;&lt;/a&gt;      &lt;span class="c1"&gt;# * int, str, path, slug, uuid の 5種類がある、自作も可&lt;/span&gt;
&lt;a name="rest_code_c13e9ca4e95e47e6b2e6ae66ab03ee85-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'&amp;lt;int:book_id&amp;gt;/'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;detail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'detail'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;a name="rest_code_c13e9ca4e95e47e6b2e6ae66ab03ee85-11"&gt;&lt;/a&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>django</category><guid>https://32imuf.com/django/urlconf/</guid><pubDate>Sat, 04 May 2019 15:00:00 GMT</pubDate></item><item><title>Django: View</title><link>https://32imuf.com/django/view/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="id1"&gt;
&lt;p class="topic-title first"&gt;目次&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#id2" id="id7"&gt;リファレンス/書籍&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#id4" id="id8"&gt;関数ベースのビュー&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#class-based-views" id="id9"&gt;クラスベースのビュー (Class-based views)&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#as-view" id="id10"&gt;as_view&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#base-views" id="id11"&gt;Base views&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#view" id="id12"&gt;View&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#templateview" id="id13"&gt;TemplateView&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#get-context-data" id="id14"&gt;get_context_data&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#redirectview" id="id15"&gt;RedirectView&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#generic-views" id="id16"&gt;いろいろな Generic views&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#listview" id="id17"&gt;ListView&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#formview" id="id18"&gt;FormView&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#id5" id="id19"&gt;ログイン・ログアウト&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#loginview-logoutview" id="id20"&gt;LoginView, LogoutView&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/django/view/#loginrequiredmixin" id="id21"&gt;LoginRequiredMixin&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id7"&gt;リファレンス/書籍&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/topics/class-based-views/"&gt;Django documentation &amp;gt; クラスベースビュー&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/class-based-views/"&gt;Django documentation &amp;gt; ビルトインのクラスベースビュー API&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://www.amazon.co.jp/dp/B07GK7BWB7/"&gt;現場で使える Django の教科書&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="http://note.crohaco.net/2015/django-genericview/"&gt;くろのて &amp;gt; [Django]ジェネリックビューってなんなんだよ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;crohaco さん、 shimizukawa さん、 tell-k さん&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id8"&gt;関数ベースのビュー&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;第一引数に django.http.request.HttpRequest を受け取る&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;戻り値に django.http.response.HttpResponse を返す&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.shortcuts&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;render&lt;/span&gt;
&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;HelloView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-5"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""関数ベースのビュー"""&lt;/span&gt;
&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;'GET'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-8"&gt;&lt;/a&gt;            &lt;span class="s1"&gt;'message'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Hello World!"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-9"&gt;&lt;/a&gt;        &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-10"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# render:&lt;/span&gt;
&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-11"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#   * HttpResponse を作ってくれる&lt;/span&gt;
&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-12"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#   * テンプレートをレンダリングするとき使う&lt;/span&gt;
&lt;a name="rest_code_abb5b0166b7642d6bfdeffc01535ee76-13"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'hello.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="class-based-views"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id9"&gt;クラスベースのビュー (Class-based views)&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;関数形式の view はコンテキスト、テンプレート、フォーム、全部変えしてあげないといけなかった。つまり全部関数内に書く必要があった。
必要なものを切り離して属性として定義できるようにしたのが genericview (class based view)。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;akiyoko さんは断然、クラスベースビューをお勧めするとのこと&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;汎用ビュー (Generic View) としてさまざまな用途のクラスが提供されているのでその恩恵を受けられる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;すべての基本となる基本汎用ビュー &lt;code class="docutils literal"&gt;django.views.generic.base.View&lt;/code&gt; を利用すれば見通しのよいビューが書けるし、応用も効く&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;汎用ビューのほかにも便利な Mixin クラスを多重継承してお決まりの処理を再利用できる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.shortcuts&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;render&lt;/span&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;View&lt;/span&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# from django.views.generic import View と同義↑&lt;/span&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HelloView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;View&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-7"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""クラスベースのビュー"""&lt;/span&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-9"&gt;&lt;/a&gt;        &lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-10"&gt;&lt;/a&gt;            &lt;span class="s1"&gt;'message'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Hello World!"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-11"&gt;&lt;/a&gt;        &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'hello.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-14"&gt;&lt;/a&gt;
&lt;a name="rest_code_bb65fd3f124841fa938076b0ae95071d-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;hello&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HelloView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="code python"&gt;&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib.auth&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;login&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;auth_login&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.shortcuts&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;redirect&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.urls&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;View&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-7"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;LoginView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;View&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-9"&gt;&lt;/a&gt;        &lt;span class="sd"&gt;"""GET リクエスト"""&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-11"&gt;&lt;/a&gt;            &lt;span class="s1"&gt;'form'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;LoginForm&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-12"&gt;&lt;/a&gt;        &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-13"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# ログイン画面用のテンプレートに値が空のフォームをレンダリング&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-14"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# render: テンプレートをレンダリングするとき使う&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'accounts/login.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-16"&gt;&lt;/a&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-17"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-18"&gt;&lt;/a&gt;        &lt;span class="sd"&gt;"""POST リクエスト"""&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-19"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# リクエストからフォームを作成&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-20"&gt;&lt;/a&gt;        &lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LoginForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;POST&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-21"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# バリデーション (ユーザーの認証も併せて実施)&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-22"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_valid&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-23"&gt;&lt;/a&gt;            &lt;span class="c1"&gt;# バリデーション NG の場合はログイン画面のテンプレートを再表示&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-24"&gt;&lt;/a&gt;            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'accounts/login.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'form'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-25"&gt;&lt;/a&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-26"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# User オブジェクトをフォームから取得&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-27"&gt;&lt;/a&gt;        &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_user&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-28"&gt;&lt;/a&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-29"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# ログイン処理 (取得した User オブジェクトをセッションに保存 &amp;amp; User データを更新)&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-30"&gt;&lt;/a&gt;        &lt;span class="n"&gt;auth_login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-31"&gt;&lt;/a&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-32"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# ショップ画面にリダイレクト&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-33"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# redirect: リダイレクトするとき使う&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-34"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#   * リダイレクト先のURLは reverse を使って取得する&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-35"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#   * ハードコーディングするなかれ&lt;/span&gt;
&lt;a name="rest_code_dd6cc408ee8f4a5784821bcea2bc97da-36"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;redirect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'shop:index'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;div class="section" id="as-view"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id10"&gt;as_view&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://github.com/django/django/blob/master/django/views/generic/base.py#L49"&gt;https://github.com/django/django/blob/master/django/views/generic/base.py#L49&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;クラスベースのビューをビュー関数化してくれるメソッド&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;as_view は view 関数を生成して返している&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;これをしておくと、URL ディスパッチャだけでなく他のビューからも呼び出せるようになる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;実際の処理は self.dispatch で クラスベースビューに処理を委譲してるんだと思います&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;urls.py で as_view せずに、 views.py で as_view した Class-based view をグローバル変数に代入するとうれしいタイミング&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;同じ view を複数の url に設定したい&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;モジュールの import が1回しか発生しないのはモジュール毎の話じゃなくプロセス全体 ( Django で言うと &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;runserver...&lt;/span&gt;&lt;/code&gt; した単位) の話&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;url ごとに同じ View を何回も生成するんだったら、同じでよい (シングルトン)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="base-views"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id11"&gt;Base views&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="view"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id12"&gt;View&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;django.views.generic.base.View&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;すべての元となるクラスベースビューです。他の全てのクラスベースビューは、この基本クラスを継承しています。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="templateview"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id13"&gt;TemplateView&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;テンプレートを表示することに特化した Generic View&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;トップ画面やヘルプ画面などの単純なテンプレートを表示するのによく使う&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;オーバーライドできる変数やメソッドがいくつか用意されていて、デフォルトの挙動をある程度自由に変更できる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views.generic&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TemplateView&lt;/span&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib.auth.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;IndexView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TemplateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;template_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'index.html'&lt;/span&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-9"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# get_context_data をオーバーライドした例&lt;/span&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-10"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# テンプレートに渡すコンテキストに任意の変数を追加できる&lt;/span&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IndexView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-12"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# テンプレートに渡すコンテキストに `user_count` という変数を追加&lt;/span&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'user_count'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-14"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-15"&gt;&lt;/a&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-16"&gt;&lt;/a&gt;
&lt;a name="rest_code_7bd2bb3e4159407f832dede327394292-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;IndexView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;div class="section" id="get-context-data"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id14"&gt;get_context_data&lt;/a&gt;&lt;/h4&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;大抵の場合、ビューというのはレンダリングに必要なコンテキストを組み立てるものなので 大体の処理は &lt;code class="docutils literal"&gt;get_context_data&lt;/code&gt; というメソッドに書く。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="redirectview"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id15"&gt;RedirectView&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;リダイレクトに特化した Generic View&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;任意の URL にリダイレクトすることに特化したやつ&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views.generic&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;RedirectView&lt;/span&gt;
&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;IndexView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RedirectView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'/accounts/login/'&lt;/span&gt;
&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-6"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# pattern_name = 'accounts:login'  # パターンで URL を指定する場合&lt;/span&gt;
&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_redirect_url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-9"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# リダイレクトする URL を動的に組み立てるためのやつをオーバーライドできる&lt;/span&gt;
&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_db19177b16ba4053ad0f89ba3d253272-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;IndexView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="generic-views"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id16"&gt;いろいろな Generic views&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;これが便利とのこと: &lt;a class="reference external" href="https://ccbv.co.uk/"&gt;https://ccbv.co.uk/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="listview"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id17"&gt;ListView&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;モデルオブジェクトの一覧を表示するための View&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_8c2b235b90be4f55bfb7f1753fe5c863-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views.generic&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;
&lt;a name="rest_code_8c2b235b90be4f55bfb7f1753fe5c863-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;
&lt;a name="rest_code_8c2b235b90be4f55bfb7f1753fe5c863-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_8c2b235b90be4f55bfb7f1753fe5c863-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_8c2b235b90be4f55bfb7f1753fe5c863-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BookListView1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_8c2b235b90be4f55bfb7f1753fe5c863-6"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# リストしたいモデルを指定する&lt;/span&gt;
&lt;a name="rest_code_8c2b235b90be4f55bfb7f1753fe5c863-7"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# これだけで、 `shop/book_list.html` という名前のテンプレートに、&lt;/span&gt;
&lt;a name="rest_code_8c2b235b90be4f55bfb7f1753fe5c863-8"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# object_list (or book_list) という変数名で、&lt;/span&gt;
&lt;a name="rest_code_8c2b235b90be4f55bfb7f1753fe5c863-9"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# Book モデルの全てのレコードの一覧を渡してくれる&lt;/span&gt;
&lt;a name="rest_code_8c2b235b90be4f55bfb7f1753fe5c863-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;
&lt;/pre&gt;&lt;pre class="code python"&gt;&lt;a name="rest_code_eb1b9f6bbe104af2a2e954cd92c11932-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# ほかにもいろいろある...&lt;/span&gt;
&lt;a name="rest_code_eb1b9f6bbe104af2a2e954cd92c11932-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 利用するテンプレートを指定する&lt;/span&gt;
&lt;a name="rest_code_eb1b9f6bbe104af2a2e954cd92c11932-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;template_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'husky.html'&lt;/span&gt;
&lt;a name="rest_code_eb1b9f6bbe104af2a2e954cd92c11932-4"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# オブジェクトの一覧を取得するためのクエリセットを指定する&lt;/span&gt;
&lt;a name="rest_code_eb1b9f6bbe104af2a2e954cd92c11932-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;queryset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;price__gt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="formview"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id18"&gt;FormView&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;何らかの登録・更新処理で &lt;code class="docutils literal"&gt;form&lt;/code&gt; を使ったバリデーションが必要なら 大体 &lt;code class="docutils literal"&gt;FormView&lt;/code&gt; を使う&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id19"&gt;ログイン・ログアウト&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://www.amazon.co.jp/dp/B07GK7BWB7/"&gt;現場で使える Django の教科書&lt;/a&gt; P.43 によく書いてあるのでそちらを参照のこと&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;request.user:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ログイン済: User オブジェクト&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;未ログイン: AnonymousUser オブジェクト&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ログイン済みか否か: request.user.is_authenticated&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ログアウトすると、&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;サーバーのセッションクリア&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;request.user に AnonymousUser をセット&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="loginview-logoutview"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id20"&gt;LoginView, LogoutView&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;ログインに特化した View: django.contrib.auth.views.LoginView&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ログアウトに特化した View: django.contrib.auth.views.LogoutView&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_4797af352da346dc96b958d13167d986-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib.auth.views&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;LoginView&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;AuthLoginView&lt;/span&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;LoginView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AuthLoginView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-5"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-6"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    ログインビューの実装例&lt;/span&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-8"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    * 設定値の調整が必要になることもあるよ&lt;/span&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-9"&gt;&lt;/a&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-10"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      * LOGIN_URL&lt;/span&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-11"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      * LOGIN_REDIRECT_URL&lt;/span&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-12"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      * LOGOUT_REDIRECT_URL&lt;/span&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-13"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    """&lt;/span&gt;
&lt;a name="rest_code_4797af352da346dc96b958d13167d986-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;template_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'accounts/login.html'&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="loginrequiredmixin"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/django/view/#id21"&gt;LoginRequiredMixin&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;LoginRequiredMixin: 未ログインのユーザーがアクセスしようとしたときに何らかのペナルティを課すための Mixin&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Django1.9 から導入された&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;継承すると、未ログインユーザーがアクセスしたらば LOGIN_URL で定義した URL にリダイレクトしてくれるよ&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_f25f93368f7548a0aa3ae7deeec6b95d-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib.auth.mixins&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;LoginRequiredMixin&lt;/span&gt;
&lt;a name="rest_code_f25f93368f7548a0aa3ae7deeec6b95d-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views.generic&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;
&lt;a name="rest_code_f25f93368f7548a0aa3ae7deeec6b95d-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_f25f93368f7548a0aa3ae7deeec6b95d-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;
&lt;a name="rest_code_f25f93368f7548a0aa3ae7deeec6b95d-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_f25f93368f7548a0aa3ae7deeec6b95d-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_f25f93368f7548a0aa3ae7deeec6b95d-7"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BookListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LoginRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_f25f93368f7548a0aa3ae7deeec6b95d-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;
&lt;a name="rest_code_f25f93368f7548a0aa3ae7deeec6b95d-9"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# 403 エラー画面を表示する場合は次のコメントアウトを外す&lt;/span&gt;
&lt;a name="rest_code_f25f93368f7548a0aa3ae7deeec6b95d-10"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# raise_exception = True&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>django</category><guid>https://32imuf.com/django/view/</guid><pubDate>Sat, 04 May 2019 15:00:00 GMT</pubDate></item></channel></rss>