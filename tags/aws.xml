<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ふみのて (Posts about aws)</title><link>https://32imuf.com/</link><description></description><atom:link href="https://32imuf.com/tags/aws.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2021 &lt;a href="mailto:fumi232323fumi2016@gmail.com"&gt;fumi23&lt;/a&gt; </copyright><lastBuildDate>Sun, 21 Nov 2021 14:34:22 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Amazon RDS のバックアップと復元</title><link>https://32imuf.com/aws/rds-backup-restore/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;&lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/rds-backup-restore/#aws" id="id16"&gt;AWS ドキュメントメモ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/rds-backup-restore/#id1" id="id17"&gt;ドキュメント&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/rds-backup-restore/#id2" id="id18"&gt;概要&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/rds-backup-restore/#id3" id="id19"&gt;バックアップストレージ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/rds-backup-restore/#id4" id="id20"&gt;バックアップの保存期間&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/rds-backup-restore/#db" id="id21"&gt;DB スナップショットの作成&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/rds-backup-restore/#id5" id="id22"&gt;DB スナップショットからの復元&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/rds-backup-restore/#db-instance" id="id23"&gt;特定の時点への DB instanceの復元&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/rds-backup-restore/#fumi23" id="id24"&gt;fumi23 の疑問と結論&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/rds-backup-restore/#id6" id="id25"&gt;スナップショット取得 -&amp;gt; リストア手順&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/rds-backup-restore/#id9" id="id26"&gt;コマンド例&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/rds-backup-restore/#id10" id="id27"&gt;コマンドリファレンス&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="aws"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/rds-backup-restore/#id16"&gt;AWS ドキュメントメモ&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id1"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/rds-backup-restore/#id17"&gt;ドキュメント&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://32imuf.com/aws/rds-backup-restore/(https:/docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/CHAP_CommonTasks.BackupRestore.html)"&gt;Amazon RDS DB インスタンスのバックアップと復元&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/rds-backup-restore/#id18"&gt;概要&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;DBインスタンス全体をバックアップする&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;RDS は DB インスタンスのストレージボリュームのスナップショットを作成し、個々のデータベースだけではなく、DB インスタンス全体をバックアップします。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DB スナップショットを手動で作成して、DB インスタンスを手動でバックアップすることもできる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DB インスタンスの最初のスナップショットには、フル DB インスタンスのデータが含まれる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;同じ DB インスタンスの後続のスナップショットは増分です。つまり、直近のスナップショット以降に変更されたデータのみが保存される&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/rds-backup-restore/#id19"&gt;バックアップストレージ&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;リージョンあたり最大 100 個の手動スナップショットを作成できる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;1 つの AWS リージョンで保持できる自動バックアップの最大数は 40 個&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/rds-backup-restore/#id20"&gt;バックアップの保存期間&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;自動バックアップ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;コンソールを使用して DB インスタンスを作成した場合、デフォルトのバックアップ保持期間は 7 日&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;バックアップ保持期間は変更できる (0 ～ 35 日間)  ※ &lt;code class="docutils literal"&gt;0&lt;/code&gt; == 自動バックアップが無効&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;手動スナップショット:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;スナップショットは期限切れになりません。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;自動バックアップとは異なり、手動スナップショットはバックアップ保持期間の影響を受けません。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="db"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/rds-backup-restore/#id21"&gt;DB スナップショットの作成&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Single-AZ DB インスタンスでこの DB スナップショットを作成すると、I/O が短時間中断します。この時間は、DB インスタンスのサイズやクラスによって異なり、数秒から数分。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MariaDB、MySQL、Oracle、PostgreSQL の場合、バックアップはスタンバイから取得されるため、マルチ AZ 配置のバックアップ中プライマリで I/O アクティビティは中断しない。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;=&amp;gt; とのこと&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;PostgreSQL DB インスタンスの場合、ログに記録されていないテーブルのデータはスナップショットから復元されないことがあります。詳細については、「&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/CHAP_BestPractices.html#CHAP_BestPractices.PostgreSQL"&gt;PostgreSQL を使用するためのベストプラクティス&lt;/a&gt;」を参照してください。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AWS Management Console から簡単にぽちぽちできる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AWS CLI のコマンドもシンプルそう&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/rds-backup-restore/#id22"&gt;DB スナップショットからの復元&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;復元元の DB スナップショットの名前を指定してから、復元から作成された新しい DB インスタンスの名前を指定する。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DB スナップショットから既存の DB インスタンスに復元することはできません。復元すると新しい DB インスタンスが作成されます。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;パラメータグループ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;復元された DB インスタンスを適切なパラメータグループと関連付けることができるように、作成する DB スナップショットのパラメータグループを保持することをお勧めします。DB インスタンスを復元するときにパラメータグループを指定できます。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;セキュリティグループ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;AWS CLI を使用している場合、カスタムセキュリティグループを指定し、
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;restore-db-instance-from-db-snapshot&lt;/span&gt;&lt;/code&gt; コマンドに &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;--vpc-security-group-ids&lt;/span&gt;&lt;/code&gt; オプションを含めることにより、インスタンスに関連付けることができます。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;復元が完了し、新しい DB インスタンスが利用できるようになったらすぐに、復元の元となるスナップショットによって使用されているカスタムセキュリティグループを関連付けることができる。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AWS CLI &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;modify-db-instance&lt;/span&gt;&lt;/code&gt; コマンドを介して DB インスタンスを修正することで、これらの変更を適用する必要がある&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;オプショングループ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;DB インスタンスを復元すると、DB スナップショットに関連付けられたオプショングループは、作成後に復元された DB インスタンスと関連付けられる。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/cli/latest/reference/rds/restore-db-instance-from-db-snapshot.html"&gt;restore-db-instance-from-db-snapshot&lt;/a&gt; コマンドにだいぶオプションがあるので、たいがい間に合いそう&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DB 立ち上がるまで待てるやつもある: &lt;a class="reference external" href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/wait/db-instance-available.html"&gt;db-instance-available&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="db-instance"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/rds-backup-restore/#id23"&gt;特定の時点への DB instanceの復元&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;DB インスタンスを特定の時点に復元し、新しい DB インスタンス を作成できる。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DB インスタンスを特定の時点に復元する場合、デフォルトの VPC セキュリティグループを選択するか、カスタム VPC セキュリティグループを DB インスタンスに適用できます。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;復元された DB インスタンスは、デフォルトの DB パラメータグループとオプショングループに自動的に関連付けられます。ただし、カスタムパラメータグループとオプショングループは、復元中に指定することで適用できます。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/restore-db-instance-to-point-in-time.html"&gt;restore-db-instance-to-point-in-time&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="fumi23"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/rds-backup-restore/#id24"&gt;fumi23 の疑問と結論&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;パスワードはどうなるのじゃ?&lt;/p&gt;
&lt;p&gt;=&amp;gt; &lt;code class="docutils literal"&gt;マスターユーザー名&lt;/code&gt;, &lt;code class="docutils literal"&gt;パスワード&lt;/code&gt;, &lt;code class="docutils literal"&gt;DB名&lt;/code&gt; (そりゃそうだけれど) は、スナップショット取得元インスタンスと同じで復元された&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;DB接続文字列に使うので気になった&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;パラメータグループとセキュリティグループは、結局、いつくっつけられるの?&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;restore-db-instance-from-db-snapshot&lt;/span&gt;&lt;/code&gt; のオプションで指定するだけでよいの?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;それとも、 DB 上がってから &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;modify-db-instance&lt;/span&gt;&lt;/code&gt; するの??&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;=&amp;gt; &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;restore-db-instance-from-db-snapshot&lt;/span&gt;&lt;/code&gt; のオプションで指定するだけで OK&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;指定したパラメータグループとセキュリティグループが関連づけられた状態で DB が復元される&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;後から変更したいものは、復元した DB が立ち上がってから  &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;modify-db-instance&lt;/span&gt;&lt;/code&gt; で変更できるよ、ということらしい&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;エンドポイント変わっちゃうな.. (新しいインスタンス立ち上げなので)&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;AWS Secrets Manager の value を AWS CLI で変更できる?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CNAME しておくのが良いのか..? DNS 切り替えめんどう...&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;=&amp;gt; なんかできそう: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/secretsmanager/latest/userguide/manage_update-secret.html"&gt;https://docs.aws.amazon.com/ja_jp/secretsmanager/latest/userguide/manage_update-secret.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;復元終わったら古いほう削除しないとだな (入れ替えたいので)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;というか、↓とかできないかな、できないのかな&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;あらかじめスナップショットを取得しておく ( &lt;code class="docutils literal"&gt;devfumi23&lt;/code&gt; から &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;devfumi23-s1&lt;/span&gt;&lt;/code&gt;)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;古いほうをリネーム ( &lt;code class="docutils literal"&gt;devfumi23&lt;/code&gt; -&amp;gt; &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;devfumi23-b1&lt;/span&gt;&lt;/code&gt;)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;スナップショットから復元 ( &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;devfumi23-s1&lt;/span&gt;&lt;/code&gt; から &lt;code class="docutils literal"&gt;devfumi23&lt;/code&gt;)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;古いほうを削除 (&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;devfumi23-b1&lt;/span&gt;&lt;/code&gt; を削除)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;=&amp;gt; できない。 DB識別子はさすがにリネームできない。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;=&amp;gt; DBインスタンスの削除はこちら: &lt;a class="reference external" href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/delete-db-instance.html"&gt;delete-db-instance&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;DBインスタンスとそのすべての自動バックアップが削除される&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;手動スナップショットは削除されない&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/rds-backup-restore/#id25"&gt;スナップショット取得 -&amp;gt; リストア手順&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;スナップショットを作成&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/USER_CreateSnapshot.html"&gt;DB スナップショットの作成&lt;/a&gt; に書いてあるとおり&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AWS CLI コマンドのほうもオプションちょっとしかないので、手動でやるなら AWS Management Console からで良いかなーという感じだった&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;スナップショットからの復元&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/USER_RestoreFromSnapshot.html"&gt;DB スナップショットからの復元&lt;/a&gt; を見てやる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;こちらは指定できる or 指定すべきオプションが多い&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AWS Management Console からぽちぽちやると間違えそうなので、 AWS CLI が良さそう (文字でとっておけるし)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;何某かからもキックできるし&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/rds-backup-restore/#id26"&gt;コマンド例&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;スナップショットからの復元&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# サブネットグループ、セキュリティグループ、パラメーターグループ (とその他) を指定している&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-2"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 指定しないと、それぞれデフォルトのものが関連付けられる&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-3"&gt;&lt;/a&gt;$ aws --profile fumi23 rds restore-db-instance-from-db-snapshot &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-4"&gt;&lt;/a&gt;     --db-instance-identifier devfumi23-r1 &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-5"&gt;&lt;/a&gt;     --db-snapshot-identifier devfumi23-s1 &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-6"&gt;&lt;/a&gt;     --db-instance-class db.t2.micro &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-7"&gt;&lt;/a&gt;     --db-subnet-group-name dev-fumi23-db-subnet-gr-pv &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-8"&gt;&lt;/a&gt;     --multi-az &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-9"&gt;&lt;/a&gt;     --publicly-accessible &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-10"&gt;&lt;/a&gt;     --no-auto-minor-version-upgrade &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-11"&gt;&lt;/a&gt;     --vpc-security-group-ids sg-99999999999999999 &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-12"&gt;&lt;/a&gt;     --copy-tags-to-snapshot &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-13"&gt;&lt;/a&gt;     --enable-cloudwatch-logs-exports postgresql &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-14"&gt;&lt;/a&gt;     --db-parameter-group-name  devfumi23-postgres11 &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_e671c71d1a8c413e8b01a2171114e514-15"&gt;&lt;/a&gt;     --no-deletion-protection
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;オプションに指定すべき値がよくわからないなあ... というときは、
&lt;a class="reference external" href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/describe-db-instances.html"&gt;describe-db-instances&lt;/a&gt;
で、スナップショット取得元DBインスタンスの情報を取得してみるとだいたいわかる&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_8f11ac42680b420fbeb9036703b82593-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# 指定した DB インスタンスの情報を取得&lt;/span&gt;
&lt;a name="rest_code_8f11ac42680b420fbeb9036703b82593-2"&gt;&lt;/a&gt;$ aws --profile fumi23 rds describe-db-instances --db-instance-identifier devfumi23 &amp;gt; describe-db-devfumi23.json
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;JSON or YAML 形式のスケルトンも取得できる。それを &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;--cli-input-json&lt;/span&gt;&lt;/code&gt; or &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;--cli-input-yaml&lt;/span&gt;&lt;/code&gt; に指定できる。&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_beb083c2ec504a65bb60050a68968dc7-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# スケルトンを YAML 形式で取得&lt;/span&gt;
&lt;a name="rest_code_beb083c2ec504a65bb60050a68968dc7-2"&gt;&lt;/a&gt;$ aws --profile fumi23 rds restore-db-instance-from-db-snapshot --generate-cli-skeleton yaml-input &amp;gt; restore-db-skeleton.yaml
&lt;a name="rest_code_beb083c2ec504a65bb60050a68968dc7-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# スケルトンを JSON 形式で取得&lt;/span&gt;
&lt;a name="rest_code_beb083c2ec504a65bb60050a68968dc7-4"&gt;&lt;/a&gt;$ aws --profile fumi23 rds restore-db-instance-from-db-snapshot --generate-cli-skeleton &amp;gt; restore-db-skeleton.json
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/rds-backup-restore/#id27"&gt;コマンドリファレンス&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/create-db-snapshot.html"&gt;create-db-snapshot&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/cli/latest/reference/rds/restore-db-instance-from-db-snapshot.html"&gt;restore-db-instance-from-db-snapshot&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/describe-db-instances.html"&gt;describe-db-instances&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/restore-db-instance-to-point-in-time.html"&gt;restore-db-instance-to-point-in-time&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/wait/db-instance-available.html"&gt;db-instance-available&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/delete-db-instance.html"&gt;delete-db-instance&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>aws</category><guid>https://32imuf.com/aws/rds-backup-restore/</guid><pubDate>Sat, 20 Nov 2021 15:00:00 GMT</pubDate></item><item><title>ECS Fargate: コンテナごとの CPU使用率とメモリ使用率を見たい</title><link>https://32imuf.com/ecs/check-container-performance/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/ecs/check-container-performance/#cpu" id="id6"&gt;タスク定義.コンテナ定義に、コンテナごとの CPUユニット数・メモリリミットを設定しておく&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/ecs/check-container-performance/#id1" id="id7"&gt;こんな感じ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/ecs/check-container-performance/#id2" id="id8"&gt;参考ページ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/ecs/check-container-performance/#cloudwatch-logs-insights" id="id9"&gt;CloudWatch Logs Insights でクエリを投げて見る&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/ecs/check-container-performance/#id3" id="id10"&gt;こんな感じ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/ecs/check-container-performance/#id4" id="id11"&gt;参考ページ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="cpu"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/ecs/check-container-performance/#id6"&gt;タスク定義.コンテナ定義に、コンテナごとの CPUユニット数・メモリリミットを設定しておく&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;↓ で、 &lt;code class="docutils literal"&gt;%&lt;/code&gt; で見られるようになる&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;CloudWatch&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;=&amp;gt; Container Insights&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;=&amp;gt; パフォーマンスのモニタリング&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;=&amp;gt; ECS Tasks&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;=&amp;gt; コンテナのパフォーマンス&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id1"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/ecs/check-container-performance/#id7"&gt;こんな感じ&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="figure"&gt;
&lt;img alt="/images/ecs/check-container-performance/container-performance.png" src="https://32imuf.com/images/ecs/check-container-performance/container-performance.png"&gt;
&lt;/div&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;コンテナごとに設定した CPUユニット数・メモリリミットに対する &lt;code class="docutils literal"&gt;%&lt;/code&gt; だと思う&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;タスク数が複数だったら、その分のコンテナ分全部出る (e.g. 1タスク内にコンテナ 2つで、タスク数2 にしていたら 4コンテナ分出る)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/ecs/check-container-performance/#id8"&gt;参考ページ&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://dev.classmethod.jp/articles/how-to-check-container-cpu-usage-by-container-insights/"&gt;Container Insights でコンテナ単位のCPU・メモリ使用率を表示させる方法&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="cloudwatch-logs-insights"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/ecs/check-container-performance/#id9"&gt;CloudWatch Logs Insights でクエリを投げて見る&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;↓ で、 &lt;code class="docutils literal"&gt;CPUユニット数&lt;/code&gt; と &lt;code class="docutils literal"&gt;メモリ (MiB)&lt;/code&gt; で見られるようになる&lt;/p&gt;
&lt;p&gt;※こちらの方法だと、タスク定義.コンテナ定義に「コンテナごとの CPUユニット数・メモリリミット」を設定していなくても見られる&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;CloudWatch&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;=&amp;gt; Container Insights&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;=&amp;gt; パフォーマンスのモニタリング&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;=&amp;gt; ECS Tasks&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;=&amp;gt; コンテナのパフォーマンス&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;=&amp;gt; Container name をチェックして&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;=&amp;gt; View performance logs&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;=&amp;gt; (Logs Insights ページにいくので) クエリの実行&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/ecs/check-container-performance/#id10"&gt;こんな感じ&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://dev.classmethod.jp/articles/ways-to-check-fargate-cpu-usage/"&gt;CloudWatch Logs Insights でコンテナ単位のCPU・メモリ使用量などを確認する&lt;/a&gt; に書いていただいているとおりです、ありがとうございます。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;ほかのクエリも投げられる =&amp;gt; 1時間平均なども取得できる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/ecs/check-container-performance/#id11"&gt;参考ページ&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://dev.classmethod.jp/articles/ways-to-check-fargate-cpu-usage/"&gt;CloudWatch Logs Insights でコンテナ単位のCPU・メモリ使用量などを確認する&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AWS: &lt;a class="reference external" href="https://aws.amazon.com/jp/premiumsupport/knowledge-center/ecs-tasks-fargate-memory-utilization/"&gt;Fargate で Amazon ECS タスクの高いメモリ使用率をモニタリングする方法を教えてください。&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AWS: &lt;a class="reference external" href="https://aws.amazon.com/jp/blogs/mt/introducing-container-insights-for-amazon-ecs/"&gt;AmazonECS用のAmazonCloudWatch ContainerInsightsの紹介&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;調整のしかたとか載っていておもしろそうだった&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AWS: &lt;a class="reference external" href="https://aws.amazon.com/jp/blogs/containers/how-amazon-ecs-manages-cpu-and-memory-resources/"&gt;AmazonECSがCPUおよびメモリリソースを管理する方法&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AWS: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/monitoring/deploy-container-insights-ECS-cluster.html#deploy-container-insights-ECS-existing"&gt;既存の Amazon ECS クラスターでの Container Insights のセットアップ&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;新規作成時であれば、Management Console で有効化できる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>aws</category><guid>https://32imuf.com/ecs/check-container-performance/</guid><pubDate>Sat, 09 Oct 2021 15:00:00 GMT</pubDate></item><item><title>Amazon SES でメールを送信する</title><link>https://32imuf.com/aws/ses-sending-email/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;details&gt;
  &lt;summary&gt;目次&lt;/summary&gt;&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#id1" id="id15"&gt;リファレンス/ガイド&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#id2" id="id16"&gt;説明&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#id3" id="id17"&gt;導入の流れ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#id5" id="id18"&gt;1. ドメイン検証&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#id6" id="id19"&gt;やりかた&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#id7" id="id20"&gt;2. Eメールの認証&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#spf-e" id="id21"&gt;SPF を使った E メールの認証&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#id8" id="id22"&gt;やりかた&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#dkim-e" id="id23"&gt;DKIM を使った E メールの認証&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#id9" id="id24"&gt;やりかた&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#dmarc" id="id25"&gt;3. DMARC に準拠する&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#id11" id="id26"&gt;やりかた&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#id12" id="id27"&gt;ドメインの DMARC ポリシーのセットアップ&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#dkim-dmarc" id="id28"&gt;DKIM による DMARC への準拠&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#spf-dmarc" id="id29"&gt;SPF による DMARC への準拠&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#id13" id="id30"&gt;4. 本番運用するには...&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference internal" href="https://32imuf.com/aws/ses-sending-email/#id14" id="id31"&gt;参考&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/details&gt;&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id15"&gt;リファレンス/ガイド&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Amazon SES とは: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/Welcome.html"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/Welcome.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Amazon SES クイック スタート: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/quick-start.html"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/quick-start.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id16"&gt;説明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/Welcome.html"&gt;Amazon SES (Amazon Simple Email Service)&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Amazon SES は、ユーザー自身の E メールアドレスとドメインを使用して E メールを送受信するための、簡単で費用効率の高い方法を提供する E メールプラットフォームです。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id17"&gt;導入の流れ&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;「 &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/verify-domains.html"&gt;ドメイン検証&lt;/a&gt; 」もしくは「 &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/verify-email-addresses.html"&gt;E メールアドレス検証&lt;/a&gt; 」する&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Eメールを認証する&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Sender Policy Framework (SPF)  を使った E メールの認証&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ドメインキーアイデンティファイドメール (DKIM) を使った E メールの認証&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DMARC (Domain-based Message Authentication, Reporting and Conformance) に準拠する&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;ドメインの DMARC ポリシーのセットアップ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;SPF による DMARC への準拠&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DKIM による DMARC への準拠&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;本番運用するには...&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id18"&gt;1. ドメイン検証&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;「E メールアドレスの検証」 or 「ドメイン検証」 のいずれかを行う必要がある&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ドメインごと検証すると、対象ドメインのすべての E メールアドレスを検証することになるため、(そのドメインの) E メールアドレスを個別に検証する必要がない&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;「ドメイン検証」は、AWS リージョンごとに必要&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;検証対象のドメインが Route 53 の DNS サービスを使用していて、Route 53 用の同じアカウントで AWS マネジメントコンソール にサインインしている場合、
Amazon SES コンソール内からすぐに DNS サーバーを更新できるらしい (わたしは別の DNS プロバイダーでやった)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id19"&gt;やりかた&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;このガイドのとおりにやれば、とくにハマることもなくできる&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Amazon SES でのドメインの検証: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/verify-domains.html"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/verify-domains.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Amazon SES でのドメインの検証: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/verify-domain-procedure.html"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/verify-domain-procedure.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;検証が完了すると、&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Amazon SES コンソールでのドメインのステータスが「pending verification (検証中)」から「verified (検証済み)」に変わり、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Amazon SES から通知 E メールが届く&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Amazon SES コンソールの「Send a Test Email」からテストメールを送信できる&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;サンドボックス内にいる場合は、TOアドレスも検証する必要あり (&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/verify-email-addresses.html"&gt;Amazon SES での E メールアドレスの検証&lt;/a&gt; )&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;届いたメールはこんな感じ↓&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="figure"&gt;
&lt;img alt="/images/aws/ses-sending-email/01_test-mail-verify-domains.png" src="https://32imuf.com/images/aws/ses-sending-email/01_test-mail-verify-domains.png"&gt;
&lt;/div&gt; &lt;div class="figure"&gt;
&lt;img alt="/images/aws/ses-sending-email/02_test-mail-details-verify-domains.png" src="https://32imuf.com/images/aws/ses-sending-email/02_test-mail-details-verify-domains.png"&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id20"&gt;2. Eメールの認証&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Amazon SES での E メールの認証: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/authentication.html"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/authentication.html&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Amazon SES では、E メールの送信に Simple Mail Transfer Protocol（SMTP）が使用されるが、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;SMTP 自体は認証を提供しないので、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;SPF&lt;/code&gt;, &lt;code class="docutils literal"&gt;DKIM&lt;/code&gt;, &lt;code class="docutils literal"&gt;DMARC への準拠&lt;/code&gt; (後述) によって「送信ドメイン認証」対応し、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ISP に対して、わたしが送信するメールが「なりすましメール」ではないことを証明しましょう (もし誰かになりすまされたら気付けるようにしましょう)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="spf-e"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id21"&gt;SPF を使った E メールの認証&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;SPF: Sender Policy Framework&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;E メールのなりすましを防ぐために設計された E メールの検証標準&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ドメイン所有者は SPF を使用して、自分のドメインからメールを送信できるサーバーをメールプロバイダーに通知する (承認済みメールサーバーのリストをドメインの DNS 設定に公開する)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;E メールプロバイダーは、ドメインからメッセージを受信すると、ドメインの DNS サーバーの SPF レコードをチェックして、承認されたサーバーから E メールが送信されたことを確認する&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Amazon SES における SPF を使った E メールの認証: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/spf.html"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/spf.html&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Amazon SES を介して E メールを送信すると、送信するメッセージはデフォルトで SPF チェックをパスするようになっているけれども、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;オプションで、独自の SPF レコードを公開できる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;SPF レコードを公開することにより、DMARC に準拠できる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id8"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id22"&gt;やりかた&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;a class="reference external" href="https://32imuf.com/aws/ses-sending-email/#spf-dmarc"&gt;3. DMARC に準拠する &amp;gt; SPF による DMARC への準拠 &amp;gt; 1. カスタムの MAIL FROM ドメインを設定する&lt;/a&gt; を参照のこと&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;どうせやるのなら、 DMARC に準拠できるのが良いと思う&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="dkim-e"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id23"&gt;DKIM を使った E メールの認証&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;DKIM: ドメインキーアイデンティファイドメール&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;E メールメッセージに署名することで、自分のメッセージが本物であることと送信中に改ざんされていないことを ISP に証明するための標準規格&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;送信者が暗号化キーで E メールメッセージを署名できる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;E メールプロバイダーはこの署名を使用して、メッセージが転送中に第三者によって改ざんされていないことを検証する&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;詳しくは、 &lt;a class="reference external" href="http://dkim.org/"&gt;http://dkim.org/&lt;/a&gt; に書いてあるそうです&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Amazon SES における DKIM を使った E メールの認証: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/dkim.html"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/dkim.html&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;「送信元」アドレスで使用するドメインでのみ Easy DKIM 設定が必要&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;リージョンごとに Easy DKIM 設定が必要&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id9"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id24"&gt;やりかた&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;a class="reference external" href="https://32imuf.com/aws/ses-sending-email/#dkim-dmarc"&gt;3. DMARC に準拠する &amp;gt; DKIM による DMARC への準拠&lt;/a&gt; を参照のこと&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;どうせやるのなら、 DMARC に準拠できるのが良いと思う&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="dmarc"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id25"&gt;3. DMARC に準拠する&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://dmarc.org/"&gt;DMARC&lt;/a&gt;: Domain-based Message Authentication, Reporting and Conformance&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;SPF (Sender Policy Framework) および DKIM (ドメインキーアイデンティファイドメール) を使用して
メールスプーフィングを検出するためのメール認証プロトコルです。
DMARC に準拠するため、メッセージは SPF または DKIM のいずれか、または両方で認証される必要があります。 (2)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;SPF と DKIM を合わせて活用する技術で、「送信ドメイン認証関連の技術」「レポーティング」という機能がある。 (3)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;SPF や DKIM それぞれ単体の送信ドメイン認証技術と、DMARC との大きな違いは、以下が挙げられます。 (4)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;それぞれ (SPF or DKIM) の認証結果のどちらかが pass すれば良いこと&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;メール受信者が直接みることができるメールヘッダ上の送信者情報 (From:ヘッダ) を認証すること&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;メール送信者が認証が失敗したメールの取り扱いを示すことができること&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;メール送信者が認証結果をメール受信者から受け取る仕組みが用意されていること&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;SPF や DKIM の合わせ技 (相互補完) + レポーティング&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一番詳しくはここを見よ: &lt;a class="reference external" href="https://dmarc.org/"&gt;https://dmarc.org/&lt;/a&gt; (1)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;出典:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;DMARC: &lt;a class="reference external" href="https://dmarc.org/"&gt;https://dmarc.org/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Amazon SES での DMARC への準拠: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/dmarc.html"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/dmarc.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;送信ドメイン認証技術「DMARC」によるなりすましメール対策とDMARCレポートの活用: &lt;a class="reference external" href="https://www.dekyo.or.jp/info/2019/02/seminar/5684/"&gt;https://www.dekyo.or.jp/info/2019/02/seminar/5684/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;なりすまし対策ポータルナリタイ: &lt;a class="reference external" href="https://www.naritai.jp/index.html"&gt;https://www.naritai.jp/index.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id11"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id26"&gt;やりかた&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="id12"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id27"&gt;ドメインの DMARC ポリシーのセットアップ&lt;/a&gt;&lt;/h4&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;ドメインの DNS 設定に、ドメインの DMARC 設定を指定する TXT レコードを追加する&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;このガイドどおりでとくにむずかしいことはない。TXT レコードの値の説明もここに書いてある。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/dmarc.html#dmarc-dns"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/dmarc.html#dmarc-dns&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="dkim-dmarc"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id28"&gt;DKIM による DMARC への準拠&lt;/a&gt;&lt;/h4&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/easy-dkim.html"&gt;Amazon SES の Easy DKIM&lt;/a&gt; の手順を実行して Easy DKIM を設定する: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/easy-dkim.html"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/easy-dkim.html&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ドメインにおける Easy DKIM のセットアップ: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/easy-dkim-setup-domain.html"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/easy-dkim-setup-domain.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;このガイドのとおりにやれば、とくにハマることもなくできる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;検証が完了すると、&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Amazon SES コンソールでのドメインのステータスが「pending verification (検証中)」から「verified (検証済み)」に変わり、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Amazon SES から通知 E メールが届く&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Amazon SES コンソールの「Send a Test Email」からテストメールを送信できる&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;届いたメールはこんな感じ (セットアップ前と比べると、「署名元」が &lt;code class="docutils literal"&gt;32imuf.com&lt;/code&gt; に変わっている)&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="figure"&gt;
&lt;img alt="/images/aws/ses-sending-email/03_test-mail-dkim.png" src="https://32imuf.com/images/aws/ses-sending-email/03_test-mail-dkim.png"&gt;
&lt;/div&gt; &lt;div class="figure"&gt;
&lt;img alt="/images/aws/ses-sending-email/04_test-mail-details-dkim.png" src="https://32imuf.com/images/aws/ses-sending-email/04_test-mail-details-dkim.png"&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;送信元ドメインが DKIM に relaxed ポリシーを使用していることを確認する&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code zsh"&gt;&lt;a name="rest_code_10a01851809040b1b242a8d8f1f4ebdb-1"&gt;&lt;/a&gt;$ nslookup -type&lt;span class="o"&gt;=&lt;/span&gt;TXT _dmarc.32imuf.com
&lt;a name="rest_code_10a01851809040b1b242a8d8f1f4ebdb-2"&gt;&lt;/a&gt;Server:           &lt;span class="m"&gt;8&lt;/span&gt;.8.8.8
&lt;a name="rest_code_10a01851809040b1b242a8d8f1f4ebdb-3"&gt;&lt;/a&gt;Address:  &lt;span class="m"&gt;8&lt;/span&gt;.8.8.8#53
&lt;a name="rest_code_10a01851809040b1b242a8d8f1f4ebdb-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_10a01851809040b1b242a8d8f1f4ebdb-5"&gt;&lt;/a&gt;Non-authoritative answer:
&lt;a name="rest_code_10a01851809040b1b242a8d8f1f4ebdb-6"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# ここに、 adkim=r が含まれるか、または adkim 文字列がまったく存在しない場合は relaxed&lt;/span&gt;
&lt;a name="rest_code_10a01851809040b1b242a8d8f1f4ebdb-7"&gt;&lt;/a&gt;_dmarc.32imuf.com &lt;span class="nv"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"v=DMARC1;p=quarantine;pct=25;rua=mailto:dmarcreports@32imuf.com"&lt;/span&gt;
&lt;a name="rest_code_10a01851809040b1b242a8d8f1f4ebdb-8"&gt;&lt;/a&gt;
&lt;a name="rest_code_10a01851809040b1b242a8d8f1f4ebdb-9"&gt;&lt;/a&gt;Authoritative answers can be found from:
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;ドメインのポリシーアラインメントを変更していない場合は、デフォルトで relaxed ポリシーが使用される&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="spf-dmarc"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id29"&gt;SPF による DMARC への準拠&lt;/a&gt;&lt;/h4&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p&gt;カスタムの MAIL FROM ドメインを設定する: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/mail-from.html"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/mail-from.html&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;デフォルトでは、Amazon SES から送信するメッセージには、MAIL FROM ドメインとして amazonses.com のサブドメインが使用される&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;デフォルトの MAIL FROM ドメインが E メールを送信したアプリケーション (この場合は Amazon SES) と一致するため、
Sender Policy Framework (SPF) 認証はこれらのメッセージを正常に検証するけれども、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;カスタム MAIL FROM ドメインを設定することにより、E メールはドメインベースのメッセージ認証、レポート、
および適合性 (DMARC: Domain-based Message Authentication, Reporting and Conformance) に準拠できる&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;SPF で DMARC に準拠する唯一の方法は、カスタム MAIL FROM ドメインを使用すること&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;SPF 検証では、差出人アドレスのドメインが MAIL FROM ドメインと一致する必要がある&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MAIL FROM ドメインは、メールの送信元である検証済み ID (メールアドレスまたはドメイン) のサブドメインである必要がある&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ドメインの DNS 設定に、 MXレコードと SPFレコードを追加する&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;ガイドどおりでとくにハマることはなかったけれども、これ↓だけちょっと戸惑った&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MXレコード: Value の最初の &lt;code class="docutils literal"&gt;10&lt;/code&gt; は優先度のことらしい&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;セットアップが完了すると、&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Amazon SES コンソールでのドメインのステータスが「pending verification (検証中)」から「verified (検証済み)」に変わり、&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Amazon SES から通知 E メールが届く&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Amazon SES コンソールの「Send a Test Email」からテストメールを送信してみると、&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;届いたメールはこう (「送信元」が、設定したカスタム MAIL FROM ドメイン &lt;code class="docutils literal"&gt;bounces.32imuf.com&lt;/code&gt; に変わっている)&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;div class="figure"&gt;
&lt;img alt="/images/aws/ses-sending-email/05_test-mail-spf.png" src="https://32imuf.com/images/aws/ses-sending-email/05_test-mail-spf.png"&gt;
&lt;/div&gt; &lt;div class="figure"&gt;
&lt;img alt="/images/aws/ses-sending-email/06_test-mail-details-spf.png" src="https://32imuf.com/images/aws/ses-sending-email/06_test-mail-details-spf.png"&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;送信元ドメインが SPF に relaxed ポリシーを使用していることを確認する&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code zsh"&gt;&lt;a name="rest_code_b29ccad3bbf74c5998dfa4d480a64f0a-1"&gt;&lt;/a&gt;$ nslookup -type&lt;span class="o"&gt;=&lt;/span&gt;TXT _dmarc.32imuf.com
&lt;a name="rest_code_b29ccad3bbf74c5998dfa4d480a64f0a-2"&gt;&lt;/a&gt;Server:           &lt;span class="m"&gt;8&lt;/span&gt;.8.8.8
&lt;a name="rest_code_b29ccad3bbf74c5998dfa4d480a64f0a-3"&gt;&lt;/a&gt;Address:  &lt;span class="m"&gt;8&lt;/span&gt;.8.8.8#53
&lt;a name="rest_code_b29ccad3bbf74c5998dfa4d480a64f0a-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_b29ccad3bbf74c5998dfa4d480a64f0a-5"&gt;&lt;/a&gt;Non-authoritative answer:
&lt;a name="rest_code_b29ccad3bbf74c5998dfa4d480a64f0a-6"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# ここに、 aspf=r が含まれるか、または aspf 文字列がまったく存在しない場合は relaxed&lt;/span&gt;
&lt;a name="rest_code_b29ccad3bbf74c5998dfa4d480a64f0a-7"&gt;&lt;/a&gt;_dmarc.32imuf.com &lt;span class="nv"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"v=DMARC1;p=quarantine;pct=25;rua=mailto:dmarcreports@32imuf.com"&lt;/span&gt;
&lt;a name="rest_code_b29ccad3bbf74c5998dfa4d480a64f0a-8"&gt;&lt;/a&gt;
&lt;a name="rest_code_b29ccad3bbf74c5998dfa4d480a64f0a-9"&gt;&lt;/a&gt;Authoritative answers can be found from:
&lt;/pre&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;ドメインのポリシーアラインメントを変更していない場合は、デフォルトで relaxed ポリシーが使用される&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id13"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id30"&gt;4. 本番運用するには...&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;バウンスや苦情の処理方法の検討&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/request-production-access.html"&gt;Amazon SES サンドボックスの外への移動&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;もやる&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id14"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="https://32imuf.com/aws/ses-sending-email/#id31"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://ja.wikipedia.org/wiki/DNS%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E3%82%BF%E3%82%A4%E3%83%97%E3%81%AE%E4%B8%80%E8%A6%A7"&gt;https://ja.wikipedia.org/wiki/DNSレコードタイプの一覧&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;主なレコードの意味&lt;/p&gt;
&lt;dl class="field-list simple"&gt;
&lt;dt&gt;A(Address) レコード&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;ホスト名にIPv4 IPアドレスをマッピングする (返されるのはIPアドレス)&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;CNAME レコード&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;正規ホスト名に対する別名を定義する&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;MX レコード&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;対象ドメイン宛のメールの配送先（メールサーバ）のホスト名を定義する&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;TXT レコード&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;ホスト名に関連付けるテキスト情報（文字列）を定義する&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;送信ドメイン認証の認証情報などを記述する&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;nslookup&lt;/code&gt;: DNS（Domain Name System）サーバに名前解決を問い合わせるコマンド&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>aws</category><guid>https://32imuf.com/aws/ses-sending-email/</guid><pubDate>Sun, 22 Dec 2019 15:00:00 GMT</pubDate></item><item><title>AWS のいろいろなサービス</title><link>https://32imuf.com/aws/iroiro/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;div class="section" id="aws"&gt;
&lt;h2&gt;AWS ドキュメント&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/"&gt;https://docs.aws.amazon.com/&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="ecs-amazon-elastic-container-service"&gt;
&lt;h2&gt;ECS (Amazon Elastic Container Service)&lt;/h2&gt;
&lt;p&gt;コンテナオーケストレーションサービス&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Amazon Elastic Container Service (Amazon ECS) は、Amazon EC2 インスタンスのクラスターで Docker コンテナの実行、停止、管理を簡単に行うことのできる、高度にスケーラブルで高速なコンテナ管理サービスです。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id1"&gt;
&lt;h3&gt;リファレンス/ガイド&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ecs/index.html"&gt;https://docs.aws.amazon.com/ecs/index.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;メモ&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;クラスター &amp;gt; サービス &amp;gt; タスク定義&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;タスク定義&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;コンテナ（Task）, コンテナの起動設定（TaskDefinition）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;起動するとタスクになる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;タスク定義は、タスクに含まれるコンテナの数、それらが使用するリソース、それらが一緒にリンクされる方法、および使用するホストポートなど、アプリケーションのコンテナ情報を指定します。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Fargate&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;起動タイプって書いてある&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AWS FargateとECSの違いは？: &lt;a class="reference external" href="https://qiita.com/ABCompany1/items/5f3fcea04052415dc875"&gt;https://qiita.com/ABCompany1/items/5f3fcea04052415dc875&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Fargate を使用した Amazon ECS の使用開始: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/ECS_GetStarted_Fargate.html"&gt;https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/ECS_GetStarted_Fargate.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;くろのて: Django を ECS(Fargate) に手動デプロイしたログ:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;やってみた&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Docker/Kubernetes 実践コンテナ開発入門 &amp;gt; B.3 AWS Fargate を用いた ECS でのコンテナオーケストレーション&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;クラスターつくると、全部セットでできあがるのすごいな&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;だいぶセットでできあがる&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="ecr-amazon-elastic-container-registry"&gt;
&lt;h2&gt;ECR (Amazon Elastic Container Registry)&lt;/h2&gt;
&lt;p&gt;コンテナイメージを簡単に保存、管理、デプロイ&lt;/p&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;リファレンス/ガイド&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://aws.amazon.com/jp/ecr/"&gt;https://aws.amazon.com/jp/ecr/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="alb-application-load-balancer"&gt;
&lt;h2&gt;ALB (Application Load Balancer)&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Elastic Load Balancing は、EC2 インスタンスなどの複数のターゲット間で、アプリケーションの着信トラフィックを自動的に分散します。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;登録されているターゲットの状態をモニタリングし、正常なターゲットのみにトラフィックをルーティングします。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Elastic Load Balancing は、Application Load Balancer、Network Load Balancer、Classic Load Balancer の 3 つのタイプのロードバランサーをサポートします。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;リファレンス/ガイド&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/elasticloadbalancing/latest/application/introduction.html"&gt;https://docs.aws.amazon.com/ja_jp/elasticloadbalancing/latest/application/introduction.html&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="vpc-amazon-virtual-private-cloud"&gt;
&lt;h2&gt;VPC (Amazon Virtual Private Cloud)&lt;/h2&gt;
&lt;p&gt;ユーザーが定義した仮想ネットワーク内で AWS リソースの起動が可能な、アマゾン ウェブ サービス (AWS) クラウドのローカルで隔離されたセクションのプロビジョニング。&lt;/p&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;リファレンス/ガイド&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://aws.amazon.com/jp/vpc/"&gt;https://aws.amazon.com/jp/vpc/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/vpc/latest/userguide/what-is-amazon-vpc.html"&gt;https://docs.aws.amazon.com/ja_jp/vpc/latest/userguide/what-is-amazon-vpc.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;めもめも&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;閉じたクラウドの仮装ネットワークなのみたいなこと言ってるよ...&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="cfn-aws-cloudformation"&gt;
&lt;h2&gt;CFn (AWS CloudFormation)&lt;/h2&gt;
&lt;p&gt;すべてのクラウドインフラストラクチャリソースのモデル化とプロビジョニング&lt;/p&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;リファレンス/ガイド&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://aws.amazon.com/jp/cloudformation/"&gt;https://aws.amazon.com/jp/cloudformation/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://aws.amazon.com/jp/cloudformation/features/"&gt;https://aws.amazon.com/jp/cloudformation/features/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;めも&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;テンプレート&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;スタック&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;クラウド環境内のすべてのインフラストラクチャリソースを記述してプロビジョニングするための共通言語を提供します&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AWS CloudFormation は追加料金なしでご利用いただけます&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;利点&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;インフラストラクチャ全体をテキストファイルでモデル化できます&lt;/cite&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;モデル化したテキストファイルのことを &lt;code class="docutils literal"&gt;テンプレート&lt;/code&gt; というらしい&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;サンプルテンプレートを使ったり、独自のテンプレートを作ったりできるらしい&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;JSON/YAML で書くらしい&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;このテンプレートは、インフラストラクチャにおける真の単一ソースとなります。&lt;/cite&gt; ふむう&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;自動化とデプロイ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;AWS CloudFormation では、安全で繰り返し可能な方法でリソースがプロビジョニングされるため、
手作業やカスタムスクリプト作成を必要とせずにインフラストラクチャとアプリケーションの構築と再構築が可能になります。&lt;/cite&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;エラーが検出された場合は変更が自動的にロールバックされます。&lt;/cite&gt; なぬ、しゅごいな....&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CloudWatch アラームを指定できるんだって&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;AWS リソース、およびアプリケーションを実行するために必要な関連するすべての依存関係やランタイムパラメータを記述できる&lt;/cite&gt; んですって&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;スタック&lt;/code&gt; というキーワードが登場&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;単なるコード&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;インフラストラクチャをコード化することで、インフラストラクチャを単なるコードとして扱えるようになります。&lt;/cite&gt; ほうほう&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;スタック&lt;/code&gt; よくわからないな&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="eks-amazon-elastic-kubernetes-service"&gt;
&lt;h2&gt;EKS (Amazon Elastic Kubernetes Service)&lt;/h2&gt;
&lt;p&gt;可用性が高く、スケーラブルで安全な Kubernetes サービス&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;AWS のマネージド Kubernetes サービス&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;リファレンス/ガイド&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://aws.amazon.com/jp/eks/"&gt;https://aws.amazon.com/jp/eks/&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="rds-amazon-relational-database-service"&gt;
&lt;h2&gt;RDS (Amazon Relational Database Service)&lt;/h2&gt;
&lt;p&gt;クラウド上のリレーショナルデータベースのセットアップ、オペレーション、スケールを数回のクリックで実現&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="amazon-s3-glacier-s3-glacier-deep-archive"&gt;
&lt;h2&gt;Amazon S3 Glacier と S3 Glacier Deep Archive&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/glacier/"&gt;https://docs.aws.amazon.com/ja_jp/glacier/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;1 テラバイトあたり月額 1 USD から利用できる、データアーカイブのための長期保存用の安全で耐久性に優れた Amazon S3 オブジェクトストレージクラス&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="aws-codebuild"&gt;
&lt;h2&gt;AWS CodeBuild&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/codebuild/"&gt;https://docs.aws.amazon.com/ja_jp/codebuild/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;AWS CodeBuild は完全マネージド型のビルドサービスです。ソースコードのコンパイル、ユニットテストの実行、すぐにデプロイできるアーティファクトの生成を行います。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="aws-lambda"&gt;
&lt;h2&gt;AWS Lambda&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;AWS Lambda ドキュメント: &lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/lambda/"&gt;https://docs.aws.amazon.com/ja_jp/lambda/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;AWS Lambda はサーバーをプロビジョニングしたり管理する必要なくコードを実行できるコンピューティングサービスです。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="aws-serverless-application-repository"&gt;
&lt;h2&gt;AWS Serverless Application Repository&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://aws.amazon.com/jp/serverless/serverlessrepo/"&gt;https://aws.amazon.com/jp/serverless/serverlessrepo/&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Serverless Application Repository の使用に追加料金はかかりません。デプロイするアプリケーションで使用する AWS リソースに対してのみ料金をお支払いいただきます。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="amazon-ses-amazon-simple-email-service"&gt;
&lt;h2&gt;Amazon SES (Amazon Simple Email Service)&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/Welcome.html"&gt;https://docs.aws.amazon.com/ja_jp/ses/latest/DeveloperGuide/Welcome.html&lt;/a&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Amazon SES は、ユーザー自身の E メールアドレスとドメインを使用して E メールを送受信するための、簡単で費用効率の高い方法を提供する E メールプラットフォームです。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>aws</category><guid>https://32imuf.com/aws/iroiro/</guid><pubDate>Wed, 26 Jun 2019 15:00:00 GMT</pubDate></item><item><title>Amazon Aurora とはなんですか？</title><link>https://32imuf.com/aws/what-is-amazon-aurora/</link><dc:creator>fumi23</dc:creator><description>&lt;div class="section" id="amazon-aurora"&gt;
&lt;h2&gt;Amazon Aurora とは？&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://aws.amazon.com/jp/rds/aurora/"&gt;Amazon Aurora&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://aws.amazon.com/jp/rds/aurora/details/mysql-details/"&gt;Amazon Aurora 製品の詳細: MySQL 互換エディション&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/CHAP_AuroraOverview.html"&gt;Aurora のユーザーガイド&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/Aurora.AuroraMySQL.html"&gt;Amazon Aurora MySQL の操作&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://www.slideshare.net/AmazonWebServicesJapan/amazon-aurora-aurora"&gt;Amazon Aurora - Auroraの止まらない進化とその中身&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;関連情報&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://www.publickey1.jp/blog/18/amazonamazonoracleaurora_dbamazon_ctocnbc.html"&gt;Amazonプライムデーのサーバ障害、AmazonがOracleからAurora DBに乗り換えたのが原因ではない。Amazon CTOがCNBCの報道を否定&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://enterprisezine.jp/article/detail/11489"&gt;AWS、最新のデータベース機能を持つAmazon AuroraおよびAmazon DynamoDBと2つの新たな専用DBを発表&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://www.infoq.com/jp/news/2018/09/aurora-mysql-serverless-ga"&gt;Amazon Aurora Serverless MySQLが一般提供に&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>aws</category><guid>https://32imuf.com/aws/what-is-amazon-aurora/</guid><pubDate>Sat, 08 Dec 2018 15:00:00 GMT</pubDate></item><item><title>Redshift のメモ</title><link>https://32imuf.com/aws/redshift/note/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;div class="section" id="id1"&gt;
&lt;h2&gt;データ分散&lt;/h2&gt;
&lt;div class="section" id="diststyle"&gt;
&lt;h3&gt;DISTSTYLE&lt;/h3&gt;
&lt;p&gt;テーブル全体のデータ分散スタイルを定義する。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;EVEN&lt;/code&gt; 、 &lt;code class="docutils literal"&gt;KEY&lt;/code&gt; 、 &lt;code class="docutils literal"&gt;ALL&lt;/code&gt; の3種類ある&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_TABLE_AS.html"&gt;CREATE TABLE AS&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;テーブルにどの分散スタイルを選択するかによって、データベースの全体的なパフォーマンスが左右されます。&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c_choosing_dist_sort.html"&gt;分散スタイル&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c_Distribution_examples.html"&gt;分散の例&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;よく考えて選んだほうが良さそう...&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="distkey"&gt;
&lt;h3&gt;DISTKEY&lt;/h3&gt;
&lt;p&gt;分散キーの列名または位置番号を指定する。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;文字データ型&lt;/h2&gt;
&lt;div class="section" id="varchar"&gt;
&lt;h3&gt;マルチバイト文字の VARCHAR&lt;/h3&gt;
&lt;p&gt;CHAR および VARCHAR のデータ型は、文字単位でなくバイト単位で定義される。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_Character_types.html"&gt;文字型&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;例えば、VARCHAR(12) 列には、シングルバイト文字なら 12 個、2 バイト文字なら 6 個、3 バイト文字なら 4 個、4 バイト文字なら 3 個含めることができます。&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;3バイト文字と4バイト文字の違いがわかってない・・&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="max"&gt;
&lt;h3&gt;MAX キーワード&lt;/h3&gt;
&lt;p&gt;CHAR と VARCHAR は、 MAX キーワードを指定できる。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_Character_types.html#r_Character_types-storage-and-ranges"&gt;ストレージと範囲&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;MAX 設定は列幅を定義します。CHAR の場合は 4096 バイトであり、VARCHAR の場合は 65535 となります。&lt;/pre&gt;
&lt;pre class="code sql"&gt;&lt;a name="rest_code_670c62cd81c9454fb3d874621fdf320f-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;create&lt;/span&gt; &lt;span class="k"&gt;table&lt;/span&gt; &lt;span class="n"&gt;test&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;col1&lt;/span&gt; &lt;span class="nb"&gt;varchar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;max&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;圧縮&lt;/h2&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;圧縮分析&lt;/h3&gt;
&lt;p&gt;圧縮分析レポート取得できるコマンドがある。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_ANALYZE_COMPRESSION.html"&gt;ANALYZE COMPRESSION&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;圧縮分析を行い、分析されたテーブルの推奨列エンコードスキームのレポートを生成します。レポートには、列ごとに現在のエンコードと比較したディスク容量の圧縮可能率の推定値が含まれます。&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;列圧縮タイプの選択&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;テーブルの作成後に変更することはできない&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ALTER 文で列追加する場合は指定できる&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;圧縮すると、クエリパフォーマンスが向上する&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/t_Compressing_data_on_disk.html"&gt;列圧縮タイプの選択&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;テーブルの作成後に列の圧縮エンコードを変更することはできません。ALTER TABLE コマンドを使用して列をテーブルに追加する際には、列のエンコードを指定できます。&lt;/pre&gt;
&lt;pre class="literal-block"&gt;圧縮は、データの格納時にそのサイズを小さくする列レベルの操作です。圧縮によってストレージスペースが節約され、ストレージから読み込まれるデータのサイズが小さくなり、ディスク I/O の量が減少するので、クエリパフォーマンスが向上します&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h3&gt;圧縮エンコード&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;指定しないと自動的に割り当てられる。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;型によっては、CREATE TABLE または ALTER TABLE ステートメントで明示的に指定した方が良さそう。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c_Compression_encodings.html"&gt;圧縮エンコード&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;圧縮エンコードは、行がテーブルに追加されるときにデータ値の列に適用される圧縮のタイプを指定します。

CREATE TABLE または ALTER TABLE ステートメントで圧縮が指定されていない場合、Amazon Redshift は以下のように自動的に圧縮エンコードを割り当てます。...&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>aws</category><guid>https://32imuf.com/aws/redshift/note/</guid><pubDate>Sat, 01 Sep 2018 15:00:00 GMT</pubDate></item><item><title>S3ResponseError の原因はなんと時刻ずれだった</title><link>https://32imuf.com/aws/s3-response-error/</link><dc:creator>fumi23</dc:creator><description>&lt;div&gt;&lt;div class="section" id="id1"&gt;
&lt;h2&gt;何が起こったか&lt;/h2&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;storages.backends.s3boto.S3BotoStorage&lt;/code&gt; というのを使って、 AWS S3 にアクセスしようとしたら、こんなエラーが出た。&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;エラーメッセージ&lt;/p&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_ee905d7c7c37463584b5a39f87911482-1"&gt;&lt;/a&gt;S3ResponseError: S3ResponseError: &lt;span class="m"&gt;403&lt;/span&gt; Forbidden
&lt;a name="rest_code_ee905d7c7c37463584b5a39f87911482-2"&gt;&lt;/a&gt;&amp;lt;?xml &lt;span class="nv"&gt;version&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"1.0"&lt;/span&gt; &lt;span class="nv"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"UTF-8"&lt;/span&gt;?&amp;gt;
&lt;a name="rest_code_ee905d7c7c37463584b5a39f87911482-3"&gt;&lt;/a&gt;&amp;lt;Error&amp;gt;
&lt;a name="rest_code_ee905d7c7c37463584b5a39f87911482-4"&gt;&lt;/a&gt;  &amp;lt;Code&amp;gt;RequestTimeTooSkewed&amp;lt;/Code&amp;gt;
&lt;a name="rest_code_ee905d7c7c37463584b5a39f87911482-5"&gt;&lt;/a&gt;  &amp;lt;Message&amp;gt;The difference between the request &lt;span class="nb"&gt;time&lt;/span&gt; and the current &lt;span class="nb"&gt;time&lt;/span&gt; is too large.&amp;lt;/Message&amp;gt;
&lt;a name="rest_code_ee905d7c7c37463584b5a39f87911482-6"&gt;&lt;/a&gt;  &amp;lt;RequestTime&amp;gt;Tue, &lt;span class="m"&gt;31&lt;/span&gt; Jul &lt;span class="m"&gt;2018&lt;/span&gt; &lt;span class="m"&gt;07&lt;/span&gt;:40:44 GMT&amp;lt;/RequestTime&amp;gt;
&lt;a name="rest_code_ee905d7c7c37463584b5a39f87911482-7"&gt;&lt;/a&gt;  &amp;lt;ServerTime&amp;gt;2018-07-31T07:58:01Z&amp;lt;/ServerTime&amp;gt;
&lt;a name="rest_code_ee905d7c7c37463584b5a39f87911482-8"&gt;&lt;/a&gt;  &amp;lt;MaxAllowedSkewMilliseconds&amp;gt;900000&amp;lt;/MaxAllowedSkewMilliseconds&amp;gt;
&lt;a name="rest_code_ee905d7c7c37463584b5a39f87911482-9"&gt;&lt;/a&gt;  &amp;lt;RequestId&amp;gt;428DE174AE9C91AA&amp;lt;/RequestId&amp;gt;
&lt;a name="rest_code_ee905d7c7c37463584b5a39f87911482-10"&gt;&lt;/a&gt;  &amp;lt;HostId&amp;gt;VOjhVVVSgfq6rfE6Eh9pWr0+7bJGV9+4/sXeTeNnTVFi7JYAH5ZArd2NEP/hsgpgyJkMm/fNeCM&lt;span class="o"&gt;=&lt;/span&gt;&amp;lt;/HostId&amp;gt;
&lt;a name="rest_code_ee905d7c7c37463584b5a39f87911482-11"&gt;&lt;/a&gt;&amp;lt;/Error&amp;gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;cite&gt;403 Forbidden&lt;/cite&gt; と言っているし、以前はふつうにアクセスできたので、きっと &lt;code class="docutils literal"&gt;settings.py&lt;/code&gt; の設定が変になっちゃってるのだろうと疑った。ものすごく疑った。&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;settings.py&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_c10dbb9dea3b4576b5254ea11c0353da-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;MY_BUCKET_NAME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'my_bucket_name'&lt;/span&gt;
&lt;a name="rest_code_c10dbb9dea3b4576b5254ea11c0353da-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;DEFAULT_FILE_STORAGE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'storages.backends.s3boto.S3BotoStorage'&lt;/span&gt;
&lt;a name="rest_code_c10dbb9dea3b4576b5254ea11c0353da-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;AWS_STORAGE_BUCKET_NAME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MY_BUCKET_NAME&lt;/span&gt;
&lt;a name="rest_code_c10dbb9dea3b4576b5254ea11c0353da-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;AWS_ACCESS_KEY_ID&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'ひみつ'&lt;/span&gt;
&lt;a name="rest_code_c10dbb9dea3b4576b5254ea11c0353da-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;AWS_SECRET_ACCESS_KEY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'ひみつ'&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;違ってた！！&lt;/h2&gt;
&lt;p&gt;神々が教えてくれました・・・・&lt;/p&gt;
&lt;p&gt;ここ↓（秒とかはてきとう）&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;エラーメッセージ&lt;/p&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_41575119de174e1786f7def44f9b5714-1"&gt;&lt;/a&gt;&amp;lt;Message&amp;gt;The difference between the request &lt;span class="nb"&gt;time&lt;/span&gt; and the current &lt;span class="nb"&gt;time&lt;/span&gt; is too large.&amp;lt;/Message&amp;gt;
&lt;a name="rest_code_41575119de174e1786f7def44f9b5714-2"&gt;&lt;/a&gt;&amp;lt;RequestTime&amp;gt;Tue, &lt;span class="m"&gt;31&lt;/span&gt; Jul &lt;span class="m"&gt;2018&lt;/span&gt; &lt;span class="m"&gt;07&lt;/span&gt;:40:00 GMT&amp;lt;/RequestTime&amp;gt;
&lt;a name="rest_code_41575119de174e1786f7def44f9b5714-3"&gt;&lt;/a&gt;&amp;lt;ServerTime&amp;gt;2018-07-31T07:58:01Z&amp;lt;/ServerTime&amp;gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ゲストOSの日時&lt;/p&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_872414b8dc0e4f4cac8140cae5f30127-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;(&lt;/span&gt;venv&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;vagrant@localhost fumi23&lt;span class="o"&gt;]&lt;/span&gt;$ date
&lt;a name="rest_code_872414b8dc0e4f4cac8140cae5f30127-2"&gt;&lt;/a&gt;Tue Jul &lt;span class="m"&gt;31&lt;/span&gt; &lt;span class="m"&gt;16&lt;/span&gt;:40:00 JST &lt;span class="m"&gt;2018&lt;/span&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ホストOSの日時&lt;/p&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_2990838bc80d430ba3e4b95f1841b009-1"&gt;&lt;/a&gt;host-machine:~ fumi23$ date
&lt;a name="rest_code_2990838bc80d430ba3e4b95f1841b009-2"&gt;&lt;/a&gt;2018年 7月 31日 火曜日 16時58分00秒 JST
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;時刻のなおしかた&lt;/h2&gt;
&lt;pre class="code shell"&gt;&lt;a name="rest_code_20bd9939a4214bddbe386448ca26eb9d-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;(&lt;/span&gt;venv&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;vagrant@localhost fumi23&lt;span class="o"&gt;]&lt;/span&gt;$ sudo date -s &lt;span class="s2"&gt;"07/31 17:02 2018"&lt;/span&gt;
&lt;a name="rest_code_20bd9939a4214bddbe386448ca26eb9d-2"&gt;&lt;/a&gt;Tue Jul &lt;span class="m"&gt;31&lt;/span&gt; &lt;span class="m"&gt;17&lt;/span&gt;:02:00 JST &lt;span class="m"&gt;2018&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;わかったこと&lt;/h2&gt;
&lt;p&gt;時刻がずれ過ぎているひとも出禁！( &lt;cite&gt;403 Forbidden&lt;/cite&gt; )&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;常日頃からまわりの人に「エラーメッセージをよく読みましょう」と言ってもらっているし、自分でも「エラーをよく見るエラーをよく見る・・・」と散々唱えているのに、ちっとも見られていなかった。落ち込んだ。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;エラーメッセージが xml 形式で戻ってきたら、おおちゃくせずに整形してみようと思った。見やすくすると、大事なことも見逃しにくくなるかも。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;そういえば、ローカルVMから、3月はアクセスできていたけど、4月の中旬くらいからアクセスできなくなってた気がするので、そのタイミングで時刻ずれが先方の許容値を超えてたのかもしれない。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;宿題&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;storages.backends.s3boto.S3BotoStorage&lt;/code&gt; が何かあんまりわかっていない。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ホストマシンとゲストマシンの時刻の自動同期設定ができるらしい。調べて設定しよう。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://pc-karuma.net/virtualbox-install-guest-additions/"&gt;https://pc-karuma.net/virtualbox-install-guest-additions/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ありがとうございました。&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>aws</category><guid>https://32imuf.com/aws/s3-response-error/</guid><pubDate>Mon, 30 Jul 2018 15:00:00 GMT</pubDate></item></channel></rss>