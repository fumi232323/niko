<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
<title>Python のメモ/ふみのて</title>
<link rel="shortcut icon" href="../../assets/icons/favicon.ico">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Griffy">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Vollkorn:400,700">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sawarabi+Mincho&amp;display=swap&amp;subset=japanese,latin-ext">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
<link rel="stylesheet" href="../../assets/css/style.css?20200126">
</head>
<body>
    <div class="container">
      <div class="header"><header class="item item-header"><h1>
    <a href="../../">
      <img class="logo" src="../../assets/images/inuu.png" alt="犬"></a>
  </h1>
  <iframe src="../../tags/" class="tags"></iframe>
</header></div>
      <div class="main">
<div class="article-content">
  <main class="item item-article item-python"><time class="date" datetime="2019-04-20 00:00:00+09:00">
      2019-04-20 Sat
    </time><div class="title">Python のメモ</div>
    <div class="category">
      <a href="../../tags/python/">
          python
      </a>
    </div>
    <div class="text">
      <div>
<details><summary>目次</summary><div class="contents topic" id="id1">
<p class="topic-title first">目次</p>
<ul class="simple">
<li><p><a class="reference internal" href="#id2" id="id24">リファレンス</a></p></li>
<li>
<p><a class="reference internal" href="#id6" id="id25">いろいろ</a></p>
<ul>
<li><p><a class="reference internal" href="#http" id="id26">ローカルに HTTP サーバーを立てる</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id27">ユーザー定義例外</a></p></li>
<li>
<p><a class="reference internal" href="#interface" id="id28">interface 使いたい</a></p>
<ul>
<li><p><a class="reference internal" href="#id9" id="id29">抽象基底クラス</a></p></li>
<li><p><a class="reference internal" href="#protocol" id="id30">Protocol</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#defaultdict" id="id31">defaultdict</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id32">どんどん足してくやつ</a></p></li>
<li><p><a class="reference internal" href="#stringio-seek-0" id="id33">StringIO().seek(0)</a></p></li>
<li><p><a class="reference internal" href="#yield-dict-zip-columns-data" id="id34">yield dict(zip(columns, data))</a></p></li>
<li><p><a class="reference internal" href="#id13" id="id35">シーケンスのアンパッキング</a></p></li>
<li><p><a class="reference internal" href="#if-name-main" id="id36">if __name__ == "__main__"</a></p></li>
<li><p><a class="reference internal" href="#id15" id="id37">組み込み型と名前が被った場合</a></p></li>
</ul>
</li>
<li>
<p><a class="reference internal" href="#id16" id="id38">組み込み関数</a></p>
<ul>
<li><p><a class="reference internal" href="#isinstance-object-classinfo" id="id39">isinstance(object, classinfo)</a></p></li>
<li><p><a class="reference internal" href="#all-iterable" id="id40">all(iterable)</a></p></li>
<li><p><a class="reference internal" href="#sorted-iterable-key-none-reverse-false" id="id41"><code class="docutils literal">sorted(iterable, *, key=None, reverse=False)</code></a></p></li>
<li><p><a class="reference internal" href="#property" id="id42">@property</a></p></li>
</ul>
</li>
<li>
<p><a class="reference internal" href="#id18" id="id43">正規表現</a></p>
<ul>
<li><p><a class="reference internal" href="#id19" id="id44">バックスラッシュ感染症</a></p></li>
<li><p><a class="reference internal" href="#id21" id="id45">正規表現のグループ化機能</a></p></li>
<li><p><a class="reference internal" href="#re-matchobject-groupdict" id="id46">re.MatchObject.groupdict</a></p></li>
<li><p><a class="reference internal" href="#id23" id="id47">長い正規表現を記述する方法</a></p></li>
</ul>
</li>
<li>
<p><a class="reference internal" href="#python2" id="id48">Python2</a></p>
<ul>
<li><p><a class="reference internal" href="#unicode-str" id="id49">unicode と str</a></p></li>
<li><p><a class="reference internal" href="#coding-utf-8" id="id50">coding: utf-8</a></p></li>
</ul>
</li>
</ul>
</div>
</details><div class="section" id="id2">
<h2><a class="toc-backref" href="#id24">リファレンス</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/ja/3/genindex.html">頭文字別索引:</a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/ja/3/py-modindex.html">Pythonモジュール索引</a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/ja/3/library/functions.html#built-in-functions">組み込み関数</a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/ja/3/library/index.html">Python 標準ライブラリ</a></p></li>
</ul>
</div>
<div class="section" id="id6">
<h2><a class="toc-backref" href="#id25">いろいろ</a></h2>
<div class="section" id="http">
<h3><a class="toc-backref" href="#id26">ローカルに HTTP サーバーを立てる</a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/3/library/http.server.html">http.server --- HTTP サーバ</a></p>
<pre class="code python"><a name="rest_code_2341d5bd19f945d5a64e980b9343c075-1"></a><span class="c1"># ポートを指定 (現在のディレクトリのファイルを提供)</span>
<a name="rest_code_2341d5bd19f945d5a64e980b9343c075-2"></a><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span> <span class="mi">8000</span>
<a name="rest_code_2341d5bd19f945d5a64e980b9343c075-3"></a><span class="c1"># バインドするアドレスを指定 (現在のディレクトリのファイルを提供)</span>
<a name="rest_code_2341d5bd19f945d5a64e980b9343c075-4"></a><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span> <span class="mi">8000</span> <span class="o">--</span><span class="n">bind</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span>
<a name="rest_code_2341d5bd19f945d5a64e980b9343c075-5"></a><span class="c1"># ファイルを提供するディレクトリを指定</span>
<a name="rest_code_2341d5bd19f945d5a64e980b9343c075-6"></a><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span> <span class="o">--</span><span class="n">directory</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span>
</pre>
</div>
<div class="section" id="id7">
<h3><a class="toc-backref" href="#id27">ユーザー定義例外</a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/3.7/tutorial/errors.html#user-defined-exceptions">8.5. ユーザー定義例外</a></p>
<ul class="simple">
<li>
<p>Exception クラスを、直接または間接的に継承する</p>
<ul>
<li><p><a class="reference external" href="https://docs.python.org/ja/3/library/exceptions.html#BaseException">BaseException</a> : 全ての組み込み例外の基底クラスです。ユーザ定義の例外に直接継承されることは意図されていません (継承には Exception を使ってください)。</p></li>
</ul>
</li>
<li><p>大抵は、いくつかの属性だけを提供し、例外が発生したときにハンドラがエラーに関する情報を取り出せるようにする程度にとどめる</p></li>
<li><p>だいたいは、標準の例外の名前付けと同様に、 "Error" で終わる名前で定義する</p></li>
<li><p>複数の別個の例外を送出するようなモジュールを作成する際には、そのモジュールで定義されている例外の基底クラスを作成するのが一般的なプラクティス</p></li>
</ul>
</div>
<div class="section" id="interface">
<h3><a class="toc-backref" href="#id28">interface 使いたい</a></h3>
<div class="section" id="id9">
<h4><a class="toc-backref" href="#id29">抽象基底クラス</a></h4>
<ul class="simple">
<li><p>抽象基底クラス: <a class="reference external" href="https://docs.python.org/ja/3/library/abc.html">https://docs.python.org/ja/3/library/abc.html</a></p></li>
<li>
<p>collections.abc: <a class="reference external" href="https://docs.python.org/ja/3/library/collections.abc.html#module-collections.abc">https://docs.python.org/ja/3/library/collections.abc.html#module-collections.abc</a></p>
<ul>
<li><p><code class="docutils literal">Container</code> とか <code class="docutils literal">Iterable</code> とか <code class="docutils literal">Hashable</code> とか...</p></li>
</ul>
</li>
<li><p>abstract base class: <a class="reference external" href="https://docs.python.org/ja/3/glossary.html#term-abstract-base-class">https://docs.python.org/ja/3/glossary.html#term-abstract-base-class</a></p></li>
<li>
<p>エキスパートPythonプログラミング改訂2版:</p>
<ul>
<li><p>P.478: インターフェース</p></li>
<li><p>P.483: 関数アノテーションや抽象基底クラスを使用する</p></li>
<li><p>P.490: collections.abc を使用する</p></li>
</ul>
</li>
</ul>
<pre class="code python"><a name="rest_code_1c0728663c824060822f763f600988ac-1"></a><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABCMeta</span><span class="p">,</span> <span class="n">abstractmethod</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-2"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-3"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-4"></a><span class="k">class</span> <span class="nc">Pushable</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-5"></a>    <span class="nd">@abstractmethod</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-6"></a>    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-7"></a>        <span class="sd">"""何でも push"""</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-8"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-9"></a>    <span class="nd">@classmethod</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-10"></a>    <span class="k">def</span> <span class="nf">__subclasshook__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">):</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-11"></a>        <span class="c1"># これを実装しておくと、暗黙的にインターフェイスを実装しているインスタンスも</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-12"></a>        <span class="c1"># インターフェイスのインスタンスだと確認できる</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-13"></a>        <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="n">Pushable</span><span class="p">:</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-14"></a>            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="s1">'push'</span> <span class="ow">in</span> <span class="n">B</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">for</span> <span class="n">B</span> <span class="ow">in</span> <span class="n">subclass</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">):</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-15"></a>                <span class="k">return</span> <span class="bp">True</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-16"></a>        <span class="k">return</span> <span class="bp">NotImplemented</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-17"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-18"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-19"></a><span class="k">class</span> <span class="nc">HeyPushable</span><span class="p">(</span><span class="n">Pushable</span><span class="p">):</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-20"></a>    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-21"></a>        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Hey {x} push.'</span><span class="p">)</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-22"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-23"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-24"></a><span class="k">class</span> <span class="nc">HoyPushable</span><span class="p">(</span><span class="n">Pushable</span><span class="p">):</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-25"></a>    <span class="k">def</span> <span class="nf">pull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-26"></a>        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Hoy {x} pull.'</span><span class="p">)</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-27"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-28"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-29"></a><span class="k">class</span> <span class="nc">PoyPushable</span><span class="p">:</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-30"></a>    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-31"></a>        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Poy {x} push.'</span><span class="p">)</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-32"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-33"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-34"></a><span class="k">class</span> <span class="nc">NyaPushable</span><span class="p">:</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-35"></a>    <span class="k">def</span> <span class="nf">pull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-36"></a>        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Nya {x} pull.'</span><span class="p">)</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-37"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-38"></a>
<a name="rest_code_1c0728663c824060822f763f600988ac-39"></a><span class="k">class</span> <span class="nc">HeyHeyPushable</span><span class="p">(</span><span class="n">Pushable</span><span class="p">):</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-40"></a>    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-41"></a>        <span class="c1"># 引数違いも互換性ありとみなされる</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-42"></a>        <span class="c1"># (PyCharm では警告出る)</span>
<a name="rest_code_1c0728663c824060822f763f600988ac-43"></a>        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Hey hey {x}, {y} push.'</span><span class="p">)</span>
</pre>
<pre class="code python"><a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">hey</span> <span class="o">=</span> <span class="n">HeyPushable</span><span class="p">()</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hey</span><span class="p">,</span> <span class="n">Pushable</span><span class="p">)</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-3"></a><span class="bp">True</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">hey</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">'husky'</span><span class="p">)</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-5"></a><span class="n">Hey</span> <span class="n">husky</span> <span class="n">push</span><span class="o">.</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-6"></a>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">hoy</span> <span class="o">=</span> <span class="n">HoyPushable</span><span class="p">()</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-8"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-9"></a>  <span class="n">File</span> <span class="s2">"&lt;console&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-10"></a><span class="ne">TypeError</span><span class="p">:</span> <span class="n">Can</span><span class="s1">'t instantiate abstract class HoyPushable with abstract methods push</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-11"></a>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-12"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">poy</span> <span class="o">=</span> <span class="n">PoyPushable</span><span class="p">()</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-13"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">poy</span><span class="p">,</span> <span class="n">Pushable</span><span class="p">)</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-14"></a><span class="bp">True</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-15"></a>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-16"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">nya</span> <span class="o">=</span> <span class="n">NyaPushable</span><span class="p">()</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-17"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nya</span><span class="p">,</span> <span class="n">Pushable</span><span class="p">)</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-18"></a><span class="bp">False</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-19"></a>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-20"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">heyhey</span> <span class="o">=</span> <span class="n">HeyHeyPushable</span><span class="p">()</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-21"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">heyhey</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">'husky'</span><span class="p">,</span> <span class="s1">'shiba'</span><span class="p">)</span>
<a name="rest_code_9f44755fc64c4588894a9f9b8e9e3503-22"></a><span class="n">Hey</span> <span class="n">hey</span> <span class="n">husky</span><span class="p">,</span> <span class="n">shiba</span> <span class="n">push</span><span class="o">.</span>
</pre>
</div>
<div class="section" id="protocol">
<h4><a class="toc-backref" href="#id30">Protocol</a></h4>
<ul class="simple">
<li><p>Simple user-defined protocols: <a class="reference external" href="https://mypy.readthedocs.io/en/latest/protocols.html#simple-user-defined-protocols">https://mypy.readthedocs.io/en/latest/protocols.html#simple-user-defined-protocols</a></p></li>
<li><p>class typing.Protocol: <a class="reference external" href="https://docs.python.org/ja/3/library/typing.html#typing.Protocol">https://docs.python.org/ja/3/library/typing.html#typing.Protocol</a></p></li>
</ul>
</div>
</div>
<div class="section" id="defaultdict">
<h3><a class="toc-backref" href="#id31">defaultdict</a></h3>
<p>リストの初期化が不要になる！</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/ja/3/library/collections.html#defaultdict-objects">defaultdict オブジェクト</a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/ja/3/library/collections.html#defaultdict-examples">defaultdict の使用例</a></p></li>
</ul>
</div>
<div class="section" id="id12">
<h3><a class="toc-backref" href="#id32">どんどん足してくやつ</a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/3/library/functools.html#functools.reduce">functools.reduce</a></p>
</div>
<div class="section" id="stringio-seek-0">
<h3><a class="toc-backref" href="#id33">StringIO().seek(0)</a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/3/library/io.html#io.IOBase.seek">https://docs.python.org/ja/3/library/io.html#io.IOBase.seek</a></p>
<ul class="simple">
<li><p>先頭にもどす、 (カーソルを先頭に戻すみたいなイメージ)</p></li>
</ul>
</div>
<div class="section" id="yield-dict-zip-columns-data">
<h3><a class="toc-backref" href="#id34">yield dict(zip(columns, data))</a></h3>
<pre class="code python"><a name="rest_code_4e1754c33b5f464c95d4299f4014597d-1"></a><span class="c1"># これは、</span>
<a name="rest_code_4e1754c33b5f464c95d4299f4014597d-2"></a><span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<a name="rest_code_4e1754c33b5f464c95d4299f4014597d-3"></a>    <span class="n">row_dict</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a name="rest_code_4e1754c33b5f464c95d4299f4014597d-4"></a>    <span class="k">yield</span> <span class="n">row_dict</span>
<a name="rest_code_4e1754c33b5f464c95d4299f4014597d-5"></a>
<a name="rest_code_4e1754c33b5f464c95d4299f4014597d-6"></a><span class="c1"># こう書ける。</span>
<a name="rest_code_4e1754c33b5f464c95d4299f4014597d-7"></a><span class="k">yield</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
</pre>
<ul class="simple">
<li><p><code class="docutils literal">zip</code> はタプルのイテレータを返す -&gt; タプルから辞書を作れる</p></li>
<li><p><code class="docutils literal">dict(iterable, **kwarg)</code></p></li>
<li>
<p><a class="reference external" href="https://docs.python.org/ja/3/library/stdtypes.html#dict">https://docs.python.org/ja/3/library/stdtypes.html#dict</a></p>
<ul>
<li><p>それ以外の場合、位置引数は iterable オブジェクトでなければなりません。iterable のそれぞれの要素自身は、ちょうど 2 個のオブジェクトを持つイテラブルでなければなりません。それぞれの要素の最初のオブジェクトは新しい辞書のキーになり、2 番目のオブジェクトはそれに対応する値になります。同一のキーが 2 回以上現れた場合は、そのキーの最後の値が新しい辞書での対応する値になります。</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id13">
<h3><a class="toc-backref" href="#id35">シーケンスのアンパッキング</a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/3/tutorial/datastructures.html#tuples-and-sequences">タプルとシーケンス</a></p>
</div>
<div class="section" id="if-name-main">
<h3><a class="toc-backref" href="#id36">if __name__ == "__main__"</a></h3>
<p><a class="reference external" href="http://blog.pyq.jp/entry/Python_kaiketsu_180207">http://blog.pyq.jp/entry/Python_kaiketsu_180207</a></p>
<ul class="simple">
<li><p>Pythonでは、インポートされたファイルの中身は実行される</p></li>
</ul>
</div>
<div class="section" id="id15">
<h3><a class="toc-backref" href="#id37">組み込み型と名前が被った場合</a></h3>
<p><code class="docutils literal">in</code> や <code class="docutils literal">int</code> など、キーワード・組み込み型と同じ名前を変数名にしたい場合は、末尾に <code class="docutils literal">_</code> を付ける。</p>
</div>
</div>
<div class="section" id="id16">
<h2><a class="toc-backref" href="#id38">組み込み関数</a></h2>
<div class="section" id="isinstance-object-classinfo">
<h3><a class="toc-backref" href="#id39">isinstance(object, classinfo)</a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/3/library/functions.html#isinstance">https://docs.python.org/ja/3/library/functions.html#isinstance</a></p>
<ul class="simple">
<li><p>継承を考慮してくれる</p></li>
<li><p>classinfo には複数指定できる (タプルで)</p></li>
</ul>
</div>
<div class="section" id="all-iterable">
<h3><a class="toc-backref" href="#id40">all(iterable)</a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/3/library/functions.html#all">all(iterable)</a></p>
<ul class="simple">
<li><p>iterable の全ての要素が真ならば (もしくは iterable が空ならば) True を返す。</p></li>
</ul>
</div>
<div class="section" id="sorted-iterable-key-none-reverse-false">
<h3><a class="toc-backref" href="#id41"><code class="docutils literal">sorted(iterable, *, key=None, reverse=False)</code></a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/3/library/functions.html#sorted">sorted</a></p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/ja/3/library/stdtypes.html#tuples">タプル型 (tuple)</a> : <code class="docutils literal">タプルはイミュータブルなシーケンス</code> なので、 ソートできる。</p></li>
</ul>
<pre class="code python"><a name="rest_code_0a71bf9e99f148099348619ab44e00f0-1"></a><span class="c1"># これは、</span>
<a name="rest_code_0a71bf9e99f148099348619ab44e00f0-2"></a><span class="n">summary_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">summary_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a name="rest_code_0a71bf9e99f148099348619ab44e00f0-3"></a><span class="n">summary_list</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">'sort_key'</span><span class="p">])</span>
<a name="rest_code_0a71bf9e99f148099348619ab44e00f0-4"></a>
<a name="rest_code_0a71bf9e99f148099348619ab44e00f0-5"></a><span class="c1"># ``sorted`` という関数を使って以下のように書ける。</span>
<a name="rest_code_0a71bf9e99f148099348619ab44e00f0-6"></a><span class="n">summary_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">summary_dict</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">'sort_key'</span><span class="p">])</span>
<a name="rest_code_0a71bf9e99f148099348619ab44e00f0-7"></a>
<a name="rest_code_0a71bf9e99f148099348619ab44e00f0-8"></a>
<a name="rest_code_0a71bf9e99f148099348619ab44e00f0-9"></a><span class="c1"># さらに、for文をこんなふうに書くと ``summary_list`` を作る工程が不要。</span>
<a name="rest_code_0a71bf9e99f148099348619ab44e00f0-10"></a><span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">summary</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">summary_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<a name="rest_code_0a71bf9e99f148099348619ab44e00f0-11"></a>    <span class="c1"># ....</span>
</pre>
</div>
<div class="section" id="property">
<h3><a class="toc-backref" href="#id42">@property</a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/3/library/functions.html#property">https://docs.python.org/ja/3/library/functions.html#property</a></p>
<ul>
<li><p><code class="docutils literal">@property</code> デコレータ を付けると、プロパティのように呼び出せる。</p></li>
<li>
<p>同じ名前のまま 読み出し専用属性の <code class="docutils literal">getter</code> にしてくれる</p>
<pre class="code python"><a name="rest_code_caa3eec762434b5d92022ba3c558744a-1"></a><span class="c1"># 付けるとき</span>
<a name="rest_code_caa3eec762434b5d92022ba3c558744a-2"></a><span class="err">@</span> <span class="nb">property</span>
<a name="rest_code_caa3eec762434b5d92022ba3c558744a-3"></a><span class="k">def</span> <span class="nf">husky</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_caa3eec762434b5d92022ba3c558744a-4"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">'%Y/%m/</span><span class="si">%d</span><span class="s1"> %H'</span><span class="p">)</span>
</pre>
<pre class="code python"><a name="rest_code_68cdb193104f4c9d8a5a170a0b37168f-1"></a><span class="c1"># 呼び出すとき</span>
<a name="rest_code_68cdb193104f4c9d8a5a170a0b37168f-2"></a><span class="n">xxx</span><span class="o">.</span><span class="n">husky</span>
</pre>
</li>
</ul>
</div>
</div>
<div class="section" id="id18">
<h2><a class="toc-backref" href="#id43">正規表現</a></h2>
<div class="section" id="id19">
<h3><a class="toc-backref" href="#id44">バックスラッシュ感染症</a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/3.7/howto/regex.html#the-backslash-plague">バックスラッシュ感染症</a></p>
<pre class="code python"><a name="rest_code_b696099cb88440589246f95c874f6f98-1"></a><span class="c1"># こんなふうに書く</span>
<a name="rest_code_b696099cb88440589246f95c874f6f98-2"></a><span class="sa">r</span><span class="s2">"ab*"</span>
</pre>
<ul class="simple">
<li><p><code class="docutils literal">r</code> を文字列リテラルの先頭に書くことでバックスラッシュは特別扱いされなくなる</p></li>
<li><p>多くの場合 Python コードの中の正規表現はこの raw string 記法を使って書かれる</p></li>
</ul>
</div>
<div class="section" id="id21">
<h3><a class="toc-backref" href="#id45">正規表現のグループ化機能</a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/3.7/howto/regex.html#non-capturing-and-named-groups">取り出さないグループと名前つきグループ</a></p>
</div>
<div class="section" id="re-matchobject-groupdict">
<h3><a class="toc-backref" href="#id46">re.MatchObject.groupdict</a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/3/library/re.html#re.Match.groupdictgroupdict">https://docs.python.org/ja/3/library/re.html#re.Match.groupdictgroupdict</a></p>
<ul class="simple">
<li><p>マッチの、すべての 名前つきの サブグループを含む、サブグループ名でキー付けされた辞書を返す</p></li>
<li><p>リファレンスのサンプルコードを見ると一目瞭然なので、そちらを見てください</p></li>
</ul>
</div>
<div class="section" id="id23">
<h3><a class="toc-backref" href="#id47">長い正規表現を記述する方法</a></h3>
<ul class="simple">
<li><p>カンマ区切り無しで文字列リテラルを複数に分ける: <a class="reference external" href="http://docs.python-guide.org/en/latest/writing/style/#line-continuations">http://docs.python-guide.org/en/latest/writing/style/#line-continuations</a></p></li>
<li><p>re.VERBOSE オプションを使う: <a class="reference external" href="https://docs.python.org/ja/3/library/re.html#re.VERBOSE">https://docs.python.org/ja/3/library/re.html#re.VERBOSE</a></p></li>
</ul>
</div>
</div>
<div class="section" id="python2">
<h2><a class="toc-backref" href="#id48">Python2</a></h2>
<div class="section" id="unicode-str">
<h3><a class="toc-backref" href="#id49">unicode と str</a></h3>
<p><a class="reference external" href="https://docs.python.org/ja/2.7/tutorial/introduction.html#unicode-strings">3.1.3. Unicode 文字列</a></p>
<pre class="code python"><a name="rest_code_6ab4bddd36c04a67a4778d4b194998ae-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># -*- coding: utf-8 -*-</span>
<a name="rest_code_6ab4bddd36c04a67a4778d4b194998ae-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="s1">'ふみ'</span> <span class="o">==</span> <span class="sa">u</span><span class="s1">'ふみ'</span>
<a name="rest_code_6ab4bddd36c04a67a4778d4b194998ae-3"></a><span class="bp">False</span>
<a name="rest_code_6ab4bddd36c04a67a4778d4b194998ae-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="s1">'fumi23'</span> <span class="o">==</span> <span class="sa">u</span><span class="s1">'fumi23'</span>
<a name="rest_code_6ab4bddd36c04a67a4778d4b194998ae-5"></a><span class="bp">True</span>
<a name="rest_code_6ab4bddd36c04a67a4778d4b194998ae-6"></a><span class="o">&gt;&gt;&gt;</span>
</pre>
<ul class="simple">
<li><p>python2 の場合、マルチバイトを含むと <code class="docutils literal">u</code> の有無で違うオブジェクトとして判定される。</p></li>
<li><p>python2の文字には <code class="docutils literal">unicode</code> と <code class="docutils literal">str</code> がある。 ascii 文字しか含まない場合は 同じ値と判断されるけど基本的に別物として考えたほうがいい。</p></li>
</ul>
</div>
<div class="section" id="coding-utf-8">
<h3><a class="toc-backref" href="#id50">coding: utf-8</a></h3>
<p>ソースコードの文字エンコーディングを指定する</p>
<pre class="code python"><a name="rest_code_9c52e78376b849eb8451d10fdc1c0c2a-1"></a><span class="c1"># -*- coding: utf-8 -*-</span>
</pre>
<ul class="simple">
<li><p>ファイルの先頭に記述する</p></li>
<li><p>記述しないと、 Python2 環境かつファイルにマルチバイトが含まれていると <code class="docutils literal">SyntaxError</code> が発生する。</p></li>
<li><p>Python3 環境では不要</p></li>
</ul>
</div>
</div>
</div>
    </div>
  </main>
</div>
</div>
    </div>
  </body>
</html>
